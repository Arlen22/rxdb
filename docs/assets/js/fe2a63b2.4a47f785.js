"use strict";(self.webpackChunkrxdb=self.webpackChunkrxdb||[]).push([[1018],{2658:(e,t,r)=>{r.d(t,{Tj:()=>Kr,C3:()=>zr,IA:()=>Qr});var n=r(7329);function a(e,t){var r=e.get(t);if(void 0===r)throw new Error("missing value from map "+t);return r}function i(e,t,r,n){var a=e.get(t);return void 0===a?(a=r(),e.set(t,a)):n&&n(a),a}function s(e){return Object.assign({},e)}function o(e,t){if(void 0===t&&(t=!1),!e)return e;if(!t&&Array.isArray(e))return e.sort(((e,t)=>"string"==typeof e&&"string"==typeof t?e.localeCompare(t):"object"==typeof e?1:-1)).map((e=>o(e,t)));if("object"==typeof e&&!Array.isArray(e)){var r={};return Object.keys(e).sort(((e,t)=>e.localeCompare(t))).forEach((n=>{r[n]=o(e[n],t)})),r}return e}var c=function e(t){if(!t)return t;if(null===t||"object"!=typeof t)return t;if(Array.isArray(t)){for(var r=new Array(t.length),n=r.length;n--;)r[n]=e(t[n]);return r}var a={};for(var i in t)a[i]=e(t[i]);return a};function l(e,t,r){return Object.defineProperty(e,t,{get:function(){return r}}),r}var u=e=>{var t=typeof e;return null!==e&&("object"===t||"function"===t)},h=new Set(["__proto__","prototype","constructor"]),d=new Set("0123456789");function m(e){var t=[],r="",n="start",a=!1;for(var i of e)switch(i){case"\\":if("index"===n)throw new Error("Invalid character in an index");if("indexEnd"===n)throw new Error("Invalid character after an index");a&&(r+=i),n="property",a=!a;break;case".":if("index"===n)throw new Error("Invalid character in an index");if("indexEnd"===n){n="property";break}if(a){a=!1,r+=i;break}if(h.has(r))return[];t.push(r),r="",n="property";break;case"[":if("index"===n)throw new Error("Invalid character in an index");if("indexEnd"===n){n="index";break}if(a){a=!1,r+=i;break}if("property"===n){if(h.has(r))return[];t.push(r),r=""}n="index";break;case"]":if("index"===n){t.push(Number.parseInt(r,10)),r="",n="indexEnd";break}if("indexEnd"===n)throw new Error("Invalid character after an index");default:if("index"===n&&!d.has(i))throw new Error("Invalid character in an index");if("indexEnd"===n)throw new Error("Invalid character after an index");"start"===n&&(n="property"),a&&(a=!1,r+="\\"),r+=i}switch(a&&(r+="\\"),n){case"property":if(h.has(r))return[];t.push(r);break;case"index":throw new Error("Index was not closed");case"start":t.push("")}return t}function p(e,t){if("number"!=typeof t&&Array.isArray(e)){var r=Number.parseInt(t,10);return Number.isInteger(r)&&e[r]===e[t]}return!1}function f(e,t){if(p(e,t))throw new Error("Cannot use string index")}function v(e,t,r){if(Array.isArray(t)&&(t=t.join(".")),!t.includes(".")&&!t.includes("["))return e[t];if(!u(e)||"string"!=typeof t)return void 0===r?e:r;var n=m(t);if(0===n.length)return r;for(var a=0;a<n.length;a++){var i=n[a];if(null==(e=p(e,i)?a===n.length-1?void 0:null:e[i])){if(a!==n.length-1)return r;break}}return void 0===e?r:e}function g(e,t,r){if(Array.isArray(t)&&(t=t.join(".")),!u(e)||"string"!=typeof t)return e;for(var n=e,a=m(t),i=0;i<a.length;i++){var s=a[i];f(e,s),i===a.length-1?e[s]=r:u(e[s])||(e[s]="number"==typeof a[i+1]?[]:{}),e=e[s]}return n}var y=r(7810),b=r(3836),w=r(1449),x=r(6343),D={isDevMode:()=>!1,deepFreezeWhenDevMode:e=>e,tunnelErrorMessage:e=>"RxDB Error-Code "+e+".\n        Error messages are not included in RxDB core to reduce build size.\n        - To find out what this error means, either use the dev-mode-plugin https://rxdb.info/dev-mode.html\n        - or search for the error code here: https://github.com/pubkey/rxdb/search?q="+e+"\n        "};function k(e,t,r){return"RxError ("+t+"):\n"+e+"\n"+function(e){var t="";return 0===Object.keys(e).length?t:(t+="Given parameters: {\n",t+=Object.keys(e).map((t=>{var r="[object Object]";try{r="errors"===t?e[t].map((e=>JSON.stringify(e,Object.getOwnPropertyNames(e)))):JSON.stringify(e[t],(function(e,t){return void 0===t?null:t}),2)}catch(n){}return t+":"+r})).join("\n"),t+="}")}(r)}var j=function(e){function t(t,r,n){var a;void 0===n&&(n={});var i=k(r,t,n);return(a=e.call(this,i)||this).code=t,a.message=i,a.parameters=n,a.rxdb=!0,a}return(0,w.A)(t,e),t.prototype.toString=function(){return this.message},(0,b.A)(t,[{key:"name",get:function(){return"RxError ("+this.code+")"}},{key:"typeError",get:function(){return!1}}])}((0,x.A)(Error)),_=function(e){function t(t,r,n){var a;void 0===n&&(n={});var i=k(r,t,n);return(a=e.call(this,i)||this).code=t,a.message=i,a.parameters=n,a.rxdb=!0,a}return(0,w.A)(t,e),t.prototype.toString=function(){return this.message},(0,b.A)(t,[{key:"name",get:function(){return"RxTypeError ("+this.code+")"}},{key:"typeError",get:function(){return!0}}])}((0,x.A)(TypeError));function I(e,t){return new j(e,D.tunnelErrorMessage(e),t)}function S(e,t){return new _(e,D.tunnelErrorMessage(e),t)}function E(e){return!(!e||409!==e.status)&&e}var R={409:"document write conflict",422:"schema validation error",510:"attachment data missing"};var O=/\./g,C="abcdefghijklmnopqrstuvwxyz";function N(e){void 0===e&&(e=10);for(var t="",r=0;r<e;r++)t+=C.charAt(Math.floor(Math.random()*C.length));return t}function P(e){return(e+="").charAt(0).toUpperCase()+e.substr(1)}function $(e){for(;"."===e.charAt(0);)e=e.substr(1);for(;"."===e.slice(-1);)e=e.slice(0,-1);return e}var T=1;function A(){return{lwt:T}}function B(e,t){var r=t;return v(e,r=$(r="properties."+(r=r.replace(O,".properties."))))}function q(e){return"string"==typeof e?e:e.key}function M(e,t){if("string"==typeof e.primaryKey)return t[e.primaryKey];var r=e.primaryKey;return r.fields.map((e=>{var r=v(t,e);if(void 0===r)throw I("DOC18",{args:{field:e,documentData:t}});return r})).join(r.separator)}function W(e){var t=q((e=s(e)).primaryKey);e.properties=s(e.properties),e.additionalProperties=!1,Object.prototype.hasOwnProperty.call(e,"keyCompression")||(e.keyCompression=!1),e.indexes=e.indexes?e.indexes.slice(0):[],e.required=e.required?e.required.slice(0):[],e.encrypted=e.encrypted?e.encrypted.slice(0):[],e.properties._rev={type:"string",minLength:1},e.properties._attachments={type:"object"},e.properties._deleted={type:"boolean"},e.properties._meta=L,e.required=e.required?e.required.slice(0):[],e.required.push("_deleted"),e.required.push("_rev"),e.required.push("_meta"),e.required.push("_attachments");var r=F(e);(0,y.Hb)(e.required,r),e.required=e.required.filter((e=>!e.includes("."))).filter(((e,t,r)=>r.indexOf(e)===t)),e.version=e.version||0;var n=e.indexes.map((e=>{var r=(0,y.k_)(e)?e.slice(0):[e];return r.includes(t)||r.push(t),"_deleted"!==r[0]&&r.unshift("_deleted"),r}));0===n.length&&n.push(function(e){return["_deleted",e]}(t)),n.push(["_meta.lwt",t]),e.internalIndexes&&e.internalIndexes.map((e=>{n.push(e)}));var a=new Set;return n.filter((e=>{var t=e.join(",");return!a.has(t)&&(a.add(t),!0)})),e.indexes=n,e}var L={type:"object",properties:{lwt:{type:"number",minimum:T,maximum:1e15,multipleOf:.01}},additionalProperties:!0,required:["lwt"]};function F(e){var t=Object.keys(e.properties).filter((t=>e.properties[t].final)),r=q(e.primaryKey);return t.push(r),"string"!=typeof e.primaryKey&&e.primaryKey.fields.forEach((e=>t.push(e))),t}var H="docs",Q="changes",z="attachments",K="dexie",U=new Map,Z=new Map;var V="__";function J(e){var t=e.split(".");if(t.length>1)return t.map((e=>J(e))).join(".");if(e.startsWith("|")){var r=e.substring(1);return V+r}return e}function G(e){var t=e.split(".");return t.length>1?t.map((e=>G(e))).join("."):e.startsWith(V)?"|"+e.substring(V.length):e}function Y(e,t){return t?(t=ee(t=s(t)),e.forEach((e=>{var r=v(t,e);g(t,e,r?"1":"0")})),t):t}function X(e,t){return t?(t=te(t=s(t)),e.forEach((e=>{var r=v(t,e);g(t,e,"1"===r)})),t):t}function ee(e){if(!e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e)return e;if(Array.isArray(e))return e.map((e=>ee(e)));if("object"==typeof e){var t={};return Object.entries(e).forEach((e=>{let[r,n]=e;"object"==typeof n&&(n=ee(n)),t[J(r)]=n})),t}}function te(e){if(!e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e)return e;if(Array.isArray(e))return e.map((e=>te(e)));if("object"==typeof e){var t={};return Object.entries(e).forEach((r=>{let[n,a]=r;("object"==typeof a||Array.isArray(e))&&(a=te(a)),t[G(n)]=a})),t}}function re(e){var t=[],r=q(e.primaryKey);t.push([r]),t.push(["_deleted",r]),e.indexes&&e.indexes.forEach((e=>{var r=(0,y.$r)(e);t.push(r)})),t.push(["_meta.lwt",r]),t.push(["_meta.lwt"]);var n=(t=t.map((e=>e.map((e=>J(e)))))).map((e=>1===e.length?e[0]:"["+e.join("+")+"]"));return(n=n.filter(((e,t,r)=>r.indexOf(e)===t))).join(", ")}async function ne(e,t){var r=await e;return(await r.dexieTable.bulkGet(t)).map((e=>X(r.booleanIndexes,e)))}function ae(e,t){return e+"||"+t}function ie(e){var t=new Set,r=[];return e.indexes?(e.indexes.forEach((n=>{(0,y.$r)(n).forEach((n=>{t.has(n)||(t.add(n),"boolean"===B(e,n).type&&r.push(n))}))})),r.push("_deleted"),(0,y.jw)(r)):r}var se=r(9092),oe=r(5734),ce=r(3337),le=String.fromCharCode(65535),ue=Number.MIN_SAFE_INTEGER;function he(e,t){var r=t.selector,n=e.indexes?e.indexes.slice(0):[];t.index&&(n=[t.index]);var a=!!t.sort.find((e=>"desc"===Object.values(e)[0])),i=new Set;Object.keys(r).forEach((t=>{var n=B(e,t);n&&"boolean"===n.type&&Object.prototype.hasOwnProperty.call(r[t],"$eq")&&i.add(t)}));var s,o=t.sort.map((e=>Object.keys(e)[0])).filter((e=>!i.has(e))).join(","),c=-1;if(n.forEach((e=>{var n=!0,l=!0,u=e.map((e=>{var t=r[e],a=t?Object.keys(t):[],i={};t&&a.length?a.forEach((e=>{if(de.has(e)){var r=function(e,t){switch(e){case"$eq":return{startKey:t,endKey:t,inclusiveEnd:!0,inclusiveStart:!0};case"$lte":return{endKey:t,inclusiveEnd:!0};case"$gte":return{startKey:t,inclusiveStart:!0};case"$lt":return{endKey:t,inclusiveEnd:!1};case"$gt":return{startKey:t,inclusiveStart:!1};default:throw new Error("SNH")}}(e,t[e]);i=Object.assign(i,r)}})):i={startKey:l?ue:le,endKey:n?le:ue,inclusiveStart:!0,inclusiveEnd:!0};return void 0===i.startKey&&(i.startKey=ue),void 0===i.endKey&&(i.endKey=le),void 0===i.inclusiveStart&&(i.inclusiveStart=!0),void 0===i.inclusiveEnd&&(i.inclusiveEnd=!0),l&&!i.inclusiveStart&&(l=!1),n&&!i.inclusiveEnd&&(n=!1),i})),h=u.map((e=>e.startKey)),d=u.map((e=>e.endKey)),m={index:e,startKeys:h,endKeys:d,inclusiveEnd:n,inclusiveStart:l,sortSatisfiedByIndex:!a&&o===e.filter((e=>!i.has(e))).join(","),selectorSatisfiedByIndex:fe(e,t.selector,h,d)},p=function(e,t,r){var n=0,a=e=>{e>0&&(n+=e)},i=10,s=(0,y.Sd)(r.startKeys,(e=>e!==ue&&e!==le));a(s*i);var o=(0,y.Sd)(r.startKeys,(e=>e!==le&&e!==ue));a(o*i);var c=(0,y.Sd)(r.startKeys,((e,t)=>e===r.endKeys[t]));a(c*i*1.5);var l=r.sortSatisfiedByIndex?5:0;return a(l),n}(0,0,m);(p>=c||t.index)&&(c=p,s=m)})),!s)throw I("SNH",{query:t});return s}var de=new Set(["$eq","$gt","$gte","$lt","$lte"]),me=new Set(["$eq","$gt","$gte"]),pe=new Set(["$eq","$lt","$lte"]);function fe(e,t,r,n){var a=Object.entries(t).find((t=>{let[r,n]=t;return!e.includes(r)||Object.entries(n).find((e=>{let[t,r]=e;return!de.has(t)}))}));if(a)return!1;if(t.$and||t.$or)return!1;var i=[],s=new Set;for(var[o,c]of Object.entries(t)){if(!e.includes(o))return!1;var l=Object.keys(c).filter((e=>me.has(e)));if(l.length>1)return!1;var u=l[0];if(u&&s.add(o),"$eq"!==u){if(i.length>0)return!1;i.push(u)}}var h=[],d=new Set;for(var[m,p]of Object.entries(t)){if(!e.includes(m))return!1;var f=Object.keys(p).filter((e=>pe.has(e)));if(f.length>1)return!1;var v=f[0];if(v&&d.add(m),"$eq"!==v){if(h.length>0)return!1;h.push(v)}}var g=0;for(var y of e){for(var b of[s,d]){if(!b.has(y)&&b.size>0)return!1;b.delete(y)}if(r[g]!==n[g]&&s.size>0&&d.size>0)return!1;g++}return!0}var ve=r(744),ge=r(2779),ye=r(1692),be=r(4903),we=r(7705),xe=r(2403),De=r(6776),ke=r(6950),je=r(6823),_e=!1;function Ie(e){return _e||((0,ge.DZ)(ge.hu.PIPELINE,{$sort:be.xF,$project:be.C2}),(0,ge.DZ)(ge.hu.QUERY,{$and:we.a6,$eq:xe.XV,$elemMatch:ke.Jy,$exists:je.P,$gt:xe.MR,$gte:xe.fy,$in:xe.oZ,$lt:xe.NV,$lte:xe.Q_,$ne:xe.C5,$nin:xe.GU,$mod:De.Pp,$nor:we.q3,$not:we.En,$or:we.sU,$regex:De.WP,$size:ke.Ig,$type:je.T}),_e=!0),new ye.X(e)}function Se(e,t){var r=q(e.primaryKey);t=s(t);var n=c(t);if("number"!=typeof n.skip&&(n.skip=0),n.selector?(n.selector=n.selector,Object.entries(n.selector).forEach((e=>{let[t,r]=e;"object"==typeof r&&null!==r||(n.selector[t]={$eq:r})}))):n.selector={},n.index){var a=(0,y.$r)(n.index);a.includes(r)||a.push(r),n.index=a}if(n.sort)n.sort.find((e=>{return t=e,Object.keys(t)[0]===r;var t}))||(n.sort=n.sort.slice(0),n.sort.push({[r]:"asc"}));else if(n.index)n.sort=n.index.map((e=>({[e]:"asc"})));else{if(e.indexes){var i=new Set;Object.entries(n.selector).forEach((e=>{let[t,r]=e;("object"!=typeof r||null===r||!!Object.keys(r).find((e=>de.has(e))))&&i.add(t)}));var o,l=-1;e.indexes.forEach((e=>{var t=(0,y.k_)(e)?e:[e],r=t.findIndex((e=>!i.has(e)));r>0&&r>l&&(l=r,o=t)})),o&&(n.sort=o.map((e=>({[e]:"asc"}))))}n.sort||(n.sort=[{[r]:"asc"}])}return n}function Ee(e,t){if(!t.sort)throw I("SNH",{query:t});var r=[];t.sort.forEach((e=>{var t,n,a,i=Object.keys(e)[0],s=Object.values(e)[0];r.push({key:i,direction:s,getValueFn:(t=i,n=t.split("."),a=n.length,1===a?e=>e[t]:e=>{for(var t=e,r=0;r<a;++r)if(void 0===(t=t[n[r]]))return t;return t})})}));return(e,t)=>{for(var n=0;n<r.length;++n){var a=r[n],i=a.getValueFn(e),s=a.getValueFn(t);if(i!==s)return"asc"===a.direction?(0,ve.UD)(i,s):(0,ve.UD)(s,i)}}}function Re(e,t){if(!t.sort)throw I("SNH",{query:t});var r=Ie(t.selector);return e=>r.test(e)}function Oe(e){return e===ue?-1/0:e}function Ce(e,t,r){return e.includes(t)?r===le||!0===r?"1":"0":r}function Ne(e,t,r){if(!r){if("undefined"==typeof window)throw new Error("IDBKeyRange missing");r=window.IDBKeyRange}var n=t.startKeys.map(((r,n)=>{var a=t.index[n];return Ce(e,a,r)})).map(Oe),a=t.endKeys.map(((r,n)=>{var a=t.index[n];return Ce(e,a,r)})).map(Oe);return r.bound(n,a,!t.inclusiveStart,!t.inclusiveEnd)}async function Pe(e,t){var r=await e.internals,n=t.query,a=n.skip?n.skip:0,i=a+(n.limit?n.limit:1/0),s=t.queryPlan,o=!1;s.selectorSatisfiedByIndex||(o=Re(e.schema,t.query));var c=Ne(r.booleanIndexes,s,r.dexieDb._options.IDBKeyRange),l=s.index,u=[];if(await r.dexieDb.transaction("r",r.dexieTable,(async e=>{var t,n=e.idbtrans.objectStore(H);t="["+l.map((e=>J(e))).join("+")+"]";var a=n.index(t).openCursor(c);await new Promise((e=>{a.onsuccess=function(t){var n=t.target.result;if(n){var a=X(r.booleanIndexes,n.value);o&&!o(a)||u.push(a),s.sortSatisfiedByIndex&&u.length===i?e():n.continue()}else e()}}))})),!s.sortSatisfiedByIndex){var h=Ee(e.schema,t.query);u=u.sort(h)}return{documents:u=u.slice(a,i)}}function $e(e){var t=e.split("-");if(2!==t.length)throw new Error("malformatted revision: "+e);return{height:parseInt(t[0],10),hash:t[1]}}function Te(e){return parseInt(e.split("-")[0],10)}function Ae(e,t){return(t?Te(t._rev)+1:1)+"-"+e}var Be={preAddRxPlugin:[],preCreateRxDatabase:[],createRxDatabase:[],preCreateRxCollection:[],createRxCollection:[],createRxState:[],postDestroyRxCollection:[],postRemoveRxCollection:[],preCreateRxSchema:[],createRxSchema:[],preCreateRxQuery:[],prePrepareQuery:[],createRxDocument:[],postCreateRxDocument:[],preCreateRxStorageInstance:[],preStorageWrite:[],preMigrateDocument:[],postMigrateDocument:[],preDestroyRxDatabase:[],postRemoveRxDatabase:[],preReplicationMasterWrite:[],preReplicationMasterWriteDocumentsHandle:[]};function qe(e,t){Be[e].length>0&&Be[e].forEach((e=>e(t)))}function Me(e,t){return Promise.all(Be[e].map((e=>e(t))))}var We="_rxdb_internal";async function Le(e,t){var r=(await e.findDocumentsById([t],!1))[0];return r||void 0}async function Fe(e,t,r){var n=await e.bulkWrite([t],r);if(n.error.length>0)throw n.error[0];return n.success[0]}function He(e,t,r,n){if(n)throw 409===n.status?I("CONFLICT",{collection:e.name,id:t,writeError:n,data:r}):422===n.status?I("VD2",{collection:e.name,id:t,writeError:n,data:r}):n}function Qe(e){return{previous:e.previous,document:ze(e.document)}}function ze(e){if(!e._attachments||0===Object.keys(e._attachments).length)return e;var t=s(e);return t._attachments={},Object.entries(e._attachments).forEach((e=>{let[r,n]=e;var a,i,s;t._attachments[r]=(s=(a=n).data)?{length:(i=s,atob(i).length),digest:a.digest,type:a.type}:a})),t}function Ke(e){return Object.assign({},e,{_meta:s(e._meta)})}function Ue(e,t,r){D.deepFreezeWhenDevMode(r);var n={originalStorageInstance:t,schema:t.schema,internals:t.internals,collectionName:t.collectionName,databaseName:t.databaseName,options:t.options,bulkWrite(r,n){for(var a=e.token,i=new Array(r.length),s=(0,oe.t)(),o=0;o<r.length;o++){var c=r[o],l=Ke(c.document);l._meta.lwt=s;var u=c.previous;l._rev=Ae(a,u),i[o]={document:l,previous:u}}return qe("preStorageWrite",{storageInstance:this.originalStorageInstance,rows:i}),e.lockedRun((()=>t.bulkWrite(i,n))).then((r=>{var a={error:[],success:r.success.slice(0)},i=0===r.error.length?[]:r.error.filter((e=>!(409!==e.status||e.writeRow.previous||e.writeRow.document._deleted||!(0,ce.ZN)(e.documentInDb)._deleted)||(a.error.push(e),!1)));if(i.length>0){var s=i.map((t=>({previous:t.documentInDb,document:Object.assign({},t.writeRow.document,{_rev:Ae(e.token,t.documentInDb)})})));return e.lockedRun((()=>t.bulkWrite(s,n))).then((e=>((0,y.Hb)(a.error,e.error),(0,y.Hb)(a.success,e.success),a)))}return r}))},query:r=>e.lockedRun((()=>t.query(r))),count:r=>e.lockedRun((()=>t.count(r))),findDocumentsById:(r,n)=>e.lockedRun((()=>t.findDocumentsById(r,n))),getAttachmentData:(r,n,a)=>e.lockedRun((()=>t.getAttachmentData(r,n,a))),getChangedDocumentsSince:t.getChangedDocumentsSince?(r,n)=>e.lockedRun((()=>t.getChangedDocumentsSince((0,ce.ZN)(r),n))):void 0,cleanup:r=>e.lockedRun((()=>t.cleanup(r))),remove:()=>(e.storageInstances.delete(n),e.lockedRun((()=>t.remove()))),close:()=>(e.storageInstances.delete(n),e.lockedRun((()=>t.close()))),changeStream:()=>t.changeStream(),conflictResultionTasks:()=>t.conflictResultionTasks(),resolveConflictResultionTask(e){if(e.output.isEqual)return t.resolveConflictResultionTask(e);var r=s(Object.assign({},e.output.documentData,{_meta:A(),_rev:"",_attachments:{}}));return delete r._meta,delete r._rev,delete r._attachments,t.resolveConflictResultionTask({id:e.id,output:{isEqual:!1,documentData:r}})}};return e.storageInstances.add(n),n}var Ze=r(3561),Ve=r(703),Je=new Map;function Ge(e,t){var r=Je.get(e);if(r)return r.refs.delete(t),0===r.refs.size?(Je.delete(e),r.bc.close()):void 0}function Ye(e,t,r,n){if(t.multiInstance){var a=n||function(e,t,r,n){var a=Je.get(t);return a||(a={bc:new Ve.X2(["RxDB:",e,r].join("|")),refs:new Set},Je.set(t,a)),a.refs.add(n),a.bc}(e,t.databaseInstanceToken,r.databaseName,r),i=new se.B,s=r=>{r.storageName===e&&r.databaseName===t.databaseName&&r.collectionName===t.collectionName&&r.version===t.schema.version&&i.next(r.eventBulk)};a.addEventListener("message",s);var o=r.changeStream(),c=!1,l=o.subscribe((r=>{c||a.postMessage({storageName:e,databaseName:t.databaseName,collectionName:t.collectionName,version:t.schema.version,eventBulk:r})}));r.changeStream=function(){return i.asObservable().pipe((0,Ze.X)(o))};var u=r.close.bind(r);r.close=async function(){return c=!0,l.unsubscribe(),a.removeEventListener("message",s),n||await Ge(t.databaseInstanceToken,r),u()};var h=r.remove.bind(r);r.remove=async function(){return c=!0,l.unsubscribe(),a.removeEventListener("message",s),n||await Ge(t.databaseInstanceToken,r),h()}}}var Xe=(0,oe.t)(),et="dexieTestMetaField",tt=function(){function e(e,t,r,n,a,i,s,o){this.changes$=new se.B,this.instanceId=Xe++,this.storage=e,this.databaseName=t,this.collectionName=r,this.schema=n,this.internals=a,this.options=i,this.settings=s,this.devMode=o,this.primaryPath=q(this.schema.primaryKey)}var t=e.prototype;return t.bulkWrite=async function(e,t){nt(this),e.forEach((e=>{if(!e.document._rev||e.previous&&!e.previous._rev)throw I("SNH",{args:{row:e}});if(this.devMode&&e.previous&&(!e.previous._meta[et]||e.previous._meta[et]!==e.previous._rev))throw console.dir(e),new Error("missing or wrong _meta."+et)}));var r=await this.internals,n={success:[],error:[]};this.devMode&&(e=e.map((e=>{var t=Ke(e.document);return t._meta[et]=t._rev,{previous:e.previous,document:t}})));var a,i=e.map((e=>e.document[this.primaryPath]));if(await r.dexieDb.transaction("rw",r.dexieTable,r.dexieAttachmentsTable,(async()=>{var s=new Map;(await ne(this.internals,i)).forEach((e=>{var t=e;return t&&s.set(t[this.primaryPath],t),t})),a=function(e,t,r,n,a,i,s){for(var o,c=!!e.schema.attachments,l=[],u=[],h=[],d={id:N(10),events:[],checkpoint:null,context:a,startTime:(0,oe.t)(),endTime:0},m=d.events,p=[],f=[],v=[],g=r.size>0,y=n.length,b=function(){var e,a=n[w],d=a.document,y=a.previous,b=d[t],x=d._deleted,D=y&&y._deleted,k=void 0;if(g&&(k=r.get(b)),k){var j=k._rev;if(!y||y&&j!==y._rev){var _={isError:!0,status:409,documentId:b,writeRow:a,documentInDb:k};return h.push(_),1}var S=c?Qe(a):a;c&&(x?y&&Object.keys(y._attachments).forEach((e=>{f.push({documentId:b,attachmentId:e,digest:(0,ce.ZN)(y)._attachments[e].digest})})):(Object.entries(d._attachments).find((t=>{let[r,n]=t;return(y?y._attachments[r]:void 0)||n.data||(e={documentId:b,documentInDb:k,isError:!0,status:510,writeRow:a,attachmentId:r}),!0})),e||Object.entries(d._attachments).forEach((e=>{let[t,r]=e;var n=y?y._attachments[t]:void 0;if(n){var a=S.document._attachments[t].digest;r.data&&n.digest!==a&&v.push({documentId:b,attachmentId:t,attachmentData:r,digest:r.digest})}else p.push({documentId:b,attachmentId:t,attachmentData:r,digest:r.digest})})))),e?h.push(e):(c?(u.push(Qe(S)),s&&s(d)):(u.push(S),s&&s(d)),o=S);var E=null,R=null,O=null;if(D&&!x)O="INSERT",E=c?ze(d):d;else if(!y||D||x){if(!x)throw I("SNH",{args:{writeRow:a}});O="DELETE",E=(0,ce.ZN)(d),R=y}else O="UPDATE",E=c?ze(d):d,R=y;var C={documentId:b,documentData:E,previousDocumentData:R,operation:O};m.push(C)}else{var N=!!x;if(c&&Object.entries(d._attachments).forEach((t=>{let[r,n]=t;n.data?p.push({documentId:b,attachmentId:r,attachmentData:n,digest:n.digest}):(e={documentId:b,isError:!0,status:510,writeRow:a,attachmentId:r},h.push(e))})),e||(c?(l.push(Qe(a)),i&&i(d)):(l.push(a),i&&i(d)),o=a),!N){var P={documentId:b,operation:"INSERT",documentData:c?ze(d):d,previousDocumentData:c&&y?ze(y):y};m.push(P)}}},w=0;w<y;w++)b();return{bulkInsertDocs:l,bulkUpdateDocs:u,newestRow:o,errors:h,eventBulk:d,attachmentsAdd:p,attachmentsRemove:f,attachmentsUpdate:v}}(this,this.primaryPath,s,e,t),n.error=a.errors;var o=[];a.bulkInsertDocs.forEach((e=>{n.success.push(e.document),o.push(e.document)})),a.bulkUpdateDocs.forEach((e=>{n.success.push(e.document),o.push(e.document)})),(o=o.map((e=>Y(r.booleanIndexes,e)))).length>0&&await r.dexieTable.bulkPut(o);var c=[];a.attachmentsAdd.forEach((e=>{c.push({id:ae(e.documentId,e.attachmentId),data:e.attachmentData.data})})),a.attachmentsUpdate.forEach((e=>{c.push({id:ae(e.documentId,e.attachmentId),data:e.attachmentData.data})})),await r.dexieAttachmentsTable.bulkPut(c),await r.dexieAttachmentsTable.bulkDelete(a.attachmentsRemove.map((e=>ae(e.documentId,e.attachmentId))))})),(a=(0,ce.ZN)(a)).eventBulk.events.length>0){var s=(0,ce.ZN)(a.newestRow).document;a.eventBulk.checkpoint={id:s[this.primaryPath],lwt:s._meta.lwt},a.eventBulk.endTime=(0,oe.t)(),this.changes$.next(a.eventBulk)}return n},t.findDocumentsById=async function(e,t){nt(this);var r=await this.internals,n=[];return await r.dexieDb.transaction("r",r.dexieTable,(async()=>{(await ne(this.internals,e)).forEach((e=>{!e||e._deleted&&!t||n.push(e)}))})),n},t.query=function(e){return nt(this),Pe(this,e)},t.count=async function(e){if(e.queryPlan.selectorSatisfiedByIndex){var t=await async function(e,t){var r=await e.internals,n=t.queryPlan,a=n.index,i=Ne(r.booleanIndexes,n,r.dexieDb._options.IDBKeyRange),s=-1;return await r.dexieDb.transaction("r",r.dexieTable,(async e=>{var t,r=e.idbtrans.objectStore(H);t="["+a.map((e=>J(e))).join("+")+"]";var n=r.index(t).count(i);s=await new Promise(((e,t)=>{n.onsuccess=function(){e(n.result)},n.onerror=e=>t(e)}))})),s}(this,e);return{count:t,mode:"fast"}}return{count:(await Pe(this,e)).documents.length,mode:"slow"}},t.changeStream=function(){return nt(this),this.changes$.asObservable()},t.cleanup=async function(e){nt(this);var t=await this.internals;return await t.dexieDb.transaction("rw",t.dexieTable,(async()=>{var r=(0,oe.t)()-e,n=await t.dexieTable.where("_meta.lwt").below(r).toArray(),a=[];n.forEach((e=>{"1"===e._deleted&&a.push(e[this.primaryPath])})),await t.dexieTable.bulkDelete(a)})),!0},t.getAttachmentData=async function(e,t,r){nt(this);var n=await this.internals,a=ae(e,t);return await n.dexieDb.transaction("r",n.dexieAttachmentsTable,(async()=>{var r=await n.dexieAttachmentsTable.get(a);if(r)return r.data;throw new Error("attachment missing documentId: "+e+" attachmentId: "+t)}))},t.remove=async function(){nt(this);var e=await this.internals;return await e.dexieTable.clear(),this.close()},t.close=function(){return this.closed||(this.closed=(async()=>{this.changes$.complete(),await async function(e){var t=await e,r=Z.get(e)-1;0===r?(t.dexieDb.close(),Z.delete(e)):Z.set(e,r)}(this.internals)})()),this.closed},t.conflictResultionTasks=function(){return new se.B},t.resolveConflictResultionTask=async function(e){},e}();async function rt(e,t,r){var a=function(e,t,r,a){var o="rxdb-dexie-"+e+"--"+a.version+"--"+t,c=i(U,o,(()=>{var e=(async()=>{var e=s(r);e.autoOpen=!1;var t=new n.cf(o,e),i={[H]:re(a),[Q]:"++sequence, id",[z]:"id"};return t.version(1).stores(i),await t.open(),{dexieDb:t,dexieTable:t[H],dexieAttachmentsTable:t[z],booleanIndexes:ie(a)}})();return U.set(o,c),Z.set(c,0),e}));return c}(t.databaseName,t.collectionName,r,t.schema),o=new tt(e,t.databaseName,t.collectionName,t.schema,a,t.options,r,t.devMode);return await Ye(K,t,o),Promise.resolve(o)}function nt(e){if(e.closed)throw new Error("RxStorageInstanceDexie is closed "+e.databaseName+"-"+e.collectionName)}var at="15.19.0",it=function(){function e(e){this.name=K,this.rxdbVersion=at,this.settings=e}return e.prototype.createStorageInstance=function(e){return function(e){if(e.schema.keyCompression)throw I("UT5",{args:{params:e}});if((t=e.schema).encrypted&&t.encrypted.length>0||t.attachments&&t.attachments.encrypted)throw I("UT6",{args:{params:e}});var t;if(e.schema.attachments&&e.schema.attachments.compression)throw I("UT7",{args:{params:e}})}(e),rt(this,e,this.settings)},e}();function st(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){if(e.constructor!==t.constructor)return!1;var r,n;if(Array.isArray(e)){if((r=e.length)!==t.length)return!1;for(n=r;0!=n--;)if(!st(e[n],t[n]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();var a=Object.keys(e);if((r=a.length)!==Object.keys(t).length)return!1;for(n=r;0!=n--;)if(!Object.prototype.hasOwnProperty.call(t,a[n]))return!1;for(n=r;0!=n--;){var i=a[n];if(!st(e[i],t[i]))return!1}return!0}return e!=e&&t!=t}var ot=function(){function e(e,t){this.jsonSchema=e,this.hashFunction=t,this.indexes=function(e){return(e.indexes||[]).map((e=>(0,y.k_)(e)?e:[e]))}(this.jsonSchema),this.primaryPath=q(this.jsonSchema.primaryKey),this.finalFields=F(this.jsonSchema)}var t=e.prototype;return t.validateChange=function(e,t){this.finalFields.forEach((r=>{if(!st(e[r],t[r]))throw I("DOC9",{dataBefore:e,dataAfter:t,fieldName:r,schema:this.jsonSchema})}))},t.getDocumentPrototype=function(){var e={},t=B(this.jsonSchema,"");return Object.keys(t).forEach((t=>{var r=t;e.__defineGetter__(t,(function(){if(this.get&&"function"==typeof this.get)return this.get(r)})),Object.defineProperty(e,t+"$",{get:function(){return this.get$(r)},enumerable:!1,configurable:!1}),Object.defineProperty(e,t+"$$",{get:function(){return this.get$$(r)},enumerable:!1,configurable:!1}),Object.defineProperty(e,t+"_",{get:function(){return this.populate(r)},enumerable:!1,configurable:!1})})),l(this,"getDocumentPrototype",(()=>e)),e},t.getPrimaryOfDocumentData=function(e){return M(this.jsonSchema,e)},(0,b.A)(e,[{key:"version",get:function(){return this.jsonSchema.version}},{key:"defaultValues",get:function(){var e={};return Object.entries(this.jsonSchema.properties).filter((e=>{let[,t]=e;return Object.prototype.hasOwnProperty.call(t,"default")})).forEach((t=>{let[r,n]=t;return e[r]=n.default})),l(this,"defaultValues",e)}},{key:"hash",get:function(){return l(this,"hash",this.hashFunction(JSON.stringify(this.jsonSchema)))}}])}();function ct(e,t,r){void 0===r&&(r=!0),r&&qe("preCreateRxSchema",e);var n=W(e);n=function(e){return o(e,!0)}(n),D.deepFreezeWhenDevMode(n);var a=new ot(n,t);return qe("createRxSchema",a),a}var lt=r(7708),ut=r(8146),ht=r(3356),dt=r(5520),mt=r(8609),pt=r(1753);function ft(e){var t=e.split("-"),r="RxDB";return t.forEach((e=>{r+=P(e)})),r+="Plugin",new Error("You are using a function which must be overwritten by a plugin.\n        You should either prevent the usage of this function or add the plugin via:\n            import { "+r+" } from 'rxdb/plugins/"+e+"';\n            addRxPlugin("+r+");\n        ")}function vt(e){return e.documentData?e.documentData:e.previousDocumentData}var gt=function(){function e(e,t,r,n){this.queueByDocId=new Map,this.isRunning=!1,this.storageInstance=e,this.primaryPath=t,this.preWrite=r,this.postWrite=n}var t=e.prototype;return t.addWrite=function(e,t){var r=e[this.primaryPath],n=i(this.queueByDocId,r,(()=>[]));return new Promise(((r,a)=>{var i={lastKnownDocumentState:e,modifier:t,resolve:r,reject:a};(0,ce.ZN)(n).push(i),this.triggerRun()}))},t.triggerRun=async function(){if(!0!==this.isRunning&&0!==this.queueByDocId.size){this.isRunning=!0;var e=[],t=this.queueByDocId;this.queueByDocId=new Map,await Promise.all(Array.from(t.entries()).map((async t=>{let[r,n]=t;var a,i,s,o=(a=n.map((e=>e.lastKnownDocumentState)),i=a[0],s=$e(i._rev).height,a.forEach((e=>{var t=$e(e._rev).height;t>s&&(i=e,s=t)})),i),l=o;for(var u of n)try{l=await u.modifier(c(l))}catch(h){u.reject(h),u.reject=()=>{},u.resolve=()=>{}}try{await this.preWrite(l,o)}catch(h){return void n.forEach((e=>e.reject(h)))}e.push({previous:o,document:l})})));var r=e.length>0?await this.storageInstance.bulkWrite(e,"incremental-write"):{error:[],success:[]};return await Promise.all(r.success.map((e=>{var r=e[this.primaryPath];this.postWrite(e),a(t,r).forEach((t=>t.resolve(e)))}))),r.error.forEach((e=>{var r,n=e.documentId,s=a(t,n),o=E(e);if(o){var c=i(this.queueByDocId,n,(()=>[]));s.reverse().forEach((e=>{e.lastKnownDocumentState=(0,ce.ZN)(o.documentInDb),(0,ce.ZN)(c).unshift(e)}))}else{var l=I("COL20",{name:R[(r=e).status],document:r.documentId,writeError:r});s.forEach((e=>e.reject(l)))}})),this.isRunning=!1,this.triggerRun()}},e}();function yt(e){return async t=>{var r=function(e){return Object.assign({},e,{_meta:void 0,_deleted:void 0,_rev:void 0})}(t);r._deleted=t._deleted;var n=await e(r),a=Object.assign({},n,{_meta:t._meta,_attachments:t._attachments,_rev:t._rev,_deleted:void 0!==n._deleted?n._deleted:t._deleted});return void 0===a._deleted&&(a._deleted=!1),a}}var bt={get primaryPath(){if(this.isInstanceOfRxDocument)return this.collection.schema.primaryPath},get primary(){var e=this;if(e.isInstanceOfRxDocument)return e._data[e.primaryPath]},get revision(){if(this.isInstanceOfRxDocument)return this._data._rev},get deleted$(){if(this.isInstanceOfRxDocument)return this.$.pipe((0,lt.T)((e=>e._data._deleted)))},get deleted$$(){var e=this;return e.collection.database.getReactivityFactory().fromObservable(e.deleted$,e.getLatest().deleted,e.collection.database)},get deleted(){if(this.isInstanceOfRxDocument)return this._data._deleted},getLatest(){var e=this.collection._docCache.getLatestDocumentData(this.primary);return this.collection._docCache.getCachedRxDocument(e)},get $(){return this.collection.$.pipe((0,ut.p)((e=>!e.isLocal)),(0,ut.p)((e=>e.documentId===this.primary)),(0,lt.T)((e=>vt(e))),(0,ht.Z)(this.collection._docCache.getLatestDocumentData(this.primary)),(0,dt.F)(((e,t)=>e._rev===t._rev)),(0,lt.T)((e=>this.collection._docCache.getCachedRxDocument(e))),(0,mt.t)(ce.bz))},get $$(){var e=this;return e.collection.database.getReactivityFactory().fromObservable(e.$,e.getLatest()._data,e.collection.database)},get$(e){if(D.isDevMode()){if(e.includes(".item."))throw I("DOC1",{path:e});if(e===this.primaryPath)throw I("DOC2");if(this.collection.schema.finalFields.includes(e))throw I("DOC3",{path:e});if(!B(this.collection.schema.jsonSchema,e))throw I("DOC4",{path:e})}return this.$.pipe((0,lt.T)((t=>v(t,e))),(0,dt.F)())},get$$(e){var t=this.get$(e);return this.collection.database.getReactivityFactory().fromObservable(t,this.getLatest().get(e),this.collection.database)},populate(e){var t=B(this.collection.schema.jsonSchema,e),r=this.get(e);if(!r)return pt.$A;if(!t)throw I("DOC5",{path:e});if(!t.ref)throw I("DOC6",{path:e,schemaObj:t});var n=this.collection.database.collections[t.ref];if(!n)throw I("DOC7",{ref:t.ref,path:e,schemaObj:t});return"array"===t.type?n.findByIds(r).exec().then((e=>{var t=e.values();return Array.from(t)})):n.findOne(r).exec()},get(e){return i(this._propertyCache,e,(()=>{var t=v(this._data,e);if("object"!=typeof t||null===t||Array.isArray(t))return D.deepFreezeWhenDevMode(t);var r=this;return new Proxy(s(t),{get(t,n){if("string"!=typeof n)return t[n];var a=n.charAt(n.length-1);if(n.endsWith("$$")){var i=n.slice(0,-2);return r.get$$($(e+"."+i))}if("$"===a){var s=n.slice(0,-1);return r.get$($(e+"."+s))}if("_"===a){var o=n.slice(0,-1);return r.populate($(e+"."+o))}return r.get($(e+"."+n))}})}))},toJSON(e){if(void 0===e&&(e=!1),e)return D.deepFreezeWhenDevMode(this._data);var t=s(this._data);return delete t._rev,delete t._attachments,delete t._deleted,delete t._meta,D.deepFreezeWhenDevMode(t)},toMutableJSON(e){return void 0===e&&(e=!1),c(this.toJSON(e))},update(e){throw ft("update")},incrementalUpdate(e){throw ft("update")},updateCRDT(e){throw ft("crdt")},putAttachment(){throw ft("attachments")},getAttachment(){throw ft("attachments")},allAttachments(){throw ft("attachments")},get allAttachments$(){throw ft("attachments")},async modify(e,t){var r=this._data,n=await yt(e)(r);return this._saveData(n,r)},incrementalModify(e,t){return this.collection.incrementalWriteQueue.addWrite(this._data,yt(e)).then((e=>this.collection._docCache.getCachedRxDocument(e)))},patch(e){var t=this._data,r=c(t);return Object.entries(e).forEach((e=>{let[t,n]=e;r[t]=n})),this._saveData(r,t)},incrementalPatch(e){return this.incrementalModify((t=>(Object.entries(e).forEach((e=>{let[r,n]=e;t[r]=n})),t)))},async _saveData(e,t){if(e=s(e),this._data._deleted)throw I("DOC11",{id:this.primary,document:this});await xt(this.collection,e,t);var r=await this.collection.storageInstance.bulkWrite([{previous:t,document:e}],"rx-document-save-data"),n=r.error[0];return He(this.collection,this.primary,e,n),await this.collection._runHooks("post","save",e,this),this.collection._docCache.getCachedRxDocument(r.success[0])},remove(){var e=this.collection;if(this.deleted)return Promise.reject(I("DOC13",{document:this,id:this.primary}));var t,r=s(this._data);return e._runHooks("pre","remove",r,this).then((async()=>{r._deleted=!0;var t=await e.storageInstance.bulkWrite([{previous:this._data,document:r}],"rx-document-remove"),n=t.error[0];return He(e,this.primary,r,n),t.success[0]})).then((e=>(t=e,this.collection._runHooks("post","remove",r,this)))).then((()=>this.collection._docCache.getCachedRxDocument(t)))},incrementalRemove(){return this.incrementalModify((async e=>(await this.collection._runHooks("pre","remove",e,this),e._deleted=!0,e))).then((async e=>(await this.collection._runHooks("post","remove",e._data,e),e)))},destroy(){throw I("DOC14")}};function wt(e){void 0===e&&(e=bt);var t=function(e,t){this.collection=e,this._data=t,this._propertyCache=new Map,this.isInstanceOfRxDocument=!0};return t.prototype=e,t}function xt(e,t,r){return t._meta=Object.assign({},r._meta,t._meta),D.isDevMode()&&e.schema.validateChange(r,t),e._runHooks("pre","save",t,r)}var Dt=r(2198),kt=r(511),jt=r(4157),_t=r(2442),It=r(6114);function St(e,t){return t.sort&&0!==t.sort.length?t.sort.map((e=>Object.keys(e)[0])):[e]}var Et=new WeakMap;function Rt(e,t){if(!e.collection.database.eventReduce)return{runFullQueryAgain:!0};var r=function(e){return i(Et,e,(()=>{var t=e.collection,r=Se(t.storageInstance.schema,c(e.mangoQuery)),n=t.schema.primaryPath,a=Ee(t.schema.jsonSchema,r),i=Re(t.schema.jsonSchema,r);return{primaryKey:e.collection.schema.primaryPath,skip:r.skip,limit:r.limit,sortFields:St(n,r),sortComparator:(t,r)=>{var n={docA:t,docB:r,rxQuery:e};return a(n.docA,n.docB)},queryMatcher:t=>i({doc:t,rxQuery:e}.doc)}}))}(e),n=(0,ce.ZN)(e._result).docsData.slice(0),a=(0,ce.ZN)(e._result).docsDataMap,s=!1;return t.map((e=>function(e){switch(e.operation){case"INSERT":return{operation:e.operation,id:e.documentId,doc:e.documentData,previous:null};case"UPDATE":return{operation:e.operation,id:e.documentId,doc:D.deepFreezeWhenDevMode(e.documentData),previous:e.previousDocumentData?e.previousDocumentData:"UNKNOWN"};case"DELETE":return{operation:e.operation,id:e.documentId,doc:null,previous:e.previousDocumentData}}}(e))).filter(y.S7).find((e=>{var t={queryParams:r,changeEvent:e,previousResults:n,keyDocumentMap:a},i=(0,It.kC)(t);return"runFullQueryAgain"===i||("doNothing"!==i?(s=!0,(0,It.Cs)(i,r,e,n,a),!1):void 0)}))?{runFullQueryAgain:!0}:{runFullQueryAgain:!1,changed:s,newResults:n}}var Ot=function(){function e(){this._map=new Map}return e.prototype.getByQuery=function(e){var t=e.toString();return i(this._map,t,(()=>e))},e}();function Ct(e,t){t.uncached=!0;var r=t.toString();e._map.delete(r)}function Nt(e){return e.refCount$.observers.length}var Pt,$t,Tt=(Pt=100,$t=3e4,(e,t)=>{if(!(t._map.size<Pt)){var r=(0,oe.t)()-$t,n=[],a=Array.from(t._map.values());for(var i of a)Nt(i)>0||(0===i._lastEnsureEqual&&i._creationTime<r?Ct(t,i):n.push(i));var s=n.length-Pt;s<=0||n.sort(((e,t)=>e._lastEnsureEqual-t._lastEnsureEqual)).slice(0,s).forEach((e=>Ct(t,e)))}}),At=new WeakSet;var Bt=function(){function e(e,t,r){this.cacheItemByDocId=new Map,this.registry="function"==typeof FinalizationRegistry?new FinalizationRegistry((e=>{var t=e.docId,r=this.cacheItemByDocId.get(t);r&&(r[0].delete(e.revisionHeight),0===r[0].size&&this.cacheItemByDocId.delete(t))})):void 0,this.primaryPath=e,this.changes$=t,this.documentCreator=r,t.subscribe((e=>{var t=e.documentId,r=this.cacheItemByDocId.get(t);if(r){var n=vt(e);r[1]=n}}))}var t=e.prototype;return t.getLatestDocumentData=function(e){return a(this.cacheItemByDocId,e)[1]},t.getLatestDocumentDataIfExists=function(e){var t=this.cacheItemByDocId.get(e);if(t)return t[1]},(0,b.A)(e,[{key:"getCachedRxDocuments",get:function(){return l(this,"getCachedRxDocuments",qt(this))}},{key:"getCachedRxDocument",get:function(){var e=qt(this);return l(this,"getCachedRxDocument",(t=>e([t])[0]))}}])}();function qt(e){var t=e.primaryPath,r=e.cacheItemByDocId,n=e.registry,a=D.deepFreezeWhenDevMode,i=e.documentCreator;return e=>{for(var s=new Array(e.length),o=[],c=0;c<e.length;c++){var l=e[c],u=l[t],h=Te(l._rev),d=void 0,m=void 0,p=r.get(u);p?m=(d=p[0]).get(h):(p=[d=new Map,l],r.set(u,p));var f=m?m.deref():void 0;f||(l=a(l),f=i(l),d.set(h,Wt(f)),n&&o.push(f)),s[c]=f}return o.length>0&&n&&(0,pt.vN)().then((()=>{for(var e=0;e<o.length;e++){var t=o[e];n.register(t,{docId:t.primary,revisionHeight:Te(t.revision)})}})),s}}function Mt(e,t){return(0,e.getCachedRxDocuments)(t)}var Wt="function"==typeof WeakRef?function(e){return new WeakRef(e)}:function(e){return{deref:()=>e}};var Lt=function(){return(0,b.A)((function(e,t,r){this.time=(0,oe.t)(),this.collection=e,this.count=r,this.documents=Mt(this.collection._docCache,t)}),[{key:"docsData",get:function(){return l(this,"docsData",this.documents.map((e=>e._data)))}},{key:"docsDataMap",get:function(){var e=new Map;return this.documents.forEach((t=>{e.set(t.primary,t._data)})),l(this,"docsDataMap",e)}},{key:"docsMap",get:function(){for(var e=new Map,t=this.documents,r=0;r<t.length;r++){var n=t[r];e.set(n.primary,n)}return l(this,"docsMap",e)}}])}(),Ft=0,Ht=function(){function e(e,t,r,n){void 0===n&&(n={}),this.id=++Ft,this._execOverDatabaseCount=0,this._creationTime=(0,oe.t)(),this._lastEnsureEqual=0,this.uncached=!1,this.refCount$=new Dt.t(null),this._result=null,this._latestChangeEvent=-1,this._lastExecStart=0,this._lastExecEnd=0,this._ensureEqualQueue=pt.Dr,this.op=e,this.mangoQuery=t,this.collection=r,this.other=n,t||(this.mangoQuery={selector:{}}),this.isFindOneByIdQuery=function(e,t){if(!t.skip&&t.selector&&1===Object.keys(t.selector).length&&t.selector[e]){var r=t.selector[e];if("string"==typeof r)return r;if(1===Object.keys(r).length&&"string"==typeof r.$eq)return r.$eq;if(1===Object.keys(r).length&&Array.isArray(r.$eq)&&!r.$eq.find((e=>"string"!=typeof e)))return r.$eq}return!1}(this.collection.schema.primaryPath,t)}var t=e.prototype;return t._setResultData=function(e){if("number"!=typeof e){e instanceof Map&&(e=Array.from(e.values()));var t=new Lt(this.collection,e,e.length);this._result=t}else this._result=new Lt(this.collection,[],e)},t._execOverDatabase=async function(){if(this._execOverDatabaseCount=this._execOverDatabaseCount+1,this._lastExecStart=(0,oe.t)(),"count"===this.op){var e=this.getPreparedQuery(),t=await this.collection.storageInstance.count(e);if("slow"!==t.mode||this.collection.database.allowSlowCount)return t.count;throw I("QU14",{collection:this.collection,queryObj:this.mangoQuery})}if("findByIds"===this.op){var r=(0,ce.ZN)(this.mangoQuery.selector)[this.collection.schema.primaryPath].$in,n=new Map,a=[];if(r.forEach((e=>{var t=this.collection._docCache.getLatestDocumentDataIfExists(e);if(t){if(!t._deleted){var r=this.collection._docCache.getCachedRxDocument(t);n.set(e,r)}}else a.push(e)})),a.length>0)(await this.collection.storageInstance.findDocumentsById(a,!1)).forEach((e=>{var t=this.collection._docCache.getCachedRxDocument(e);n.set(t.primary,t)}));return n}var i=async function(e){var t=[],r=e.collection;if(e.isFindOneByIdQuery)if(Array.isArray(e.isFindOneByIdQuery)){var n=e.isFindOneByIdQuery;if(n=n.filter((r=>{var n=e.collection._docCache.getLatestDocumentDataIfExists(r);return!n||(n._deleted||t.push(n),!1)})),n.length>0){var a=await r.storageInstance.findDocumentsById(n,!1);(0,y.Hb)(t,a)}}else{var i=e.isFindOneByIdQuery,s=e.collection._docCache.getLatestDocumentDataIfExists(i);if(!s){var o=await r.storageInstance.findDocumentsById([i],!1);o[0]&&(s=o[0])}s&&!s._deleted&&t.push(s)}else{var c=e.getPreparedQuery(),l=await r.storageInstance.query(c);t=l.documents}return t}(this);return i.then((e=>(this._lastExecEnd=(0,oe.t)(),e)))},t.exec=function(e){if(e&&"findOne"!==this.op)throw I("QU9",{collection:this.collection.name,query:this.mangoQuery,op:this.op});return Kt(this).then((()=>(0,kt._)(this.$))).then((t=>{if(!t&&e)throw I("QU10",{collection:this.collection.name,query:this.mangoQuery,op:this.op});return t}))},t.toString=function(){var e=o({op:this.op,query:this.mangoQuery,other:this.other},!0),t=JSON.stringify(e);return this.toString=()=>t,t},t.getPreparedQuery=function(){var e={rxQuery:this,mangoQuery:Se(this.collection.schema.jsonSchema,this.mangoQuery)};e.mangoQuery.selector._deleted={$eq:!1},e.mangoQuery.index&&e.mangoQuery.index.unshift("_deleted"),qe("prePrepareQuery",e);var t=Ut(this.collection.schema.jsonSchema,e.mangoQuery);return this.getPreparedQuery=()=>t,t},t.doesDocumentDataMatch=function(e){return!e._deleted&&this.queryMatcher(e)},t.remove=function(){return this.exec().then((e=>Array.isArray(e)?Promise.all(e.map((e=>e.remove()))):e.remove()))},t.update=function(e){throw ft("update")},t.where=function(e){throw ft("query-builder")},t.sort=function(e){throw ft("query-builder")},t.skip=function(e){throw ft("query-builder")},t.limit=function(e){throw ft("query-builder")},(0,b.A)(e,[{key:"$",get:function(){if(!this._$){var e=this.collection.$.pipe((0,ut.p)((e=>!e.isLocal)),(0,ht.Z)(null),(0,_t.Z)((()=>Kt(this))),(0,lt.T)((()=>this._result)),(0,mt.t)(ce.bz),(0,dt.F)(((e,t)=>!(!e||e.time!==(0,ce.ZN)(t).time))),(0,ut.p)((e=>!!e)),(0,lt.T)((e=>{var t=(0,ce.ZN)(e);return"count"===this.op?t.count:"findOne"===this.op?0===t.documents.length?null:t.documents[0]:"findByIds"===this.op?t.docsMap:t.documents.slice(0)})));this._$=(0,jt.h)(e,this.refCount$.pipe((0,ut.p)((()=>!1))))}return this._$}},{key:"$$",get:function(){return this.collection.database.getReactivityFactory().fromObservable(this.$,void 0,this.collection.database)}},{key:"queryMatcher",get:function(){this.collection.schema.jsonSchema;return l(this,"queryMatcher",Re(0,Se(this.collection.schema.jsonSchema,this.mangoQuery)))}},{key:"asRxQuery",get:function(){return this}}])}();function Qt(e,t,r,n){qe("preCreateRxQuery",{op:e,queryObj:t,collection:r,other:n});var a,i,s=new Ht(e,t,r,n);return s=(a=s).collection._queryCache.getByQuery(a),i=r,At.has(i)||(At.add(i),(0,pt.dY)().then((()=>(0,pt.Ve)(200))).then((()=>{i.destroyed||i.cacheReplacementPolicy(i,i._queryCache),At.delete(i)}))),s}function zt(e){var t=e.asRxQuery.collection._changeEventBuffer.counter;return e._latestChangeEvent>=t}function Kt(e){return e.collection.database.destroyed||zt(e)?pt.Dr:(e._ensureEqualQueue=e._ensureEqualQueue.then((()=>function(e){if(e._lastEnsureEqual=(0,oe.t)(),e.collection.database.destroyed||zt(e))return pt.Dr;var t=!1,r=!1;-1===e._latestChangeEvent&&(r=!0);if(!r){var n=e.asRxQuery.collection._changeEventBuffer.getFrom(e._latestChangeEvent+1);if(null===n)r=!0;else{e._latestChangeEvent=e.asRxQuery.collection._changeEventBuffer.counter;var a=e.asRxQuery.collection._changeEventBuffer.reduceByLastOfDoc(n);if("count"===e.op){var i=(0,ce.ZN)(e._result).count,s=i;a.forEach((t=>{var r=t.previousDocumentData&&e.doesDocumentDataMatch(t.previousDocumentData),n=e.doesDocumentDataMatch(t.documentData);!r&&n&&s++,r&&!n&&s--})),s!==i&&(t=!0,e._setResultData(s))}else{var o=Rt(e,a);o.runFullQueryAgain?r=!0:o.changed&&(t=!0,e._setResultData(o.newResults))}}}if(r)return e._execOverDatabase().then((r=>(e._latestChangeEvent=e.collection._changeEventBuffer.counter,"number"==typeof r?(e._result&&r===e._result.count||(t=!0,e._setResultData(r)),t):(e._result&&function(e,t,r){if(t.length!==r.length)return!1;for(var n=0,a=t.length;n<a;){var i=t[n],s=r[n];if(n++,i._rev!==s._rev||i[e]!==s[e])return!1}return!0}(e.collection.schema.primaryPath,r,e._result.docsData)||(t=!0,e._setResultData(r)),t))));return Promise.resolve(t)}(e))),e._ensureEqualQueue)}function Ut(e,t){if(!t.sort)throw I("SNH",{query:t});return{query:t,queryPlan:he(e,t)}}var Zt="collection",Vt="storage-token",Jt=W({version:0,title:"RxInternalDocument",primaryKey:{key:"id",fields:["context","key"],separator:"|"},type:"object",properties:{id:{type:"string",maxLength:200},key:{type:"string"},context:{type:"string",enum:[Zt,Vt,"rx-migration-status","OTHER"]},data:{type:"object",additionalProperties:!0}},indexes:[],required:["key","context","data"],additionalProperties:!1,sharding:{shards:1,mode:"collection"}});function Gt(e,t){return M(Jt,{key:e,context:t})}async function Yt(e){var t=Ut(e.schema,{selector:{context:Zt,_deleted:{$eq:!1}},sort:[{id:"asc"}],skip:0});return(await e.query(t)).documents}var Xt="storageToken",er=Gt(Xt,Vt);function tr(e,t){return e+"-"+t.version}function rr(e,t){return t=function(e,t){for(var r=Object.keys(e.defaultValues),n=0;n<r.length;++n){var a=r[n];Object.prototype.hasOwnProperty.call(t,a)&&void 0!==t[a]||(t[a]=e.defaultValues[a])}return t}(e,t=s(t)),(t=function(e,t,r){if("string"==typeof t.primaryKey)return r;var n=M(t,r),a=r[e];if(a&&a!==n)throw I("DOC19",{args:{documentData:r,existingPrimary:a,newPrimary:n},schema:t});return r[e]=n,r}(e.primaryPath,e.jsonSchema,t))._meta=A(),Object.prototype.hasOwnProperty.call(t,"_deleted")||(t._deleted=!1),Object.prototype.hasOwnProperty.call(t,"_attachments")||(t._attachments={}),Object.prototype.hasOwnProperty.call(t,"_rev")||(t._rev=""),t}async function nr(e,t,r,n,a,i,s){var o=(await Yt(t)).filter((e=>e.data.name===a)),c=[];o.forEach((e=>{c.push({collectionName:e.data.name,schema:e.data.schema,isCollection:!0}),e.data.connectedStorages.forEach((e=>c.push({collectionName:e.collectionName,isCollection:!1,schema:e.schema})))}));var l=new Set;if(c=c.filter((e=>{var t=e.collectionName+"||"+e.schema.version;return!l.has(t)&&(l.add(t),!0)})),await Promise.all(c.map((async t=>{var s=await e.createStorageInstance({collectionName:t.collectionName,databaseInstanceToken:r,databaseName:n,multiInstance:!1,options:{},schema:t.schema,password:i,devMode:D.isDevMode()});await s.remove(),t.isCollection&&await Me("postRemoveRxCollection",{storage:e,databaseName:n,collectionName:a})}))),s){var u=o.map((e=>{var t=Ke(e);return t._deleted=!0,t._meta.lwt=(0,oe.t)(),t._rev=Ae(r,e),{previous:e,document:t}}));await t.bulkWrite(u,"rx-database-remove-collection-all")}}var ar=function(){function e(e){this.subs=[],this.limit=100,this.counter=0,this.eventCounterMap=new WeakMap,this.buffer=[],this.collection=e,this.subs.push(this.collection.$.pipe((0,ut.p)((e=>!e.isLocal))).subscribe((e=>this._handleChangeEvent(e))))}var t=e.prototype;return t._handleChangeEvent=function(e){for(this.counter++,this.buffer.push(e),this.eventCounterMap.set(e,this.counter);this.buffer.length>this.limit;)this.buffer.shift()},t.getArrayIndexByPointer=function(e){var t=this.buffer[0],r=this.eventCounterMap.get(t);return e<r?null:e-r},t.getFrom=function(e){var t=[],r=this.getArrayIndexByPointer(e);if(null===r)return null;for(;;){var n=this.buffer[r];if(r++,!n)return t;t.push(n)}},t.runFrom=function(e,t){var r=this.getFrom(e);if(null===r)throw new Error("out of bounds");r.forEach((e=>t(e)))},t.reduceByLastOfDoc=function(e){return e.slice(0)},t.destroy=function(){this.subs.forEach((e=>e.unsubscribe()))},e}();var ir=new WeakMap;function sr(e){var t=e.schema.getDocumentPrototype(),r=function(e){var t={};return Object.entries(e.methods).forEach((e=>{let[r,n]=e;t[r]=n})),t}(e),n={};return[t,r,bt].forEach((e=>{Object.getOwnPropertyNames(e).forEach((t=>{var r=Object.getOwnPropertyDescriptor(e,t),a=!0;(t.startsWith("_")||t.endsWith("_")||t.startsWith("$")||t.endsWith("$"))&&(a=!1),"function"==typeof r.value?Object.defineProperty(n,t,{get(){return r.value.bind(this)},enumerable:a,configurable:!1}):(r.enumerable=a,r.configurable=!1,r.writable&&(r.writable=!1),Object.defineProperty(n,t,r))}))})),n}function or(e,t,r){var n=function(e,t,r){var n=new e(t,r);return qe("createRxDocument",n),n}(t,e,D.deepFreezeWhenDevMode(r));return e._runHooksSync("post","create",r,n),qe("postCreateRxDocument",n),n}var cr=function(e,t){return st(ze(e.newDocumentState),ze(e.realMasterState))?Promise.resolve({isEqual:!0}):Promise.resolve({isEqual:!1,documentData:e.realMasterState})};var lr=["pre","post"],ur=["insert","save","remove","create"],hr=!1,dr=function(){function e(e,t,r,n,a,i,s,o,c,l,u,h){void 0===a&&(a={}),void 0===i&&(i={}),void 0===s&&(s={}),void 0===o&&(o={}),void 0===c&&(c={}),void 0===l&&(l=Tt),void 0===u&&(u={}),void 0===h&&(h=cr),this.storageInstance={},this.timeouts=new Set,this.incrementalWriteQueue={},this._incrementalUpsertQueues=new Map,this.synced=!1,this.hooks={},this._subs=[],this._docCache={},this._queryCache=new Ot,this.$={},this.checkpoint$={},this._changeEventBuffer={},this.onDestroy=[],this.destroyed=!1,this.database=e,this.name=t,this.schema=r,this.internalStorageInstance=n,this.instanceCreationOptions=a,this.migrationStrategies=i,this.methods=s,this.attachments=o,this.options=c,this.cacheReplacementPolicy=l,this.statics=u,this.conflictHandler=h,function(e){if(hr)return;hr=!0;var t=Object.getPrototypeOf(e);ur.forEach((e=>{lr.map((r=>{var n=r+P(e);t[n]=function(t,n){return this.addHook(r,e,t,n)}}))}))}(this.asRxCollection)}var t=e.prototype;return t.prepare=async function(){this.storageInstance=Ue(this.database,this.internalStorageInstance,this.schema.jsonSchema),this.incrementalWriteQueue=new gt(this.storageInstance,this.schema.primaryPath,((e,t)=>xt(this,e,t)),(e=>this._runHooks("post","save",e)));var e,t,r=this.database.eventBulks$.pipe((0,ut.p)((e=>e.collectionName===this.name)));this.$=r.pipe((0,_t.Z)((e=>e.events))),this.checkpoint$=r.pipe((0,lt.T)((e=>e.checkpoint))),this._changeEventBuffer=(e=this.asRxCollection,new ar(e)),this._docCache=new Bt(this.schema.primaryPath,this.$.pipe((0,ut.p)((e=>!e.isLocal))),(e=>{var r;return t||(r=this.asRxCollection,t=i(ir,r,(()=>wt(sr(r))))),or(this.asRxCollection,t,e)}));var n=await this.database.storageToken,a=this.storageInstance.changeStream().subscribe((e=>{for(var t=new Array(e.events.length),r=e.events,a=this.name,i=D.deepFreezeWhenDevMode,s=0;s<r.length;s++){var o=r[s];t[s]={documentId:o.documentId,collectionName:a,isLocal:!1,operation:o.operation,documentData:i(o.documentData),previousDocumentData:i(o.previousDocumentData)}}var c={id:e.id,internal:!1,collectionName:this.name,storageToken:n,events:t,databaseToken:this.database.token,checkpoint:e.checkpoint,context:e.context,endTime:e.endTime,startTime:e.startTime};this.database.$emit(c)}));return this._subs.push(a),this._subs.push(this.storageInstance.conflictResultionTasks().subscribe((e=>{this.conflictHandler(e.input,e.context).then((t=>{this.storageInstance.resolveConflictResultionTask({id:e.id,output:t})}))}))),pt.em},t.cleanup=function(e){throw ft("cleanup")},t.migrationNeeded=function(){throw ft("migration-schema")},t.getMigrationState=function(){throw ft("migration-schema")},t.startMigration=function(e){return void 0===e&&(e=10),this.getMigrationState().startMigration(e)},t.migratePromise=function(e){return void 0===e&&(e=10),this.getMigrationState().migratePromise(e)},t.insert=async function(e){var t=await this.bulkInsert([e]),r=t.error[0];return He(this,e[this.schema.primaryPath],e,r),(0,ce.ZN)(t.success[0])},t.bulkInsert=async function(e){if(0===e.length)return{success:[],error:[]};var t,r=this.schema.primaryPath;if(this.hasHooks("pre","insert"))t=await Promise.all(e.map((e=>{var t=rr(this.schema,e);return this._runHooks("pre","insert",t).then((()=>({document:t})))})));else{t=[];for(var n=0;n<e.length;n++){var a=e[n],i=rr(this.schema,a);t[n]={document:i}}}var s=await this.storageInstance.bulkWrite(t,"rx-collection-bulk-insert"),o=Mt(this._docCache,s.success);if(this.hasHooks("post","insert")){var c=new Map;t.forEach((e=>{var t=e.document;c.set(t[r],t)})),await Promise.all(o.map((e=>this._runHooks("post","insert",c.get(e.primary),e))))}return{success:o,error:s.error}},t.bulkRemove=async function(e){var t=this.schema.primaryPath;if(0===e.length)return{success:[],error:[]};var r=await this.findByIds(e).exec(),n=[],i=new Map;Array.from(r.values()).forEach((e=>{var t=e.toMutableJSON(!0);n.push(t),i.set(e.primary,t)})),await Promise.all(n.map((e=>{var t=e[this.schema.primaryPath];return this._runHooks("pre","remove",e,r.get(t))})));var o=n.map((e=>{var t=s(e);return t._deleted=!0,{previous:e,document:t}})),c=await this.storageInstance.bulkWrite(o,"rx-collection-bulk-remove"),l=c.success.map((e=>e[t]));return await Promise.all(l.map((e=>this._runHooks("post","remove",i.get(e),r.get(e))))),{success:l.map((e=>a(r,e))),error:c.error}},t.bulkUpsert=async function(e){var t=[],r=new Map;e.forEach((e=>{var n=rr(this.schema,e),a=n[this.schema.primaryPath];if(!a)throw I("COL3",{primaryPath:this.schema.primaryPath,data:n,schema:this.schema.jsonSchema});r.set(a,n),t.push(n)}));var n=await this.bulkInsert(t),i=n.success.slice(0),s=[];return await Promise.all(n.error.map((async e=>{if(409!==e.status)s.push(e);else{var t=e.documentId,n=a(r,t),o=(0,ce.ZN)(e.documentInDb),c=this._docCache.getCachedRxDocuments([o])[0],l=await c.incrementalModify((()=>n));i.push(l)}}))),{error:s,success:i}},t.upsert=async function(e){var t=await this.bulkUpsert([e]);return He(this.asRxCollection,e[this.schema.primaryPath],e,t.error[0]),t.success[0]},t.incrementalUpsert=function(e){var t=rr(this.schema,e),r=t[this.schema.primaryPath];if(!r)throw I("COL4",{data:e});var n=this._incrementalUpsertQueues.get(r);return n||(n=pt.em),n=n.then((()=>function(e,t,r){var n=e._docCache.getLatestDocumentDataIfExists(t);if(n)return Promise.resolve({doc:e._docCache.getCachedRxDocuments([n])[0],inserted:!1});return e.findOne(t).exec().then((t=>t?{doc:t,inserted:!1}:e.insert(r).then((e=>({doc:e,inserted:!0})))))}(this,r,t))).then((e=>e.inserted?e.doc:function(e,t){return e.incrementalModify((e=>t))}(e.doc,t))),this._incrementalUpsertQueues.set(r,n),n},t.find=function(e){if("string"==typeof e)throw I("COL5",{queryObj:e});return e||(e={selector:{}}),Qt("find",e,this)},t.findOne=function(e){if("number"==typeof e||Array.isArray(e))throw S("COL6",{queryObj:e});var t;if("string"==typeof e)t=Qt("findOne",{selector:{[this.schema.primaryPath]:e},limit:1},this);else{if(e||(e={selector:{}}),e.limit)throw I("QU6");(e=s(e)).limit=1,t=Qt("findOne",e,this)}return t},t.count=function(e){return e||(e={selector:{}}),Qt("count",e,this)},t.findByIds=function(e){return Qt("findByIds",{selector:{[this.schema.primaryPath]:{$in:e.slice(0)}}},this)},t.exportJSON=function(){throw ft("json-dump")},t.importJSON=function(e){throw ft("json-dump")},t.insertCRDT=function(e){throw ft("crdt")},t.addHook=function(e,t,r,n){if(void 0===n&&(n=!1),"function"!=typeof r)throw S("COL7",{key:t,when:e});if(!lr.includes(e))throw S("COL8",{key:t,when:e});if(!ur.includes(t))throw I("COL9",{key:t});if("post"===e&&"create"===t&&!0===n)throw I("COL10",{when:e,key:t,parallel:n});var a=r.bind(this),i=n?"parallel":"series";this.hooks[t]=this.hooks[t]||{},this.hooks[t][e]=this.hooks[t][e]||{series:[],parallel:[]},this.hooks[t][e][i].push(a)},t.getHooks=function(e,t){return this.hooks[t]&&this.hooks[t][e]?this.hooks[t][e]:{series:[],parallel:[]}},t.hasHooks=function(e,t){if(!this.hooks[t]||!this.hooks[t][e])return!1;var r=this.getHooks(e,t);return!!r&&(r.series.length>0||r.parallel.length>0)},t._runHooks=function(e,t,r,n){var a=this.getHooks(e,t);if(!a)return pt.em;var i=a.series.map((e=>()=>e(r,n)));return(0,pt.h$)(i).then((()=>Promise.all(a.parallel.map((e=>e(r,n))))))},t._runHooksSync=function(e,t,r,n){if(this.hasHooks(e,t)){var a=this.getHooks(e,t);a&&a.series.forEach((e=>e(r,n)))}},t.promiseWait=function(e){return new Promise((t=>{var r=setTimeout((()=>{this.timeouts.delete(r),t()}),e);this.timeouts.add(r)}))},t.destroy=function(){return this.destroyed?pt.Dr:(this.destroyed=!0,Array.from(this.timeouts).forEach((e=>clearTimeout(e))),this._changeEventBuffer&&this._changeEventBuffer.destroy(),this.database.requestIdlePromise().then((()=>Promise.all(this.onDestroy.map((e=>e()))))).then((()=>this.storageInstance.close())).then((()=>(this._subs.forEach((e=>e.unsubscribe())),delete this.database.collections[this.name],Me("postDestroyRxCollection",this).then((()=>!0))))))},t.remove=async function(){await this.destroy(),await nr(this.database.storage,this.database.internalStore,this.database.token,this.database.name,this.name,this.database.password,this.database.hashFunction)},(0,b.A)(e,[{key:"insert$",get:function(){return this.$.pipe((0,ut.p)((e=>"INSERT"===e.operation)))}},{key:"update$",get:function(){return this.$.pipe((0,ut.p)((e=>"UPDATE"===e.operation)))}},{key:"remove$",get:function(){return this.$.pipe((0,ut.p)((e=>"DELETE"===e.operation)))}},{key:"asRxCollection",get:function(){return this}}])}();var mr=r(7635),pr=r(1007);var fr="undefined"!=typeof crypto&&void 0!==crypto.subtle&&"function"==typeof crypto.subtle.digest?async function(e){var t=(new TextEncoder).encode(e),r=await crypto.subtle.digest("SHA-256",t);return Array.prototype.map.call(new Uint8Array(r),(e=>("00"+e.toString(16)).slice(-2))).join("")}:function(e){return Promise.resolve((0,pr.sc)(e))},vr=r(5525),gr=new Set,yr=function(){function e(e,t,r,n,a,i,s,o,c,l,u,h,d){void 0===s&&(s=!1),void 0===o&&(o={}),this.idleQueue=new mr.G,this.rxdbVersion=at,this.storageInstances=new Set,this._subs=[],this.startupErrors=[],this.onDestroy=[],this.destroyed=!1,this.collections={},this.states={},this.eventBulks$=new se.B,this.observable$=this.eventBulks$.pipe((0,_t.Z)((e=>e.events))),this.storageToken=pt.Dr,this.storageTokenDocument=pt.Dr,this.emittedEventBulkIds=new vr.p4(6e4),this.name=e,this.token=t,this.storage=r,this.instanceCreationOptions=n,this.password=a,this.multiInstance=i,this.eventReduce=s,this.options=o,this.internalStore=c,this.hashFunction=l,this.cleanupPolicy=u,this.allowSlowCount=h,this.reactivity=d,"pseudoInstance"!==this.name&&(this.internalStore=Ue(this.asRxDatabase,c,Jt),this.storageTokenDocument=async function(e){var t=N(10),r=e.password?await e.hashFunction(JSON.stringify(e.password)):void 0,n={id:er,context:Vt,key:Xt,data:{rxdbVersion:e.rxdbVersion,token:t,instanceToken:e.token,passwordHash:r},_deleted:!1,_meta:A(),_rev:"",_attachments:{}},a=await e.internalStore.bulkWrite([{document:n}],"internal-add-storage-token");if(a.success[0])return a.success[0];var i=(0,ce.ZN)(a.error[0]);if(i.isError&&E(i)){var s=i;if(c=s.documentInDb.data.rxdbVersion,l=e.rxdbVersion,!c||l.includes("beta")&&l!==c||c.split(".")[0]!==l.split(".")[0])throw I("DM5",{args:{database:e.name,databaseStateVersion:s.documentInDb.data.rxdbVersion,codeVersion:e.rxdbVersion}});if(r&&r!==s.documentInDb.data.passwordHash)throw I("DB1",{passwordHash:r,existingPasswordHash:s.documentInDb.data.passwordHash});var o=s.documentInDb;return(0,ce.ZN)(o)}var c,l;throw i}(this.asRxDatabase).catch((e=>this.startupErrors.push(e))),this.storageToken=this.storageTokenDocument.then((e=>e.data.token)).catch((e=>this.startupErrors.push(e))))}var t=e.prototype;return t.getReactivityFactory=function(){if(!this.reactivity)throw I("DB14",{database:this.name});return this.reactivity},t.$emit=function(e){this.emittedEventBulkIds.has(e.id)||(this.emittedEventBulkIds.add(e.id),this.eventBulks$.next(e))},t.removeCollectionDoc=async function(e,t){var r=await Le(this.internalStore,Gt(tr(e,t),Zt));if(!r)throw I("SNH",{name:e,schema:t});var n=Ke(r);n._deleted=!0,await this.internalStore.bulkWrite([{document:n,previous:r}],"rx-database-remove-collection")},t.addCollections=async function(e){var t={},r={},n=[],a={};await Promise.all(Object.entries(e).map((async e=>{let[i,o]=e;var c=i,l=o.schema;t[c]=l;var u=ct(l,this.hashFunction);if(r[c]=u,this.collections[i])throw I("DB3",{name:i});var h=tr(i,l),d={id:Gt(h,Zt),key:h,context:Zt,data:{name:c,schemaHash:await u.hash,schema:u.jsonSchema,version:u.version,connectedStorages:[]},_deleted:!1,_meta:A(),_rev:"",_attachments:{}};n.push({document:d});var m=Object.assign({},o,{name:c,schema:u,database:this}),p=s(o);p.database=this,p.name=i,qe("preCreateRxCollection",p),m.conflictHandler=p.conflictHandler,a[c]=m})));var i=await this.internalStore.bulkWrite(n,"rx-database-add-collection");await async function(e){if(await e.storageToken,e.startupErrors[0])throw e.startupErrors[0]}(this),await Promise.all(i.error.map((async e=>{if(409!==e.status)throw I("DB12",{database:this.name,writeError:e});var n=(0,ce.ZN)(e.documentInDb),a=n.data.name,i=r[a];if(n.data.schemaHash!==await i.hash)throw I("DB6",{database:this.name,collection:a,previousSchemaHash:n.data.schemaHash,schemaHash:await i.hash,previousSchema:n.data.schema,schema:(0,ce.ZN)(t[a])})})));var o={};return await Promise.all(Object.keys(e).map((async e=>{var t=a[e],r=await function(e){let{database:t,name:r,schema:n,instanceCreationOptions:a={},migrationStrategies:i={},autoMigrate:s=!0,statics:o={},methods:c={},attachments:l={},options:u={},localDocuments:h=!1,cacheReplacementPolicy:d=Tt,conflictHandler:m=cr}=e;var p={databaseInstanceToken:t.token,databaseName:t.name,collectionName:r,schema:n.jsonSchema,options:a,multiInstance:t.multiInstance,password:t.password,devMode:D.isDevMode()};return qe("preCreateRxStorageInstance",p),async function(e,t){return t.multiInstance=e.multiInstance,await e.storage.createStorageInstance(t)}(t,p).then((e=>{var p=new dr(t,r,n,e,a,i,c,l,u,d,o,m);return p.prepare().then((()=>{Object.entries(o).forEach((e=>{let[t,r]=e;Object.defineProperty(p,t,{get:()=>r.bind(p)})}));var e=pt.em;return s&&0!==p.schema.version&&(e=p.migratePromise()),e})).then((()=>(qe("createRxCollection",{collection:p,creator:{name:r,schema:n,storageInstance:e,instanceCreationOptions:a,migrationStrategies:i,methods:c,attachments:l,options:u,cacheReplacementPolicy:d,localDocuments:h,statics:o}}),p))).catch((t=>e.close().then((()=>Promise.reject(t)))))}))}(t);o[e]=r,this.collections[e]=r,this[e]||Object.defineProperty(this,e,{get:()=>this.collections[e]})}))),o},t.lockedRun=function(e){return this.idleQueue.wrapCall(e)},t.requestIdlePromise=function(){return this.idleQueue.requestIdlePromise()},t.exportJSON=function(e){throw ft("json-dump")},t.addState=function(e){throw ft("state")},t.importJSON=function(e){throw ft("json-dump")},t.backup=function(e){throw ft("backup")},t.leaderElector=function(){throw ft("leader-election")},t.isLeader=function(){throw ft("leader-election")},t.waitForLeadership=function(){throw ft("leader-election")},t.migrationStates=function(){throw ft("migration-schema")},t.destroy=async function(){return this.destroyed?pt.Dr:(this.destroyed=!0,await Me("preDestroyRxDatabase",this),this.eventBulks$.complete(),this._subs.map((e=>e.unsubscribe())),"pseudoInstance"===this.name?pt.Dr:this.requestIdlePromise().then((()=>Promise.all(this.onDestroy.map((e=>e()))))).then((()=>Promise.all(Object.keys(this.collections).map((e=>this.collections[e])).map((e=>e.destroy()))))).then((()=>this.internalStore.close())).then((()=>gr.delete(this.storage.name+"|"+this.name))).then((()=>!0)))},t.remove=function(){return this.destroy().then((()=>async function(e,t,r){var n=N(10),a=await br(n,t,e,{},!1,r),i=await Yt(a),s=new Set;i.forEach((e=>s.add(e.data.name)));var o=Array.from(s);return await Promise.all(o.map((i=>nr(t,a,n,e,i,r)))),await Me("postRemoveRxDatabase",{databaseName:e,storage:t}),await a.remove(),o}(this.name,this.storage,this.password)))},(0,b.A)(e,[{key:"$",get:function(){return this.observable$}},{key:"asRxDatabase",get:function(){return this}}])}();async function br(e,t,r,n,a,i){return await t.createStorageInstance({databaseInstanceToken:e,databaseName:r,collectionName:We,schema:Jt,options:n,multiInstance:a,password:i,devMode:D.isDevMode()})}function wr(e){let{storage:t,instanceCreationOptions:r,name:n,password:a,multiInstance:i=!0,eventReduce:s=!0,ignoreDuplicate:o=!1,options:c={},cleanupPolicy:l,allowSlowCount:u=!1,localDocuments:h=!1,hashFunction:d=fr,reactivity:m}=e;qe("preCreateRxDatabase",{storage:t,instanceCreationOptions:r,name:n,password:a,multiInstance:i,eventReduce:s,ignoreDuplicate:o,options:c,localDocuments:h}),o||function(e,t){var r=t.name+"|"+e;if(gr.has(r))throw I("DB8",{name:e,storage:t.name,link:"https://rxdb.info/rx-database.html#ignoreduplicate"})}(n,t),gr.add(t.name+"|"+n);var p=N(10);return br(p,t,n,r,i,a).catch((e=>{throw gr.delete(t.name+"|"+n),e})).then((e=>{var f=new yr(n,p,t,r,a,i,s,c,e,d,l,u,m);return Me("createRxDatabase",{database:f,creator:{storage:t,instanceCreationOptions:r,name:n,password:a,multiInstance:i,eventReduce:s,ignoreDuplicate:o,options:c,localDocuments:h}}).then((()=>f))}))}var xr={RxSchema:ot.prototype,RxDocument:bt,RxQuery:Ht.prototype,RxCollection:dr.prototype,RxDatabase:yr.prototype},Dr=new Set,kr=new Set;var jr=function(e){function t(t,r,n){var a;return(a=e.call(this,null,r)||this).id=t,a.parent=n,a}return(0,w.A)(t,e),t}(wt()),_r={get isLocal(){return!0},get allAttachments$(){throw I("LD1",{document:this})},get primaryPath(){return"id"},get primary(){return this.id},get $(){var e=a(Or,this.parent);return this.parent.$.pipe((0,ut.p)((e=>e.documentId===this.primary)),(0,ut.p)((e=>e.isLocal)),(0,lt.T)((e=>vt(e))),(0,ht.Z)(e.docCache.getLatestDocumentData(this.primary)),(0,dt.F)(((e,t)=>e._rev===t._rev)),(0,lt.T)((t=>e.docCache.getCachedRxDocument(t))),(0,mt.t)(ce.bz))},get $$(){var e=this,t=Er(e);return t.getReactivityFactory().fromObservable(e.$,e.getLatest()._data,t)},get deleted$$(){var e=this,t=Er(e);return t.getReactivityFactory().fromObservable(e.deleted$,e.getLatest().deleted,t)},getLatest(){var e=a(Or,this.parent),t=e.docCache.getLatestDocumentData(this.primary);return e.docCache.getCachedRxDocument(t)},get(e){if(e="data."+e,this._data){if("string"!=typeof e)throw S("LD2",{objPath:e});var t=v(this._data,e);return t=D.deepFreezeWhenDevMode(t)}},get$(e){if(e="data."+e,D.isDevMode()){if(e.includes(".item."))throw I("LD3",{objPath:e});if(e===this.primaryPath)throw I("LD4")}return this.$.pipe((0,lt.T)((e=>e._data)),(0,lt.T)((t=>v(t,e))),(0,dt.F)())},get$$(e){var t=Er(this);return t.getReactivityFactory().fromObservable(this.get$(e),this.getLatest().get(e),t)},async incrementalModify(e){var t=await Nr(this.parent);return t.incrementalWriteQueue.addWrite(this._data,(async t=>(t.data=await e(t.data,this),t))).then((e=>t.docCache.getCachedRxDocument(e)))},incrementalPatch(e){return this.incrementalModify((t=>(Object.entries(e).forEach((e=>{let[r,n]=e;t[r]=n})),t)))},async _saveData(e){var t=await Nr(this.parent),r=this._data;return e.id=this.id,t.storageInstance.bulkWrite([{previous:r,document:e}],"local-document-save-data").then((t=>{var r=t.success[0];if(!r)throw t.error[0];(e=s(e))._rev=r._rev}))},async remove(){var e=await Nr(this.parent),t=s(this._data);return t._deleted=!0,Fe(e.storageInstance,{previous:this._data,document:t},"local-document-remove").then((t=>e.docCache.getCachedRxDocument(t)))}},Ir=!1,Sr=()=>{if(!Ir){Ir=!0;var e=bt;Object.getOwnPropertyNames(e).forEach((t=>{if(!Object.getOwnPropertyDescriptor(_r,t)){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(_r,t,r)}}));["populate","update","putAttachment","getAttachment","allAttachments"].forEach((e=>_r[e]=(e=>()=>{throw I("LD6",{functionName:e})})(e)))}};function Er(e){var t=e.parent;return t instanceof yr?t:t.database}var Rr=new WeakMap,Or=new WeakMap;function Cr(e){var t=e.database?e.database:e,r=e.database?e.name:"",n=(async()=>{var n=await Pr(t.token,t.storage,t.name,r,t.instanceCreationOptions,t.multiInstance);n=Ue(t,n,Br);var a=new Bt("id",e.$.pipe((0,ut.p)((e=>e.isLocal))),(t=>function(e,t){Sr();var r=new jr(e.id,e,t);return Object.setPrototypeOf(r,_r),r.prototype=_r,r}(t,e))),i=new gt(n,"id",(()=>{}),(()=>{})),s=await t.storageToken,o=n.changeStream().subscribe((r=>{for(var n=new Array(r.events.length),a=r.events,i=e.database?e.name:void 0,o=0;o<a.length;o++){var c=a[o];n[o]={documentId:c.documentId,collectionName:i,isLocal:!0,operation:c.operation,documentData:D.deepFreezeWhenDevMode(c.documentData),previousDocumentData:D.deepFreezeWhenDevMode(c.previousDocumentData)}}var l={id:r.id,internal:!1,collectionName:e.database?e.name:void 0,storageToken:s,events:n,databaseToken:t.token,checkpoint:r.checkpoint,context:r.context,endTime:r.endTime,startTime:r.startTime};t.$emit(l)}));e._subs.push(o);var c={database:t,parent:e,storageInstance:n,docCache:a,incrementalWriteQueue:i};return Or.set(e,c),c})();Rr.set(e,n)}function Nr(e){var t=Rr.get(e);if(!t){var r=e.database?e.database:e,n=e.database?e.name:"";throw I("LD8",{database:r.name,collection:n})}return t}function Pr(e,t,r,n,a,i){return t.createStorageInstance({databaseInstanceToken:e,databaseName:r,collectionName:Ar(n),schema:Br,options:a,multiInstance:i,devMode:D.isDevMode()})}function $r(e){var t=Rr.get(e);if(t)return Rr.delete(e),t.then((e=>e.storageInstance.close()))}async function Tr(e,t,r){var n=N(10),a=await Pr(n,e,t,r,{},!1);await a.remove()}function Ar(e){return"plugin-local-documents-"+e}var Br=W({title:"RxLocalDocument",version:0,primaryKey:"id",type:"object",properties:{id:{type:"string",maxLength:128},data:{type:"object",additionalProperties:!0}},required:["id","data"]});async function qr(e,t){var r=await Nr(this),n={id:e,data:t,_deleted:!1,_meta:A(),_rev:"",_attachments:{}};return Fe(r.storageInstance,{document:n},"local-document-insert").then((e=>r.docCache.getCachedRxDocument(e)))}function Mr(e,t){return this.getLocal(e).then((r=>r?r.incrementalModify((()=>t)):this.insertLocal(e,t)))}async function Wr(e){var t=await Nr(this),r=t.docCache,n=r.getLatestDocumentDataIfExists(e);return n?Promise.resolve(r.getCachedRxDocument(n)):Le(t.storageInstance,e).then((e=>e?t.docCache.getCachedRxDocument(e):null))}function Lr(e){return this.$.pipe((0,ht.Z)(null),(0,_t.Z)((async t=>t?{changeEvent:t}:{doc:await this.getLocal(e)})),(0,_t.Z)((async t=>{if(t.changeEvent){var r=t.changeEvent;return r.isLocal&&r.documentId===e?{use:!0,doc:await this.getLocal(e)}:{use:!1}}return{use:!0,doc:t.doc}})),(0,ut.p)((e=>e.use)),(0,lt.T)((e=>e.doc)))}var Fr={name:"local-documents",rxdb:!0,prototypes:{RxCollection:e=>{e.insertLocal=qr,e.upsertLocal=Mr,e.getLocal=Wr,e.getLocal$=Lr},RxDatabase:e=>{e.insertLocal=qr,e.upsertLocal=Mr,e.getLocal=Wr,e.getLocal$=Lr}},hooks:{createRxDatabase:{before:e=>{e.creator.localDocuments&&Cr(e.database)}},createRxCollection:{before:e=>{e.creator.localDocuments&&Cr(e.collection)}},preDestroyRxDatabase:{after:e=>$r(e)},postDestroyRxCollection:{after:e=>$r(e)},postRemoveRxDatabase:{after:e=>Tr(e.storage,e.databaseName,"")},postRemoveRxCollection:{after:e=>Tr(e.storage,e.databaseName,e.collectionName)}},overwritable:{}};let Hr;function Qr(){return"undefined"!=typeof window&&window.indexedDB}function zr(){return Hr||(Hr=(async()=>{!function(e){if(qe("preAddRxPlugin",{plugin:e,plugins:Dr}),!Dr.has(e)){if(kr.has(e.name))throw I("PL3",{name:e.name,plugin:e});if(Dr.add(e),kr.add(e.name),!e.rxdb)throw S("PL1",{plugin:e});e.init&&e.init(),e.prototypes&&Object.entries(e.prototypes).forEach((e=>{let[t,r]=e;return r(xr[t])})),e.overwritable&&Object.assign(D,e.overwritable),e.hooks&&Object.entries(e.hooks).forEach((e=>{let[t,r]=e;r.after&&Be[t].push(r.after),r.before&&Be[t].unshift(r.before)}))}}(Fr);var e;return await wr({name:"rxdb-landing-v3",localDocuments:!0,storage:(void 0===e&&(e={}),new it(e))})})()),Hr}const Kr=["#e6008d","#8d2089","#5f2688"]},6492:(e,t,r)=>{r.d(t,{d:()=>i});var n=r(4589),a=r(4848);function i(){const e=[{label:"myAgro, Africa",description:"Transitioning to RxDB was a breath of fresh air due to its comprehensive features, including schema migration, real-time replication, conflict resolution, and reactive programming.",href:"https://www.myagro.org/",target:"_blank",logo:"./files/companies/myagro.svg",logoStyle:"slider-logo-black lazyload"},{label:"MoreApp, Germany",description:"We provide a mobile app that is used by people in the\n            field to fill in valuable information like inspections,\n            surveys and audits.",href:"https://moreapp.com/",target:"_blank",logo:"./files/companies/moreapp.png",logoStyle:"slider-logo-black lazyload"},{label:"ALTGRAS, Africa",description:"We use RxDB to create applications capable of being\n            used in the most remote areas where Internet access is\n            really a challenge.",href:"https://altgras.com/",target:"_blank",logo:"./files/companies/altgras.png",logoStyle:"slider-logo-white lazyload"},{label:"WooCommerce POS, Australia",description:"We use RxDB to provide an offline first, cross platform\n            point of sale system. With RxDB we could create a web-, desktop- and mobile app using the same code base.",href:"https://wcpos.com/",target:"_blank",logo:"./files/companies/woopos.png",logoStyle:"slider-logo-black lazyload"},{label:"atroo GmbH, Germany",description:"RxDB is a main component in building offline-ready\n            multichannel apps. It has become our default stack for\n            this kind of apps.",href:"https://atroo.de/",target:"_blank",logo:"./files/companies/atroo.png",logoStyle:"slider-logo-black lazyload"},{label:"Nutrien, Canada",description:"With RxDB we have built an offline capable Progressive Web Application that is used by our borer operators to report on conditions at the mineface.",href:"https://www.nutrien.com/",target:"_blank",logo:"./files/companies/nutrien.svg",logoStyle:"slider-logo-black lazyload"}];return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(n.A,{dots:!0,centerMode:!0,centerPadding:"180px",infinite:!0,arrows:!1,adaptiveHeight:!0,speed:500,slidesToShow:3,slidesToScroll:1,initialSlide:0,responsive:[{breakpoint:1460,settings:{slidesToShow:2,slidesToScroll:1,infinite:!0,dots:!0,centerPadding:"180px"}},{breakpoint:1124,settings:{slidesToShow:2,slidesToScroll:1,infinite:!0,dots:!0,centerPadding:"100px"}},{breakpoint:900,settings:{slidesToShow:2,slidesToScroll:1,infinite:!0,dots:!0,centerPadding:"40px"}},{breakpoint:690,settings:{slidesToShow:1,slidesToScroll:1,infinite:!0,dots:!0,centerMode:!1,centerPadding:"0px"}},{breakpoint:480,settings:{slidesToShow:1,slidesToScroll:1,infinite:!1,dots:!0,swipeToSlide:!0,centerMode:!1,centerPadding:"0px"}}],children:e.map((e=>(0,a.jsxs)("div",{className:"slider-content",children:[(0,a.jsx)("img",{src:"./img/quote.svg",className:"review-img",alt:"quote"}),(0,a.jsx)("h3",{children:e.description}),(0,a.jsxs)("div",{className:"slider-profile",children:[(0,a.jsx)("img",{className:e.logoStyle,"data-src":e.logo,alt:"logo"}),(0,a.jsxs)("div",{className:"slider-info",children:[(0,a.jsx)("p",{className:"developer",children:e.label}),(0,a.jsx)("a",{href:e.href,target:e.target?"_blank":"_self",className:"company-link",children:e.href})]})]})]},e.label)))})})}},4324:(e,t,r)=>{r.r(t),r.d(t,{default:()=>m});var n=r(4586),a=r(2303),i=r(8478),s=r(1595),o=r(5260),c=(r(6879),r(6540)),l=r(2658),u=r(6492),h=r(4848);const d="consulting-link-clicked";function m(){const{siteConfig:e}=(0,n.A)(),t=(0,a.A)();(0,c.useEffect)((()=>{t&&(0,l.IA)()&&(async()=>{const e=await(0,l.C3)();await e.getLocal(d)?console.log("# already tracked "+d):(window.trigger(d,100),await e.upsertLocal(d,{}))})()}));const m=(0,c.useRef)(null);function x(){console.log("open"),m.current.show()}return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(o.A,{children:(0,h.jsx)("body",{className:"homepage"})}),(0,h.jsx)(s.A,{title:`${e.title}`,description:"RxDB is a fast, local-first NoSQL-database for JavaScript Applications like Websites, hybrid Apps, Electron-Apps, Progressive Web Apps and Node.js",children:(0,h.jsx)("main",{className:"consulting-page",children:(0,h.jsx)(i.A,{fallback:(0,h.jsx)("div",{children:"Loading..."}),children:()=>{const e=r(303).A,t=r(1431).A,n=r(8960).A,a=r(7784).A,i=r(3409).A,s=r(6571).A;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:"block first centered dark",children:(0,h.jsx)(p,{onOpenDialog:x,SlButton:t})}),(0,h.jsx)("div",{className:"block packages centered",id:"packages",children:(0,h.jsx)(f,{onOpenDialog:x,SlButton:t})}),(0,h.jsx)("div",{className:"block benefits centered",id:"benefits",children:(0,h.jsx)(v,{SlTabGroup:n,SlTab:a,SlTabPanel:i})}),(0,h.jsx)("div",{className:"block steps centered",id:"steps",children:(0,h.jsx)(g,{onOpenDialog:x,SlButton:t})}),(0,h.jsxs)("div",{className:"block review",id:"reviews",children:[(0,h.jsx)("div",{className:"content",children:(0,h.jsxs)("div",{className:"inner centered",children:[(0,h.jsx)("h2",{children:"Our success stories"}),(0,h.jsx)("h3",{children:"Hear what our clients have to say about their experiences working with RxDB. Get to know real-world examples of how we've helped businesses like yours achieve their goals and exceed expectations."})]})}),(0,h.jsx)(u.d,{})]}),(0,h.jsx)("div",{className:"block faq centered",id:"faq",children:(0,h.jsx)(y,{SlDetails:s})}),(0,h.jsx)("div",{className:"block next centered",id:"next",children:(0,h.jsx)(b,{onOpenDialog:x,SlButton:t})}),(0,h.jsx)("div",{className:"block contact centered",id:"contact",children:(0,h.jsx)(w,{})}),(0,h.jsx)(e,{noHeader:!0,ref:m,children:(0,h.jsxs)("iframe",{style:{width:"100%",height:"70vh",borderRadius:"32px"},id:"request-project-form",src:"https://webforms.pipedrive.com/f/6UUQvwSg3cy0wizvNdC3pmT378WEHYcwv6tdTlPNRl2HtVm0JjBbj5MQjqVj7ePW3F",children:["Your browser doesn't support iframes,"," ",(0,h.jsx)("a",{href:"https://webforms.pipedrive.com/f/6UUQvwSg3cy0wizvNdC3pmT378WEHYcwv6tdTlPNRl2HtVm0JjBbj5MQjqVj7ePW3F",target:"_blank",rel:"nofollow",children:"Click here"})]})})]})}})})})]})}function p(e){let{onOpenDialog:t,SlButton:r}=e;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{className:"content flex-row",children:[(0,h.jsxs)("div",{className:"half",children:[(0,h.jsx)("h1",{children:"Expert support for local database applications"}),(0,h.jsx)("h3",{children:"We offer custom solutions to streamline your data\n    management or revolutionize your project's backend.\n    Our team is here to guide you at every step."}),(0,h.jsxs)("div",{className:"flex-row hero-buttons",style:{alignItems:"center",gap:"16px",marginTop:"40px",marginBottom:"10px"},children:[(0,h.jsx)(r,{onClick:t,className:"sl-button",children:"Get started"}),(0,h.jsx)(r,{href:"/consulting#steps",className:"sl-button sl-button-empty",children:"See how it works"})]})]}),(0,h.jsx)("div",{className:"half",style:{paddingTop:"42px",paddingBottom:"42px"},children:(0,h.jsx)("img",{src:"./img/hero.svg",className:"hero-img",alt:"rxdb-image"})})]}),(0,h.jsxs)("div",{className:"hero-bottom-group",children:[(0,h.jsx)("img",{src:"./img/hero-group.svg",alt:"columns"}),(0,h.jsx)("img",{src:"./img/hero-group.svg",alt:"columns"})]}),(0,h.jsx)("div",{className:"hero-bottom-group-mobile",children:(0,h.jsx)("img",{src:"./img/hero-group-mobile.svg",alt:"columns"})})]})}function f(e){let{onOpenDialog:t,SlButton:r}=e;const n=[{index:"1",label:"Quick Consulting Session",price:"180\u20ac",description:"Schedule a quick consultancy session where the RxDB core maintainer answers all your questions and gives suggestions on how you should use RxDB or related technologies.",cta:"Schedule a call",href:"https://buy.stripe.com/14kdU1dN05SAfMA4gg",target:"_blank",rel:"",iframe:!1},{index:"2",label:"We build it for you",price:"",description:"Let our expert team handle the heavy lifting.\n            With Package 2, we take full responsibility for\n            building and implementing your local JavaScript\n            database solution. Sit back, relax, and watch as\n            we transform your vision into reality.",cta:"Get started",href:"https://webforms.pipedrive.com/f/6UUQvwSg3cy0wizvNdC3pmT378WEHYcwv6tdTlPNRl2HtVm0JjBbj5MQjqVj7ePW3F",target:"_blank",rel:"nofollow",iframe:!0},{index:"3",label:"We build it with you",price:"",description:"Prefer a more hands-on approach? Package 3 allows you to collaborate closely with our team throughout the development process. Together, we'll fine-tune every aspect of your solution to ensure it aligns perfectly with your goals and requirements.",cta:"Get started",href:"https://webforms.pipedrive.com/f/6UUQvwSg3cy0wizvNdC3pmT378WEHYcwv6tdTlPNRl2HtVm0JjBbj5MQjqVj7ePW3F",target:"_blank",rel:"nofollow",iframe:!0}];return(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"content centered",children:[(0,h.jsxs)("div",{className:"inner",children:[(0,h.jsx)("h2",{children:"Our Service Packages"}),(0,h.jsx)("h3",{children:"We offer tailored solutions to meet your needs. Whether\n    you're looking to streamline your data management\n    process or revolutionize your project's backend, our\n    team is here to guide you every step of the way."})]}),(0,h.jsx)("div",{className:"flex-row",style:{flexWrap:"wrap",alignItems:"stretch"},children:n.map(((e,n)=>(0,h.jsxs)("div",{className:n<1?"item-package flex-row":"item-package flex-column",style:{height:"auto",border:n<1?"solid 1px #E6008D":"none"},children:[(0,h.jsxs)("div",{className:"flex-column",style:{maxWidth:n<1?"70%":"unset"},children:[(0,h.jsxs)("h6",{children:["Package ",e.index]}),(0,h.jsxs)("div",{className:"flex-row",style:{alignItems:"center",gap:"16px"},children:[(0,h.jsx)("h4",{children:e.label}),e.price?(0,h.jsxs)("span",{className:"item-label",children:["Fixed ",e.price," fee"]}):null]}),(0,h.jsx)("p",{children:e.description})]}),(0,h.jsx)("div",{className:"flex-row",style:{alignItems:"center",gap:"8px",width:"auto"},children:(0,h.jsxs)(r,{variant:"text",href:e.iframe?"":e.href,target:e.target?"_blank":"_self",onClick:()=>e.iframe?t():null,children:[e.cta,(0,h.jsx)("svg",{width:"17",height:"17",viewBox:"0 0 17 17",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,h.jsx)("path",{d:"M9.25 16.0781L7.64063 14.4844L12.4609 9.66406H0.75V7.33594H12.4609L7.64063 2.52344L9.25 0.921875L16.8281 8.5L9.25 16.0781Z",fill:"#E6008D"})})]})})]},e.label+n)))})]})})}function v(e){let{SlTabGroup:t,SlTab:r,SlTabPanel:n}=e;const a=[{label:"Expert Guidance",text:"We have years of experience with local first\n            projects and can provide expert guidance. We\n            can provide an optimal concept for the best\n            solution for your specific use case.",name:"quidance"},{label:"Development support",text:"Either you have your own team of developers\n            or we can provide expert developers or we\n            can have a mix where we provide some of the\n            developers and the customer provides the\n            others.",name:"support"},{label:"Project review",text:"We can review your code and project and\n            ensure that it uses best practices and has\n            optimal performance. This can be done once\n            before your big release or as an ongoing\n            support.",name:"review"},{label:"Tailored features",text:"We can developer tailored features for RxDB\n            that are optimized for your specific use\n            case.",name:"feature"}];return(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"content centered",children:[(0,h.jsxs)("div",{className:"inner",children:[(0,h.jsx)("h2",{children:"How we help you"}),(0,h.jsx)("h3",{children:"Any type of support is possible: from full development to only helping support or code review. We can do Custom RxDB features."})]}),(0,h.jsxs)(t,{placement:"start",children:[(0,h.jsx)(r,{slot:"nav",panel:"quidance",children:"Expert Guidance"}),(0,h.jsx)(r,{slot:"nav",panel:"support",children:"Development support"}),(0,h.jsx)(r,{slot:"nav",panel:"review",children:"Project review"}),(0,h.jsx)(r,{slot:"nav",panel:"feature",children:"Tailored features"}),a.map((e=>(0,h.jsx)(n,{name:e.name,children:(0,h.jsxs)("div",{className:"panel",children:[(0,h.jsx)("img",{src:"./img/benefits-column.svg",className:"desktop-img",alt:"columns"}),(0,h.jsx)("div",{className:"mobile-img",children:(0,h.jsx)("img",{src:"./img/benefits-column-mobile.svg",alt:"columns"})}),(0,h.jsxs)("div",{className:"panel-content",children:[(0,h.jsx)("h3",{children:e.label}),(0,h.jsx)("h6",{children:e.text})]})]})},e.label)))]})]})})}function g(e){let{onOpenDialog:t,SlButton:r}=e;const n=[{label:"Initial contact",text:"We talk about your needs and give suggestions\n            for an optimal collaboration with us."},{label:"Specification Design",text:"We specify the collaboration between you and RxDB and define a roadmap."},{label:"Development",text:"Realization of the roadmap."},{label:"Ongoing support",text:"Regular project reviews and guidance when adding new features."}];return(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"content",children:[(0,h.jsxs)("div",{className:"inner",children:[(0,h.jsx)("h2",{children:"How it works"}),(0,h.jsx)("h3",{children:"Here you\u2019ll find an overview of the steps involved, offering insight into how we make the complex simple, from consultation to implementation."}),(0,h.jsx)(r,{className:"sl-button desktop-img",onClick:()=>t(),children:"Get started"})]}),(0,h.jsx)("div",{className:"steps-container",children:n.map(((e,t)=>(0,h.jsxs)("div",{className:"step-item",children:[(0,h.jsxs)("div",{className:"step-line",children:[(0,h.jsx)("span",{className:"step-number",children:t+1}),t<n.length-1?(0,h.jsx)("span",{className:"step-number-line"}):null]}),(0,h.jsxs)("div",{className:"step-content",children:[(0,h.jsx)("h5",{children:e.label}),(0,h.jsx)("p",{children:e.text})]})]},e.label)))}),(0,h.jsx)(r,{className:"sl-button mobile-button",onClick:()=>t(),children:"Get started"}),(0,h.jsx)("img",{className:"mobile-button",src:"./img/steps-column.svg",alt:"columns"})]})})}function y(e){let{SlDetails:t}=e;const r=[{label:"Which frameworks can you support ?",text:"Everything from react to Vue to Angular to Svelte. We know all frameworks and how to use them efficiently with RxDB."},{label:"Which platforms are supported?",text:"We can build web-apps for browsers, hybrid apps and\n            progressive web apps. Even server-side RxDB projects can\n            be realized."},{label:"How much does it cost?",text:"This depends on:\n            - How much of the work is provided by us\n            - Which type of development support do you need\n            - How much of the development will be done by yourside\n\n            We can offer in-house developers, near-shore and off-shore developers."},{label:"Do you provide 24/7 emergency support?",text:"No, sorry. This is not provided by default but we can figure out a way with you that fits your problems."}];return(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"content",children:[(0,h.jsxs)("div",{className:"inner",children:[(0,h.jsx)("h2",{children:"FAQs"}),(0,h.jsx)("h3",{children:"Have questions? We've got answers. Explore our FAQs to\n    learn more about our services, pricing, and approach to\n    local JavaScript database solutions."})]}),(0,h.jsx)("div",{className:"faq-container",children:r.map((e=>(0,h.jsxs)(t,{summary:e.label,children:[e.text,(0,h.jsx)("span",{slot:"expand-icon",children:(0,h.jsx)("svg",{width:"18",height:"11",viewBox:"0 0 18 11",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,h.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.52831 9.88389C9.23541 10.1768 8.76061 10.1768 8.46771 9.88389L0.82123 2.23739C0.52834 1.94449 0.52834 1.46969 0.82123 1.17679L1.17479 0.823191C1.46768 0.530291 1.94255 0.530291 2.23545 0.823191L8.99801 7.58579L15.7606 0.823191C16.0535 0.530291 16.5283 0.530291 16.8212 0.823191L17.1748 1.17679C17.4677 1.46969 17.4677 1.94449 17.1748 2.23739L9.52831 9.88389Z",fill:"#F6F6F7"})})}),(0,h.jsx)("span",{slot:"collapse-icon",style:{transform:"rotate(-90deg)"},children:(0,h.jsx)("svg",{width:"18",height:"10",viewBox:"0 0 18 10",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,h.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.47169 0.616109C8.76459 0.323209 9.23939 0.323209 9.53229 0.616109L17.1788 8.26261C17.4717 8.55551 17.4717 9.03031 17.1788 9.32321L16.8252 9.67681C16.5323 9.96971 16.0574 9.96971 15.7645 9.67681L9.00199 2.91421L2.23939 9.67681C1.94649 9.96971 1.47169 9.96971 1.17879 9.67681L0.82519 9.32321C0.53229 9.03031 0.53229 8.55551 0.82519 8.26261L8.47169 0.616109Z",fill:"#F6F6F7"})})})]},e.label)))})]})})}function b(e){let{onOpenDialog:t,SlButton:r}=e;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:"content",children:(0,h.jsxs)("div",{className:"inner centered",children:[(0,h.jsx)("h2",{children:"Ready to take the next step?"}),(0,h.jsx)("h3",{children:"Transform your project with RxDB. Schedule your\n    consultancy session today and discover the power of\n    local JavaScript database solutions."}),(0,h.jsx)(r,{className:"sl-button ",onClick:()=>t(),children:"Get started"})]})}),(0,h.jsx)("img",{src:"./img/next-column.svg",alt:"columns"})]})}function w(){return(0,h.jsx)(h.Fragment,{children:(0,h.jsx)("div",{className:"content",children:(0,h.jsxs)("div",{className:"iframe-form",children:[(0,h.jsxs)("div",{className:"inner centered",children:[(0,h.jsx)("h2",{children:"Still have questions?"}),(0,h.jsx)("h3",{children:"Get in touch with us today to schedule your\n    consultancy session or discuss your project\n    requirements. Fill out the form below, and a\n    member of our team will be in contact with\n    you shortly."})]}),(0,h.jsxs)("iframe",{style:{width:"100%",margin:"0 auto",maxWidth:"708px",borderRadius:"32px"},src:"https://webforms.pipedrive.com/f/6q8inTHyEUIvXxoWQGwymSc8VfEj3cUgikIf9IibvPWkJJYGI8gYEzXP89VJTwhdZx",children:["Your browser doesn't support iframes,"," ",(0,h.jsx)("a",{href:"https://webforms.pipedrive.com/f/6q8inTHyEUIvXxoWQGwymSc8VfEj3cUgikIf9IibvPWkJJYGI8gYEzXP89VJTwhdZx",target:"_blank",rel:"nofollow",children:"go here"})]})]})})})}},7810:(e,t,r)=>{function n(e){return e[e.length-1]}function a(e){return Array.isArray(e)?e.slice(0):[e]}function i(e){return Array.isArray(e)}function s(e){return null!=e}function o(e,t){var r=0,n=-1;for(var a of e){if(!t(a,n+=1))break;r+=1}return r}function c(e,t){for(var r=t.length,n=0;n<r;++n){var a=t[n];e.push(a)}}function l(e){return e.filter((function(e,t,r){return r.indexOf(e)===t}))}r.d(t,{$r:()=>a,Hb:()=>c,S7:()=>s,Sd:()=>o,dG:()=>n,jw:()=>l,k_:()=>i})},3337:(e,t,r)=>{function n(e,t){if(!e)throw t||(t=""),new Error("ensureNotFalsy() is falsy: "+t);return e}r.d(t,{ZN:()=>n,bz:()=>a});var a={bufferSize:1,refCount:!0}},1753:(e,t,r)=>{function n(){return new Promise((e=>setTimeout(e,0)))}function a(e){return void 0===e&&(e=0),new Promise((t=>setTimeout(t,e)))}r.d(t,{$A:()=>s,Dr:()=>i,ND:()=>a,Ve:()=>u,dY:()=>n,em:()=>o,h$:()=>h,vN:()=>c});Promise.resolve(!0);var i=Promise.resolve(!1),s=Promise.resolve(null),o=Promise.resolve();function c(e){return void 0===e&&(e=1e4),"function"==typeof requestIdleCallback?new Promise((t=>{requestIdleCallback((()=>t()),{timeout:e})})):a(0)}var l=o;function u(e){return void 0===e&&(e=void 0),l=l.then((()=>c(e)))}function h(e,t){return e.reduce(((e,t)=>e.then(t)),Promise.resolve(t))}},5734:(e,t,r)=>{r.d(t,{t:()=>a});var n=0;function a(){var e=Date.now();(e+=.01)<=n&&(e=n+.01);var t=parseFloat(e.toFixed(2));return n=t,t}}}]);