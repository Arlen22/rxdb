"use strict";(self.webpackChunkrxdb=self.webpackChunkrxdb||[]).push([[2160],{4183:(e,t,r)=>{r.d(t,{O9:()=>qr,N8:()=>Mr,dZ:()=>Ar});var a=r(4127);function n(e,t){var r=e.get(t);if(void 0===r)throw new Error("missing value from map "+t);return r}function i(e,t,r,a){var n=e.get(t);return void 0===n?(n=r(),e.set(t,n)):a&&a(n),n}function s(e){return Object.assign({},e)}function o(e,t){if(void 0===t&&(t=!1),!e)return e;if(!t&&Array.isArray(e))return e.sort(((e,t)=>"string"==typeof e&&"string"==typeof t?e.localeCompare(t):"object"==typeof e?1:-1)).map((e=>o(e,t)));if("object"==typeof e&&!Array.isArray(e)){var r={};return Object.keys(e).sort(((e,t)=>e.localeCompare(t))).forEach((a=>{r[a]=o(e[a],t)})),r}return e}var c=function e(t){if(!t)return t;if(null===t||"object"!=typeof t)return t;if(Array.isArray(t)){for(var r=new Array(t.length),a=r.length;a--;)r[a]=e(t[a]);return r}var n={};for(var i in t)n[i]=e(t[i]);return n};function l(e,t,r){return Object.defineProperty(e,t,{get:function(){return r}}),r}var u=r(6087),d=r(75),h=r(3219),m=r(8953),p={isDevMode:()=>!1,deepFreezeWhenDevMode:e=>e,tunnelErrorMessage:e=>"RxDB Error-Code "+e+".\n        Error messages are not included in RxDB core to reduce build size.\n        - To find out what this error means, either use the dev-mode-plugin https://rxdb.info/dev-mode.html\n        - or search for the error code here: https://github.com/pubkey/rxdb/search?q="+e+"\n        "};function f(e,t,r){return"RxError ("+t+"):\n"+e+"\n"+function(e){var t="";return 0===Object.keys(e).length?t:(t+="Given parameters: {\n",t+=Object.keys(e).map((t=>{var r="[object Object]";try{r="errors"===t?e[t].map((e=>JSON.stringify(e,Object.getOwnPropertyNames(e)))):JSON.stringify(e[t],(function(e,t){return void 0===t?null:t}),2)}catch(a){}return t+":"+r})).join("\n"),t+="}")}(r)}var y=function(e){function t(t,r,a){var n;void 0===a&&(a={});var i=f(r,t,a);return(n=e.call(this,i)||this).code=t,n.message=i,n.parameters=a,n.rxdb=!0,n}return(0,h.Z)(t,e),t.prototype.toString=function(){return this.message},(0,d.Z)(t,[{key:"name",get:function(){return"RxError ("+this.code+")"}},{key:"typeError",get:function(){return!1}}]),t}((0,m.Z)(Error)),v=function(e){function t(t,r,a){var n;void 0===a&&(a={});var i=f(r,t,a);return(n=e.call(this,i)||this).code=t,n.message=i,n.parameters=a,n.rxdb=!0,n}return(0,h.Z)(t,e),t.prototype.toString=function(){return this.message},(0,d.Z)(t,[{key:"name",get:function(){return"RxTypeError ("+this.code+")"}},{key:"typeError",get:function(){return!0}}]),t}((0,m.Z)(TypeError));function g(e,t){return new y(e,p.tunnelErrorMessage(e),t)}function b(e,t){return new v(e,p.tunnelErrorMessage(e),t)}function x(e){return!(!e||409!==e.status)&&e}var w={409:"document write conflict",422:"schema validation error",510:"attachment data missing"};var k=/\./g,j="abcdefghijklmnopqrstuvwxyz";function D(e){void 0===e&&(e=10);for(var t="",r=0;r<e;r++)t+=j.charAt(Math.floor(Math.random()*j.length));return t}function _(e){return(e+="").charAt(0).toUpperCase()+e.substr(1)}function I(e){for(;"."===e.charAt(0);)e=e.substr(1);for(;"."===e.slice(-1);)e=e.slice(0,-1);return e}var P=e=>{var t=typeof e;return null!==e&&("object"===t||"function"===t)},R=new Set(["__proto__","prototype","constructor"]),S=new Set("0123456789");function E(e){var t=[],r="",a="start",n=!1;for(var i of e)switch(i){case"\\":if("index"===a)throw new Error("Invalid character in an index");if("indexEnd"===a)throw new Error("Invalid character after an index");n&&(r+=i),a="property",n=!n;break;case".":if("index"===a)throw new Error("Invalid character in an index");if("indexEnd"===a){a="property";break}if(n){n=!1,r+=i;break}if(R.has(r))return[];t.push(r),r="",a="property";break;case"[":if("index"===a)throw new Error("Invalid character in an index");if("indexEnd"===a){a="index";break}if(n){n=!1,r+=i;break}if("property"===a){if(R.has(r))return[];t.push(r),r=""}a="index";break;case"]":if("index"===a){t.push(Number.parseInt(r,10)),r="",a="indexEnd";break}if("indexEnd"===a)throw new Error("Invalid character after an index");default:if("index"===a&&!S.has(i))throw new Error("Invalid character in an index");if("indexEnd"===a)throw new Error("Invalid character after an index");"start"===a&&(a="property"),n&&(n=!1,r+="\\"),r+=i}switch(n&&(r+="\\"),a){case"property":if(R.has(r))return[];t.push(r);break;case"index":throw new Error("Index was not closed");case"start":t.push("")}return t}function C(e,t){if("number"!=typeof t&&Array.isArray(e)){var r=Number.parseInt(t,10);return Number.isInteger(r)&&e[r]===e[t]}return!1}function O(e,t,r){if(Array.isArray(t)&&(t=t.join(".")),!t.includes(".")&&!t.includes("["))return e[t];if(!P(e)||"string"!=typeof t)return void 0===r?e:r;var a=E(t);if(0===a.length)return r;for(var n=0;n<a.length;n++){var i=a[n];if(null==(e=C(e,i)?n===a.length-1?void 0:null:e[i])){if(n!==a.length-1)return r;break}}return void 0===e?r:e}var N=1;function B(){return{lwt:N}}function A(e,t){var r=t;return O(e,r=I(r="properties."+(r=r.replace(k,".properties."))))}function M(e,t,r){if("string"==typeof t.primaryKey)return r;var a=T(t,r),n=r[e];if(n&&n!==a)throw g("DOC19",{args:{documentData:r,existingPrimary:n,newPrimary:a},schema:t});return r[e]=a,r}function q(e){return"string"==typeof e?e:e.key}function T(e,t){if("string"==typeof e.primaryKey)return t[e.primaryKey];var r=e.primaryKey;return r.fields.map((e=>{var r=O(t,e);if(void 0===r)throw g("DOC18",{args:{field:e,documentData:t}});return r})).join(r.separator)}function $(e){var t=q((e=s(e)).primaryKey);e.properties=s(e.properties),e.additionalProperties=!1,e.hasOwnProperty("keyCompression")||(e.keyCompression=!1),e.indexes=e.indexes?e.indexes.slice(0):[],e.required=e.required?e.required.slice(0):[],e.encrypted=e.encrypted?e.encrypted.slice(0):[],e.properties._rev={type:"string",minLength:1},e.properties._attachments={type:"object"},e.properties._deleted={type:"boolean"},e.properties._meta=L,e.required=e.required?e.required.slice(0):[],e.required.push("_deleted"),e.required.push("_rev"),e.required.push("_meta"),e.required.push("_attachments");var r=W(e);return(0,u.gu)(e.required,r),e.required=e.required.filter((e=>!e.includes("."))).filter(((e,t,r)=>r.indexOf(e)===t)),e.version=e.version||0,e.indexes&&(e.indexes=e.indexes.map((e=>{var r=(0,u.AD)(e)?e.slice(0):[e];if(!r.includes(t)){var a=r.slice(0);return a.push(t),a}return r}))),e}var L={type:"object",properties:{lwt:{type:"number",minimum:N,maximum:1e15,multipleOf:.01}},additionalProperties:!0,required:["lwt"]};function W(e){var t=Object.keys(e.properties).filter((t=>e.properties[t].final)),r=q(e.primaryKey);return t.push(r),"string"!=typeof e.primaryKey&&e.primaryKey.fields.forEach((e=>t.push(e))),t}var F=String.fromCharCode(65535),Q=Number.MIN_VALUE;function z(e,t){var r=q(e.primaryKey),a=t.selector,n=e.indexes?e.indexes.slice(0):[];t.index?n=[t.index]:n.push([r]);var i,s=t.sort.map((e=>Object.keys(e)[0])).join(","),o=!!t.sort.find((e=>"desc"===Object.values(e)[0])),c=-1;return n.forEach((e=>{var r=!0,n=!0,l=e.map((e=>{var t=a[e],i=t?Object.keys(t):[],s={};t&&i.length?i.forEach((e=>{if(H.has(e)){var r=function(e,t){switch(e){case"$eq":return{startKey:t,endKey:t};case"$lte":return{endKey:t};case"$gte":return{startKey:t};case"$lt":return{endKey:t,inclusiveEnd:!1};case"$gt":return{startKey:t,inclusiveStart:!1};default:throw new Error("SNH")}}(e,t[e]);s=Object.assign(s,r)}})):s={startKey:n?Q:F,endKey:r?F:Q,inclusiveStart:!0,inclusiveEnd:!0};return void 0===s.startKey&&(s.startKey=Q),void 0===s.endKey&&(s.endKey=F),void 0===s.inclusiveStart&&(s.inclusiveStart=!0),void 0===s.inclusiveEnd&&(s.inclusiveEnd=!0),n&&!s.inclusiveStart&&(n=!1),r&&!s.inclusiveEnd&&(r=!1),s})),d={index:e,startKeys:l.map((e=>e.startKey)),endKeys:l.map((e=>e.endKey)),inclusiveEnd:r,inclusiveStart:n,sortFieldsSameAsIndexFields:!o&&s===e.join(","),selectorSatisfiedByIndex:Z(e,t.selector)},h=function(e,t,r){var a=0,n=e=>{e>0&&(a+=e)},i=10,s=(0,u.r0)(r.startKeys,(e=>e!==Q&&e!==F));n(s*i);var o=(0,u.r0)(r.startKeys,(e=>e!==F&&e!==Q));n(o*i);var c=(0,u.r0)(r.startKeys,((e,t)=>e===r.endKeys[t]));n(c*i*1.5);var l=r.sortFieldsSameAsIndexFields?5:0;return n(l),a}(0,0,d);(h>0&&h>c||t.index)&&(c=h,i=d)})),i||(i={index:[r],startKeys:[Q],endKeys:[F],inclusiveEnd:!0,inclusiveStart:!0,sortFieldsSameAsIndexFields:!o&&s===r,selectorSatisfiedByIndex:Z([r],t.selector)}),i}var H=new Set(["$eq","$gt","$gte","$lt","$lte"]),K=new Set(["$eq","$gt","$gte"]),U=new Set(["$eq","$lt","$lte"]);function Z(e,t){var r,a;return!Object.entries(t).find((t=>{let[r,a]=t;return!e.includes(r)||Object.entries(a).find((e=>{let[t,r]=e;return!H.has(t)}))}))&&(!e.find((e=>{var a=t[e];if(!a)return!1;var n=Object.keys(a).find((e=>K.has(e)));return!(!r||!n)||("$eq"!==n&&(r=n),!1)}))&&!e.find((e=>{var r=t[e];if(!r)return!1;var n=Object.keys(r).find((e=>U.has(e)));return!(!a||!n)||("$eq"!==n&&(a=n),!1)})))}var V="docs",Y="deleted-docs",G="changes",J="dexie",X={prepareQuery(e,t){if(!t.sort)throw g("SNH",{query:t});return{query:t,queryPlan:z(e,t)}},checkpointSchema:{type:"object",properties:{id:{type:"string"},lwt:{type:"number"}},required:["id","lwt"],additionalProperties:!1}},ee=new Map,te=new Map;var re="__";function ae(e){var t=e.split(".");if(t.length>1)return t.map((e=>ae(e))).join(".");if(e.startsWith("|")){var r=e.substring(1);return re+r}return e}function ne(e){var t=e.split(".");return t.length>1?t.map((e=>ne(e))).join("."):e.startsWith(re)?"|"+e.substring(re.length):e}function ie(e){if(!e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e)return e;if(Array.isArray(e))return e.map((e=>ie(e)));if("object"==typeof e){var t={};return Object.entries(e).forEach((e=>{let[r,a]=e;"object"==typeof a&&(a=ie(a)),t[ae(r)]=a})),t}}function se(e){if(!e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e)return e;if(Array.isArray(e))return e.map((e=>se(e)));if("object"==typeof e){var t={};return Object.entries(e).forEach((r=>{let[a,n]=r;("object"==typeof n||Array.isArray(e))&&(n=se(n)),t[ne(a)]=n})),t}}function oe(e){var t=[],r=q(e.primaryKey);return t.push([r]),e.indexes&&e.indexes.forEach((e=>{var r=(0,u.qo)(e);t.push(r)})),t.push(["_meta.lwt",r]),(t=t.map((e=>e.map((e=>ae(e)))))).map((e=>1===e.length?e[0]:"["+e.join("+")+"]")).join(", ")}async function ce(e,t){var r=await e,[a,n]=await Promise.all([r.dexieTable.bulkGet(t),r.dexieDeletedTable.bulkGet(t)]),i=n.slice(0);return a.forEach(((e,t)=>{e&&(i[t]=e)})),i}var le=r(6974),ue=r(984),de=r(4419),he=r(7400),me=r(6250),pe=r(7761),fe=r(7132),ye=r(6496),ve=r(6851),ge=r(3516),be=r(8039),xe=r(5308),we=r(2106),ke=!1;function je(e){return ke||((0,pe.Qs)(pe.$M.PIPELINE,{$sort:ye.E3,$project:ye.FM}),(0,pe.Qs)(pe.$M.QUERY,{$and:ve.h$,$eq:ge.l3,$elemMatch:xe.rr,$exists:we.G,$gt:ge.ok,$gte:ge.m9,$in:ge.FI,$lt:ge.Ty,$lte:ge.HG,$ne:ge.ny,$nin:ge.IS,$mod:be.JD,$nor:ve.ps,$not:ve._w,$or:ve.Ko,$regex:be.GO,$size:xe.QH,$type:we.e}),ke=!0),new fe.A(e)}function De(e,t){var r=q(e.primaryKey);t=s(t);var a=c(t);if("number"!=typeof a.skip&&(a.skip=0),a.selector?(a.selector=a.selector,Object.entries(a.selector).forEach((e=>{let[t,r]=e;"object"==typeof r&&null!==r||(a.selector[t]={$eq:r})}))):a.selector={},a.index){var n=(0,u.qo)(a.index);n.includes(r)||n.push(r),a.index=n}if(a.sort)a.sort.find((e=>{return t=e,Object.keys(t)[0]===r;var t}))||(a.sort=a.sort.slice(0),a.sort.push({[r]:"asc"}));else if(a.index)a.sort=a.index.map((e=>({[e]:"asc"})));else{if(e.indexes){var i=new Set;Object.entries(a.selector).forEach((e=>{let[t,r]=e;("object"!=typeof r||null===r||!!Object.keys(r).find((e=>H.has(e))))&&i.add(t)}));var o,l=-1;e.indexes.forEach((e=>{var t=(0,u.AD)(e)?e:[e],r=t.findIndex((e=>!i.has(e)));r>0&&r>l&&(l=r,o=t)})),o&&(a.sort=o.map((e=>({[e]:"asc"}))))}a.sort||(a.sort=[{[r]:"asc"}])}return a}function _e(e,t){if(!t.sort)throw g("SNH",{query:t});var r=[];t.sort.forEach((e=>{var t,a,n,i=Object.keys(e)[0],s=Object.values(e)[0];r.push({key:i,direction:s,getValueFn:(t=i,a=t.split("."),n=a.length,1===n?e=>e[t]:e=>{for(var t=e,r=0;r<n;++r)if(void 0===(t=t[a[r]]))return t;return t})})}));return(e,t)=>{for(var a=0;a<r.length;++a){var n=r[a],i=n.getValueFn(e),s=n.getValueFn(t);if(i!==s)return"asc"===n.direction?(0,me.qu)(i,s):(0,me.qu)(s,i)}}}function Ie(e,t){if(!t.sort)throw g("SNH",{query:t});var r=je(t.selector);return e=>!e._deleted&&r.test(e)}function Pe(e){return e===Q?-1/0:e}function Re(e,t){if(!t){if("undefined"==typeof window)throw new Error("IDBKeyRange missing");t=window.IDBKeyRange}var r,a=e.startKeys.map(Pe),n=e.endKeys.map(Pe);if(1===e.index.length){var i=a[0]===n[0];r=t.bound(a[0],n[0],!i&&!e.inclusiveStart,!i&&!e.inclusiveEnd)}else r=t.bound(a,n,!e.inclusiveStart,!e.inclusiveEnd);return r}async function Se(e,t){var r=await e.internals,a=t.query,n=a.skip?a.skip:0,i=n+(a.limit?a.limit:1/0),s=t.queryPlan,o=!1;s.selectorSatisfiedByIndex||(o=Ie(e.schema,t.query));var c=Re(s,r.dexieDb._options.IDBKeyRange),l=s.index,u=[];if(await r.dexieDb.transaction("r",r.dexieTable,(async t=>{var r,a,n=t.idbtrans.objectStore(V);1===l.length&&l[0]===e.primaryPath?r=n:(a=1===l.length?ae(l[0]):"["+l.map((e=>ae(e))).join("+")+"]",r=n.index(a));var d=r.openCursor(c);await new Promise((e=>{d.onsuccess=function(t){var r=t.target.result;if(r){var a=se(r.value);a._deleted||o&&!o(a)||u.push(a),s.sortFieldsSameAsIndexFields&&u.length===i?e():r.continue()}else e()}}))})),!s.sortFieldsSameAsIndexFields){var d=_e(e.schema,t.query);u=u.sort(d)}return{documents:u=u.slice(n,i)}}function Ee(e){var t=e.split("-");if(2!==t.length)throw new Error("malformatted revision: "+e);return{height:parseInt(t[0],10),hash:t[1]}}function Ce(e){return parseInt(e.split("-")[0],10)}function Oe(e,t){var r=t?t._rev:null;return(r?Ee(r).height:0)+1+"-"+e}var Ne="_rxdb_internal";async function Be(e,t){var r=(await e.findDocumentsById([t],!1))[0];return r||void 0}async function Ae(e,t,r){var a=await e.bulkWrite([t],r);if(a.error.length>0)throw a.error[0];return a.success[0]}function Me(e,t,r){var a=t.documentData,n=t.previousDocumentData;return{documentId:t.documentId,collectionName:r?r.name:void 0,isLocal:e,operation:t.operation,documentData:p.deepFreezeWhenDevMode(a),previousDocumentData:p.deepFreezeWhenDevMode(n)}}function qe(e,t,r,a){if(a)throw 409===a.status?g("CONFLICT",{collection:e.name,id:t,writeError:a,data:r}):422===a.status?g("VD2",{collection:e.name,id:t,writeError:a,data:r}):a}function Te(e){return{previous:e.previous,document:$e(e.document)}}function $e(e){if(!e._attachments||0===Object.keys(e._attachments).length)return e;var t=s(e);return t._attachments={},Object.entries(e._attachments).forEach((e=>{let[r,a]=e;var n,i,s;t._attachments[r]=(s=(n=a).data)?{length:(i=s,atob(i).length),digest:n.digest,type:n.type}:n})),t}function Le(e){var t=s(e);return t._meta=s(e._meta),t}function We(e,t,r){p.deepFreezeWhenDevMode(r);var a=q(r.primaryKey);var n={originalStorageInstance:t,schema:t.schema,internals:t.internals,collectionName:t.collectionName,databaseName:t.databaseName,options:t.options,bulkWrite(n,i){var o=n.map((n=>function(n){var i=s(n.document);if(i._meta=s(i._meta),p.isDevMode()){i=M(a,r,i);try{structuredClone(n)}catch(o){throw g("DOC24",{collection:t.collectionName,document:n.document})}n.previous,n.previous&&Object.keys(n.previous._meta).forEach((e=>{if(!n.document._meta.hasOwnProperty(e))throw g("SNH",{dataBefore:n.previous,dataAfter:n.document})}))}return i._meta.lwt=(0,ue.z)(),i._rev=Oe(e.token,n.previous),{document:i,previous:n.previous}}(n)));return e.lockedRun((()=>t.bulkWrite(o,i))).then((r=>{var a={error:[],success:r.success.slice(0)},n=r.error.filter((e=>!(409!==e.status||e.writeRow.previous||e.writeRow.document._deleted||!(0,he.Is)(e.documentInDb)._deleted)||(a.error.push(e),!1)));if(n.length>0){var s=n.map((t=>({previous:t.documentInDb,document:Object.assign({},t.writeRow.document,{_rev:Oe(e.token,t.documentInDb)})})));return e.lockedRun((()=>t.bulkWrite(s,i))).then((e=>((0,u.gu)(a.error,e.error),(0,u.gu)(a.success,e.success),a)))}return r}))},query:r=>e.lockedRun((()=>t.query(r))),count:r=>e.lockedRun((()=>t.count(r))),info:()=>e.lockedRun((()=>t.info())),findDocumentsById:(r,a)=>e.lockedRun((()=>t.findDocumentsById(r,a))),getAttachmentData:(r,a,n)=>e.lockedRun((()=>t.getAttachmentData(r,a,n))),getChangedDocumentsSince:(r,a)=>e.lockedRun((()=>t.getChangedDocumentsSince((0,he.Is)(r),a))),cleanup:r=>e.lockedRun((()=>t.cleanup(r))),remove:()=>(e.storageInstances.delete(n),e.lockedRun((()=>t.remove()))),close:()=>(e.storageInstances.delete(n),e.lockedRun((()=>t.close()))),changeStream:()=>t.changeStream(),conflictResultionTasks:()=>t.conflictResultionTasks(),resolveConflictResultionTask(e){if(e.output.isEqual)return t.resolveConflictResultionTask(e);var r=s(Object.assign({},e.output.documentData,{_meta:B(),_rev:"",_attachments:{}}));return delete r._meta,delete r._rev,delete r._attachments,t.resolveConflictResultionTask({id:e.id,output:{isEqual:!1,documentData:r}})}};return e.storageInstances.add(n),n}var Fe=r(5677),Qe=r(3981),ze=new Map;function He(e,t){var r=ze.get(e);if(r)return r.refs.delete(t),0===r.refs.size?(ze.delete(e),r.bc.close()):void 0}function Ke(e,t,r,a){if(t.multiInstance){var n=a||function(e,t,r,a){var n=ze.get(t);return n||(n={bc:new Qe.g0(["RxDB:",e,r].join("|")),refs:new Set},ze.set(t,n)),n.refs.add(a),n.bc}(e,t.databaseInstanceToken,r.databaseName,r),i=new le.x,s=r=>{r.storageName===e&&r.databaseName===t.databaseName&&r.collectionName===t.collectionName&&r.version===t.schema.version&&i.next(r.eventBulk)};n.addEventListener("message",s);var o=r.changeStream(),c=!1,l=o.subscribe((r=>{c||n.postMessage({storageName:e,databaseName:t.databaseName,collectionName:t.collectionName,version:t.schema.version,eventBulk:r})}));r.changeStream=function(){return i.asObservable().pipe((0,Fe.b)(o))};var u=r.close.bind(r);r.close=async function(){return c=!0,l.unsubscribe(),n.removeEventListener("message",s),a||await He(t.databaseInstanceToken,r),u()};var d=r.remove.bind(r);r.remove=async function(){return c=!0,l.unsubscribe(),n.removeEventListener("message",s),a||await He(t.databaseInstanceToken,r),d()}}}var Ue=(0,ue.z)(),Ze=function(){function e(e,t,r,a,n,i,s){this.changes$=new le.x,this.instanceId=Ue++,this.storage=e,this.databaseName=t,this.collectionName=r,this.schema=a,this.internals=n,this.options=i,this.settings=s,this.primaryPath=q(this.schema.primaryKey)}var t=e.prototype;return t.bulkWrite=async function(e,t){Ye(this),e.forEach((e=>{if(!e.document._rev||e.previous&&!e.previous._rev)throw g("SNH",{args:{row:e}})}));var r,a=await this.internals,n={success:[],error:[]},i=e.map((e=>e.document[this.primaryPath]));if(await a.dexieDb.transaction("rw",a.dexieTable,a.dexieDeletedTable,(async()=>{var s=new Map;(await ce(this.internals,i)).forEach((e=>{var t=e?se(e):e;return t&&s.set(t[this.primaryPath],t),t})),r=function(e,t,r,a,n,i,s){for(var o,c=!!e.schema.attachments,l=[],u=[],d=[],h={id:D(10),events:[],checkpoint:null,context:n,startTime:(0,ue.z)(),endTime:0},m=h.events,p=[],f=[],y=[],v=r.size>0,b=a.length,x=function(){var e,n=a[w],h=n.document,b=n.previous,x=h[t],k=h._deleted,j=b&&b._deleted,D=void 0;if(v&&(D=r.get(x)),D){var _=D._rev;if(!b||b&&_!==b._rev){var I={isError:!0,status:409,documentId:x,writeRow:n,documentInDb:D};return d.push(I),1}var P=c?Te(n):n;c&&(k?b&&Object.keys(b._attachments).forEach((e=>{f.push({documentId:x,attachmentId:e,digest:(0,he.Is)(b)._attachments[e].digest})})):(Object.entries(h._attachments).find((t=>{let[r,a]=t;return(b?b._attachments[r]:void 0)||a.data||(e={documentId:x,documentInDb:D,isError:!0,status:510,writeRow:n,attachmentId:r}),!0})),e||Object.entries(h._attachments).forEach((e=>{let[t,r]=e;var a=b?b._attachments[t]:void 0;if(a){var n=P.document._attachments[t].digest;r.data&&a.digest!==n&&y.push({documentId:x,attachmentId:t,attachmentData:r,digest:r.digest})}else p.push({documentId:x,attachmentId:t,attachmentData:r,digest:r.digest})})))),e?d.push(e):(c?(u.push(Te(P)),s&&s(h)):(u.push(P),s&&s(h)),o=P);var R=null,S=null,E=null;if(j&&!k)E="INSERT",R=c?$e(h):h;else if(!b||j||k){if(!k)throw g("SNH",{args:{writeRow:n}});E="DELETE",R=(0,he.Is)(h),S=b}else E="UPDATE",R=c?$e(h):h,S=b;var C={documentId:x,documentData:R,previousDocumentData:S,operation:E};m.push(C)}else{var O=!!k;if(c&&Object.entries(h._attachments).forEach((t=>{let[r,a]=t;a.data?p.push({documentId:x,attachmentId:r,attachmentData:a,digest:a.digest}):(e={documentId:x,isError:!0,status:510,writeRow:n,attachmentId:r},d.push(e))})),e||(c?(l.push(Te(n)),i&&i(h)):(l.push(n),i&&i(h)),o=n),!O){var N={documentId:x,operation:"INSERT",documentData:c?$e(h):h,previousDocumentData:c&&b?$e(b):b};m.push(N)}}},w=0;w<b;w++)x();return{bulkInsertDocs:l,bulkUpdateDocs:u,newestRow:o,errors:d,eventBulk:h,attachmentsAdd:p,attachmentsRemove:f,attachmentsUpdate:y}}(this,this.primaryPath,s,e,t),n.error=r.errors;var o=[],c=[],l=[],u=[];r.bulkInsertDocs.forEach((e=>{n.success.push(e.document),o.push(e.document)})),r.bulkUpdateDocs.forEach((e=>{var t=e.document[this.primaryPath];if(n.success.push(e.document),e.document._deleted&&e.previous&&!e.previous._deleted)c.push(t),l.push(e.document);else if(e.document._deleted&&e.previous&&e.previous._deleted)l.push(e.document);else{if(e.document._deleted)throw g("SNH",{args:{row:e}});o.push(e.document)}})),await Promise.all([o.length>0?a.dexieTable.bulkPut(o.map((e=>ie(e)))):de.$Y,c.length>0?a.dexieTable.bulkDelete(c):de.$Y,l.length>0?a.dexieDeletedTable.bulkPut(l.map((e=>ie(e)))):de.$Y,u.length>0?a.dexieDeletedTable.bulkDelete(u):de.$Y])})),(r=(0,he.Is)(r)).eventBulk.events.length>0){var s=(0,he.Is)(r.newestRow).document;r.eventBulk.checkpoint={id:s[this.primaryPath],lwt:s._meta.lwt},r.eventBulk.endTime=(0,ue.z)(),this.changes$.next(r.eventBulk)}return n},t.findDocumentsById=async function(e,t){Ye(this);var r=await this.internals,a=[];return await r.dexieDb.transaction("r",r.dexieTable,r.dexieDeletedTable,(async()=>{var n;n=t?await ce(this.internals,e):await r.dexieTable.bulkGet(e),e.forEach(((e,r)=>{var i=n[r];!i||i._deleted&&!t||a.push(se(i))}))})),a},t.query=function(e){return Ye(this),Se(this,e)},t.count=async function(e){if(e.queryPlan.selectorSatisfiedByIndex){var t=await async function(e,t){var r=await e.internals,a=t.queryPlan,n=a.index,i=Re(a,r.dexieDb._options.IDBKeyRange),s=-1;return await r.dexieDb.transaction("r",r.dexieTable,(async t=>{var r,a,o=t.idbtrans.objectStore(V);1===n.length&&n[0]===e.primaryPath?r=o:(a=1===n.length?ae(n[0]):"["+n.map((e=>ae(e))).join("+")+"]",r=o.index(a));var c=r.count(i);s=await new Promise(((e,t)=>{c.onsuccess=function(){e(c.result)},c.onerror=e=>t(e)}))})),s}(this,e);return{count:t,mode:"fast"}}return{count:(await Se(this,e)).documents.length,mode:"slow"}},t.info=async function(){var e=await this.internals,t={totalCount:-1};return await e.dexieDb.transaction("r",e.dexieTable,e.dexieDeletedTable,(async r=>{var[a,n]=await Promise.all([e.dexieTable.count(),e.dexieDeletedTable.count()]);t.totalCount=a+n})),t},t.getChangedDocumentsSince=async function(e,t){Ye(this);var r,a=t?t.lwt:N,n=t?t.id:"",i=await this.internals,[s,o]=await Promise.all([i.dexieTable,i.dexieDeletedTable].map((async t=>{var r=t.where("[_meta.lwt+"+this.primaryPath+"]").above([a,n]).limit(e);return(await r.toArray()).map((e=>se(e)))}))),c=s.slice(0);(0,u.gu)(c,o),r=this.primaryPath,c=c.sort(function(e){return(t,r)=>t._meta.lwt===r._meta.lwt?r[e]<t[e]?1:-1:t._meta.lwt-r._meta.lwt}(r)),c=c.slice(0,e);var l=(0,u.SI)(c);return{documents:c,checkpoint:l?{id:l[this.primaryPath],lwt:l._meta.lwt}:t||{id:"",lwt:0}}},t.changeStream=function(){return Ye(this),this.changes$.asObservable()},t.cleanup=async function(e){Ye(this);var t=await this.internals;return await t.dexieDb.transaction("rw",t.dexieDeletedTable,(async()=>{var r=(0,ue.z)()-e,a=(await t.dexieDeletedTable.where("_meta.lwt").below(r).toArray()).map((e=>e[this.primaryPath]));await t.dexieDeletedTable.bulkDelete(a)})),!0},t.getAttachmentData=function(e,t,r){throw Ye(this),new Error("Attachments are not implemented in the dexie RxStorage. Make a pull request.")},t.remove=async function(){Ye(this);var e=await this.internals;return await Promise.all([e.dexieDeletedTable.clear(),e.dexieTable.clear()]),this.close()},t.close=function(){return this.closed||(this.closed=(async()=>{this.changes$.complete(),await async function(e){var t=await e,r=te.get(e)-1;0===r?(t.dexieDb.close(),te.delete(e)):te.set(e,r)}(this.internals)})()),this.closed},t.conflictResultionTasks=function(){return new le.x},t.resolveConflictResultionTask=async function(e){},e}();function Ve(e,t,r){var n=function(e,t,r,n){var o=q(n.primaryKey),c="rxdb-dexie-"+e+"--"+n.version+"--"+t,l=i(ee,c,(()=>{var e=(async()=>{var e=s(r);e.autoOpen=!1;var t=new a.U(c,e),i={[V]:oe(n),[G]:"++sequence, id",[Y]:o+",_meta.lwt,[_meta.lwt+"+o+"]"};return t.version(1).stores(i),await t.open(),{dexieDb:t,dexieTable:t[V],dexieDeletedTable:t[Y]}})();return ee.set(c,l),te.set(l,0),e}));return l}(t.databaseName,t.collectionName,r,t.schema),o=new Ze(e,t.databaseName,t.collectionName,t.schema,n,t.options,r);return Ke(J,t,o),Promise.resolve(o)}function Ye(e){if(e.closed)throw new Error("RxStorageInstanceDexie is closed "+e.databaseName+"-"+e.collectionName)}var Ge=function(){function e(e){this.name=J,this.statics=X,this.settings=e}return e.prototype.createStorageInstance=function(e){return function(e){if(e.schema.keyCompression)throw g("UT5",{args:{params:e}});if((t=e.schema).encrypted&&t.encrypted.length>0||t.attachments&&t.attachments.encrypted)throw g("UT6",{args:{params:e}});var t;if(e.schema.attachments&&e.schema.attachments.compression)throw g("UT7",{args:{params:e}})}(e),function(e){if(e.indexes){var t=new Set;e.indexes.forEach((r=>{(0,u.qo)(r).forEach((a=>{if(!t.has(a)&&(t.add(a),"boolean"===A(e,a).type))throw g("DXE1",{schema:e,index:r,field:a})}))}))}}(e.schema),Ve(this,e,this.settings)},e}();function Je(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){if(e.constructor!==t.constructor)return!1;var r,a;if(Array.isArray(e)){if((r=e.length)!==t.length)return!1;for(a=r;0!=a--;)if(!Je(e[a],t[a]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();var n=Object.keys(e);if((r=n.length)!==Object.keys(t).length)return!1;for(a=r;0!=a--;)if(!Object.prototype.hasOwnProperty.call(t,n[a]))return!1;for(a=r;0!=a--;){var i=n[a];if(!Je(e[i],t[i]))return!1}return!0}return e!=e&&t!=t}var Xe={preAddRxPlugin:[],preCreateRxDatabase:[],createRxDatabase:[],preCreateRxCollection:[],createRxCollection:[],postDestroyRxCollection:[],postRemoveRxCollection:[],preCreateRxSchema:[],createRxSchema:[],preCreateRxQuery:[],prePrepareQuery:[],createRxDocument:[],postCreateRxDocument:[],preCreateRxStorageInstance:[],preMigrateDocument:[],postMigrateDocument:[],preDestroyRxDatabase:[],postRemoveRxDatabase:[],preReplicationMasterWrite:[],preReplicationMasterWriteDocumentsHandle:[]};function et(e,t){Xe[e]&&Xe[e].forEach((e=>e(t)))}function tt(e,t){return Promise.all(Xe[e].map((e=>e(t))))}var rt=function(){function e(e,t){this.jsonSchema=e,this.hashFunction=t,this.indexes=function(e){return(e.indexes||[]).map((e=>(0,u.AD)(e)?e:[e]))}(this.jsonSchema),this.primaryPath=q(this.jsonSchema.primaryKey),this.finalFields=W(this.jsonSchema)}var t=e.prototype;return t.validateChange=function(e,t){this.finalFields.forEach((r=>{if(!Je(e[r],t[r]))throw g("DOC9",{dataBefore:e,dataAfter:t,fieldName:r,schema:this.jsonSchema})}))},t.getDocumentPrototype=function(){var e={},t=A(this.jsonSchema,"");return Object.keys(t).forEach((t=>{var r=t;e.__defineGetter__(t,(function(){if(this.get&&"function"==typeof this.get)return this.get(r)})),Object.defineProperty(e,t+"$",{get:function(){return this.get$(r)},enumerable:!1,configurable:!1}),Object.defineProperty(e,t+"_",{get:function(){return this.populate(r)},enumerable:!1,configurable:!1})})),l(this,"getDocumentPrototype",(()=>e)),e},t.getPrimaryOfDocumentData=function(e){return T(this.jsonSchema,e)},(0,d.Z)(e,[{key:"version",get:function(){return this.jsonSchema.version}},{key:"defaultValues",get:function(){var e={};return Object.entries(this.jsonSchema.properties).filter((e=>{let[,t]=e;return t.hasOwnProperty("default")})).forEach((t=>{let[r,a]=t;return e[r]=a.default})),l(this,"defaultValues",e)}},{key:"hash",get:function(){return l(this,"hash",this.hashFunction(JSON.stringify(this.jsonSchema)))}}]),e}();function at(e,t,r){void 0===r&&(r=!0),r&&et("preCreateRxSchema",e);var a=$(e);a=function(e){return o(e,!0)}(a),p.deepFreezeWhenDevMode(a);var n=new rt(a,t);return et("createRxSchema",n),n}var nt=r(598),it=r(6621),st=r(6728),ot=r(6005),ct=r(7570);function lt(e){var t=e.split("-"),r="RxDB";return t.forEach((e=>{r+=_(e)})),r+="Plugin",new Error("You are using a function which must be overwritten by a plugin.\n        You should either prevent the usage of this function or add the plugin via:\n            import { "+r+" } from 'rxdb/plugins/"+e+"';\n            addRxPlugin("+r+");\n        ")}function ut(e){return e.documentData?e.documentData:e.previousDocumentData}var dt=function(){function e(e,t,r,a){this.queueByDocId=new Map,this.isRunning=!1,this.storageInstance=e,this.primaryPath=t,this.preWrite=r,this.postWrite=a}var t=e.prototype;return t.addWrite=function(e,t){var r=e[this.primaryPath],a=i(this.queueByDocId,r,(()=>[]));return new Promise(((r,n)=>{var i={lastKnownDocumentState:e,modifier:t,resolve:r,reject:n};(0,he.Is)(a).push(i),this.triggerRun()}))},t.triggerRun=async function(){if(!0!==this.isRunning&&0!==this.queueByDocId.size){this.isRunning=!0;var e=[],t=this.queueByDocId;this.queueByDocId=new Map,await Promise.all(Array.from(t.entries()).map((async t=>{let[r,a]=t;var n,i,s,o=(n=a.map((e=>e.lastKnownDocumentState)),i=n[0],s=Ee(i._rev).height,n.forEach((e=>{var t=Ee(e._rev).height;t>s&&(i=e,s=t)})),i),l=o;for(var u of a)try{l=await u.modifier(c(l))}catch(d){u.reject(d),u.reject=()=>{},u.resolve=()=>{}}try{await this.preWrite(l,o)}catch(d){return void a.forEach((e=>e.reject(d)))}e.push({previous:o,document:l})})));var r=e.length>0?await this.storageInstance.bulkWrite(e,"incremental-write"):{error:[],success:[]};return await Promise.all(r.success.map((e=>{var r=e[this.primaryPath];this.postWrite(e),n(t,r).forEach((t=>t.resolve(e)))}))),r.error.forEach((e=>{var r,a=e.documentId,s=n(t,a),o=x(e);if(o){var c=i(this.queueByDocId,a,(()=>[]));s.reverse().forEach((e=>{e.lastKnownDocumentState=(0,he.Is)(o.documentInDb),(0,he.Is)(c).unshift(e)}))}else{var l=g("COL20",{name:w[(r=e).status],document:r.documentId,writeError:r});s.forEach((e=>e.reject(l)))}})),this.isRunning=!1,this.triggerRun()}},e}();function ht(e){return async t=>{var r=function(e){return Object.assign({},e,{_meta:void 0,_deleted:void 0,_rev:void 0})}(t);r._deleted=t._deleted;var a=await e(r),n=Object.assign({},a,{_meta:t._meta,_attachments:t._attachments,_rev:t._rev,_deleted:void 0!==a._deleted?a._deleted:t._deleted});return void 0===n._deleted&&(n._deleted=!1),n}}var mt={get primaryPath(){if(this.isInstanceOfRxDocument)return this.collection.schema.primaryPath},get primary(){var e=this;if(e.isInstanceOfRxDocument)return e._data[e.primaryPath]},get revision(){if(this.isInstanceOfRxDocument)return this._data._rev},get deleted$(){if(this.isInstanceOfRxDocument)return this.$.pipe((0,nt.U)((e=>e._data._deleted)))},get deleted(){if(this.isInstanceOfRxDocument)return this._data._deleted},getLatest(){var e=this.collection._docCache.getLatestDocumentData(this.primary);return this.collection._docCache.getCachedRxDocument(e)},get $(){return this.collection.$.pipe((0,it.h)((e=>!e.isLocal)),(0,it.h)((e=>e.documentId===this.primary)),(0,nt.U)((e=>ut(e))),(0,st.O)(this.collection._docCache.getLatestDocumentData(this.primary)),(0,ot.x)(((e,t)=>e._rev===t._rev)),(0,nt.U)((e=>this.collection._docCache.getCachedRxDocument(e))),(0,ct.d)(he.kv))},get$(e){if(p.isDevMode()){if(e.includes(".item."))throw g("DOC1",{path:e});if(e===this.primaryPath)throw g("DOC2");if(this.collection.schema.finalFields.includes(e))throw g("DOC3",{path:e});if(!A(this.collection.schema.jsonSchema,e))throw g("DOC4",{path:e})}return this.$.pipe((0,nt.U)((t=>O(t,e))),(0,ot.x)())},populate(e){var t=A(this.collection.schema.jsonSchema,e),r=this.get(e);if(!r)return de.m5;if(!t)throw g("DOC5",{path:e});if(!t.ref)throw g("DOC6",{path:e,schemaObj:t});var a=this.collection.database.collections[t.ref];if(!a)throw g("DOC7",{ref:t.ref,path:e,schemaObj:t});return"array"===t.type?a.findByIds(r).exec().then((e=>{var t=e.values();return Array.from(t)})):a.findOne(r).exec()},get(e){return i(this._propertyCache,e,(()=>{var t=O(this._data,e);if("object"!=typeof t||null===t||Array.isArray(t))return p.deepFreezeWhenDevMode(t);var r=this;return new Proxy(s(t),{get(t,a){if("string"!=typeof a)return t[a];var n=a.charAt(a.length-1);if("$"===n){var i=a.slice(0,-1);return r.get$(I(e+"."+i))}if("_"===n){var s=a.slice(0,-1);return r.populate(I(e+"."+s))}return r.get(I(e+"."+a))}})}))},toJSON(e){if(void 0===e&&(e=!1),e)return p.deepFreezeWhenDevMode(this._data);var t=s(this._data);return delete t._rev,delete t._attachments,delete t._deleted,delete t._meta,p.deepFreezeWhenDevMode(t)},toMutableJSON(e){return void 0===e&&(e=!1),c(this.toJSON(e))},update(e){throw lt("update")},incrementalUpdate(e){throw lt("update")},updateCRDT(e){throw lt("crdt")},putAttachment(){throw lt("attachments")},getAttachment(){throw lt("attachments")},allAttachments(){throw lt("attachments")},get allAttachments$(){throw lt("attachments")},async modify(e,t){var r=this._data,a=await ht(e)(r);return this._saveData(a,r)},incrementalModify(e,t){return this.collection.incrementalWriteQueue.addWrite(this._data,ht(e)).then((e=>this.collection._docCache.getCachedRxDocument(e)))},patch(e){var t=this._data,r=c(t);return Object.entries(e).forEach((e=>{let[t,a]=e;r[t]=a})),this._saveData(r,t)},incrementalPatch(e){return this.incrementalModify((t=>(Object.entries(e).forEach((e=>{let[r,a]=e;t[r]=a})),t)))},async _saveData(e,t){if(e=s(e),this._data._deleted)throw g("DOC11",{id:this.primary,document:this});await ft(this.collection,e,t);var r=await this.collection.storageInstance.bulkWrite([{previous:t,document:e}],"rx-document-save-data"),a=r.error[0];return qe(this.collection,this.primary,e,a),await this.collection._runHooks("post","save",e,this),this.collection._docCache.getCachedRxDocument(r.success[0])},remove(){var e=this.collection;if(this.deleted)return Promise.reject(g("DOC13",{document:this,id:this.primary}));var t,r=s(this._data);return e._runHooks("pre","remove",r,this).then((async()=>{r._deleted=!0;var t=await e.storageInstance.bulkWrite([{previous:this._data,document:r}],"rx-document-remove"),a=t.error[0];return qe(e,this.primary,r,a),t.success[0]})).then((e=>(t=e,this.collection._runHooks("post","remove",r,this)))).then((()=>this.collection._docCache.getCachedRxDocument(t)))},incrementalRemove(){return this.incrementalModify((async e=>(await this.collection._runHooks("pre","remove",e,this),e._deleted=!0,e))).then((async e=>(await this.collection._runHooks("post","remove",e._data,e),e)))},destroy(){throw g("DOC14")}};function pt(e){void 0===e&&(e=mt);var t=function(e,t){this.collection=e,this._data=t,this._propertyCache=new Map,this.isInstanceOfRxDocument=!0};return t.prototype=e,t}function ft(e,t,r){return t._meta=Object.assign({},r._meta,t._meta),p.isDevMode()&&e.schema.validateChange(r,t),e._runHooks("pre","save",t,r)}var yt=r(10),vt=r(6871),gt=r(3028),bt=r(1556),xt=r(8456);function wt(e,t){return t.sort&&0!==t.sort.length?t.sort.map((e=>Object.keys(e)[0])):[e]}var kt=new WeakMap;function jt(e,t){if(!e.collection.database.eventReduce)return{runFullQueryAgain:!0};var r=function(e){return i(kt,e,(()=>{var t=e.collection,r=De(t.storageInstance.schema,c(e.mangoQuery)),a=t.schema.primaryPath,n=_e(t.schema.jsonSchema,r),i=Ie(t.schema.jsonSchema,r);return{primaryKey:e.collection.schema.primaryPath,skip:r.skip,limit:r.limit,sortFields:wt(a,r),sortComparator:(t,r)=>{var a={docA:t,docB:r,rxQuery:e};return n(a.docA,a.docB)},queryMatcher:t=>i({doc:t,rxQuery:e}.doc)}}))}(e),a=(0,he.Is)(e._result).docsData.slice(0),n=(0,he.Is)(e._result).docsDataMap,s=!1;return t.map((e=>function(e){switch(e.operation){case"INSERT":return{operation:e.operation,id:e.documentId,doc:e.documentData,previous:null};case"UPDATE":return{operation:e.operation,id:e.documentId,doc:p.deepFreezeWhenDevMode(e.documentData),previous:e.previousDocumentData?e.previousDocumentData:"UNKNOWN"};case"DELETE":return{operation:e.operation,id:e.documentId,doc:null,previous:e.previousDocumentData}}}(e))).filter(u.S7).find((e=>{var t={queryParams:r,changeEvent:e,previousResults:a,keyDocumentMap:n},i=(0,xt.Rf)(t);return"runFullQueryAgain"===i||("doNothing"!==i?(s=!0,(0,xt.wu)(i,r,e,a,n),!1):void 0)}))?{runFullQueryAgain:!0}:{runFullQueryAgain:!1,changed:s,newResults:a}}var Dt=function(){function e(){this._map=new Map}return e.prototype.getByQuery=function(e){var t=e.toString();return i(this._map,t,(()=>e))},e}();function _t(e,t){t.uncached=!0;var r=t.toString();e._map.delete(r)}function It(e){return e.refCount$.observers.length}var Pt,Rt,St=(Pt=100,Rt=3e4,(e,t)=>{if(!(t._map.size<Pt)){var r=(0,ue.z)()-Rt,a=[],n=Array.from(t._map.values());for(var i of n)It(i)>0||(0===i._lastEnsureEqual&&i._creationTime<r?_t(t,i):a.push(i));var s=a.length-Pt;s<=0||a.sort(((e,t)=>e._lastEnsureEqual-t._lastEnsureEqual)).slice(0,s).forEach((e=>_t(t,e)))}}),Et=new WeakSet;var Ct=function(){function e(e,t,r){this.cacheItemByDocId=new Map,this.registry="function"==typeof FinalizationRegistry?new FinalizationRegistry((e=>{var t=e.docId,r=this.cacheItemByDocId.get(t);r&&(r.byRev.delete(e.revisionHeight),0===r.byRev.size&&this.cacheItemByDocId.delete(t))})):void 0,this.registerIdleTasks=[],this.primaryPath=e,this.changes$=t,this.documentCreator=r,t.subscribe((e=>{var t=e.documentId,r=this.cacheItemByDocId.get(t);if(r){var a=ut(e);r.last=a}}))}var t=e.prototype;return t.getLatestDocumentData=function(e){return n(this.cacheItemByDocId,e).last},t.getLatestDocumentDataIfExists=function(e){var t=this.cacheItemByDocId.get(e);if(t)return t.last},(0,d.Z)(e,[{key:"getCachedRxDocument",get:function(){return l(this,"getCachedRxDocument",function(e){var t=e.primaryPath,r=e.cacheItemByDocId,a=e.registry,n=p.deepFreezeWhenDevMode,s=e.documentCreator,o=o=>{var c=o[t],l=Ce(o._rev),u=i(r,c,(()=>function(e){return{byRev:new Map,last:e}}(o))),d=u.byRev,h=d.get(l),m=h?h.deref():void 0;return m||(o=n(o),m=s(o),d.set(l,Nt(m)),a&&(e.registerIdleTasks.push(m),e.registerIdlePromise||(e.registerIdlePromise=(0,de.y$)().then((()=>{e.registerIdlePromise=void 0;var t=e.registerIdleTasks;0!==t.length&&(e.registerIdleTasks=[],t.forEach((e=>{a.register(e,{docId:e.primary,revisionHeight:Ce(e.revision)})})))}))))),m};return o}(this))}}]),e}();function Ot(e,t){for(var r=e.getCachedRxDocument,a=[],n=0;n<t.length;n++){var i=r(t[n]);a.push(i)}return a}var Nt="function"==typeof WeakRef?function(e){return new WeakRef(e)}:function(e){return{deref:()=>e}};var Bt=function(){function e(e,t,r){this.time=(0,ue.z)(),this.collection=e,this.count=r,this.documents=Ot(this.collection._docCache,t)}return(0,d.Z)(e,[{key:"docsData",get:function(){return l(this,"docsData",this.documents.map((e=>e._data)))}},{key:"docsDataMap",get:function(){var e=new Map;return this.documents.forEach((t=>{e.set(t.primary,t._data)})),l(this,"docsDataMap",e)}},{key:"docsMap",get:function(){for(var e=new Map,t=this.documents,r=0;r<t.length;r++){var a=t[r];e.set(a.primary,a)}return l(this,"docsMap",e)}}]),e}(),At=0,Mt=function(){function e(e,t,r,a){void 0===a&&(a={}),this.id=++At,this._execOverDatabaseCount=0,this._creationTime=(0,ue.z)(),this._lastEnsureEqual=0,this.uncached=!1,this.refCount$=new yt.X(null),this._result=null,this._latestChangeEvent=-1,this._lastExecStart=0,this._lastExecEnd=0,this._ensureEqualQueue=de.kZ,this.op=e,this.mangoQuery=t,this.collection=r,this.other=a,t||(this.mangoQuery={selector:{}}),this.isFindOneByIdQuery=function(e,t){if(!t.skip&&t.selector&&1===Object.keys(t.selector).length&&t.selector[e]){var r=t.selector[e];if("string"==typeof r)return r;if(1===Object.keys(r).length&&"string"==typeof r.$eq)return r.$eq;if(1===Object.keys(r).length&&Array.isArray(r.$eq)&&!r.$eq.find((e=>"string"!=typeof e)))return r.$eq}return!1}(this.collection.schema.primaryPath,t)}var t=e.prototype;return t._setResultData=function(e){if("number"!=typeof e){e instanceof Map&&(e=Array.from(e.values()));var t=new Bt(this.collection,e,e.length);this._result=t}else this._result=new Bt(this.collection,[],e)},t._execOverDatabase=async function(){if(this._execOverDatabaseCount=this._execOverDatabaseCount+1,this._lastExecStart=(0,ue.z)(),"count"===this.op){var e=this.getPreparedQuery(),t=await this.collection.storageInstance.count(e);if("slow"!==t.mode||this.collection.database.allowSlowCount)return t.count;throw g("QU14",{collection:this.collection,queryObj:this.mangoQuery})}if("findByIds"===this.op){var r=(0,he.Is)(this.mangoQuery.selector)[this.collection.schema.primaryPath].$in,a=new Map,n=[];if(r.forEach((e=>{var t=this.collection._docCache.getLatestDocumentDataIfExists(e);if(t){if(!t._deleted){var r=this.collection._docCache.getCachedRxDocument(t);a.set(e,r)}}else n.push(e)})),n.length>0)(await this.collection.storageInstance.findDocumentsById(n,!1)).forEach((e=>{var t=this.collection._docCache.getCachedRxDocument(e);a.set(t.primary,t)}));return a}var i=async function(e){var t=[],r=e.collection;if(e.isFindOneByIdQuery)if(Array.isArray(e.isFindOneByIdQuery)){var a=e.isFindOneByIdQuery;if(a=a.filter((r=>{var a=e.collection._docCache.getLatestDocumentDataIfExists(r);return!a||(a._deleted||t.push(a),!1)})),a.length>0){var n=await r.storageInstance.findDocumentsById(a,!1);(0,u.gu)(t,n)}}else{var i=e.isFindOneByIdQuery,s=e.collection._docCache.getLatestDocumentDataIfExists(i);if(!s){var o=await r.storageInstance.findDocumentsById([i],!1);o[0]&&(s=o[0])}s&&!s._deleted&&t.push(s)}else{var c=e.getPreparedQuery(),l=await r.storageInstance.query(c);t=l.documents}return t}(this);return i.then((e=>(this._lastExecEnd=(0,ue.z)(),e)))},t.exec=function(e){if(e&&"findOne"!==this.op)throw g("QU9",{collection:this.collection.name,query:this.mangoQuery,op:this.op});return $t(this).then((()=>(0,vt.z)(this.$))).then((t=>{if(!t&&e)throw g("QU10",{collection:this.collection.name,query:this.mangoQuery,op:this.op});return t}))},t.toString=function(){var e=o({op:this.op,query:this.mangoQuery,other:this.other},!0),t=JSON.stringify(e);return this.toString=()=>t,t},t.getPreparedQuery=function(){var e={rxQuery:this,mangoQuery:De(this.collection.schema.jsonSchema,this.mangoQuery)};et("prePrepareQuery",e);var t=this.collection.database.storage.statics.prepareQuery(this.collection.schema.jsonSchema,e.mangoQuery);return this.getPreparedQuery=()=>t,t},t.doesDocumentDataMatch=function(e){return!e._deleted&&this.queryMatcher(e)},t.remove=function(){return this.exec().then((e=>Array.isArray(e)?Promise.all(e.map((e=>e.remove()))):e.remove()))},t.update=function(e){throw lt("update")},t.where=function(e){throw lt("query-builder")},t.sort=function(e){throw lt("query-builder")},t.skip=function(e){throw lt("query-builder")},t.limit=function(e){throw lt("query-builder")},(0,d.Z)(e,[{key:"$",get:function(){if(!this._$){var e=this.collection.$.pipe((0,it.h)((e=>!e.isLocal)),(0,st.O)(null),(0,bt.z)((()=>$t(this))),(0,nt.U)((()=>this._result)),(0,ct.d)(he.kv),(0,ot.x)(((e,t)=>!(!e||e.time!==(0,he.Is)(t).time))),(0,it.h)((e=>!!e)),(0,nt.U)((e=>{var t=(0,he.Is)(e);return"count"===this.op?t.count:"findOne"===this.op?0===t.documents.length?null:t.documents[0]:"findByIds"===this.op?t.docsMap:t.documents.slice(0)})));this._$=(0,gt.T)(e,this.refCount$.pipe((0,it.h)((()=>!1))))}return this._$}},{key:"queryMatcher",get:function(){this.collection.schema.jsonSchema;return l(this,"queryMatcher",Ie(0,De(this.collection.schema.jsonSchema,this.mangoQuery)))}},{key:"asRxQuery",get:function(){return this}}]),e}();function qt(e,t,r,a){et("preCreateRxQuery",{op:e,queryObj:t,collection:r,other:a});var n,i,s=new Mt(e,t,r,a);return s=(n=s).collection._queryCache.getByQuery(n),i=r,Et.has(i)||(Et.add(i),(0,de.Y3)().then((()=>(0,de.C2)(200))).then((()=>{i.destroyed||i.cacheReplacementPolicy(i,i._queryCache),Et.delete(i)}))),s}function Tt(e){var t=e.asRxQuery.collection._changeEventBuffer.counter;return e._latestChangeEvent>=t}function $t(e){return e.collection.database.destroyed||Tt(e)?de.kZ:(e._ensureEqualQueue=e._ensureEqualQueue.then((()=>function(e){if(e._lastEnsureEqual=(0,ue.z)(),e.collection.database.destroyed||Tt(e))return de.kZ;var t=!1,r=!1;-1===e._latestChangeEvent&&(r=!0);if(!r){var a=e.asRxQuery.collection._changeEventBuffer.getFrom(e._latestChangeEvent+1);if(null===a)r=!0;else{e._latestChangeEvent=e.asRxQuery.collection._changeEventBuffer.counter;var n=e.asRxQuery.collection._changeEventBuffer.reduceByLastOfDoc(a);if("count"===e.op){var i=(0,he.Is)(e._result).count,s=i;n.forEach((t=>{var r=t.previousDocumentData&&e.doesDocumentDataMatch(t.previousDocumentData),a=e.doesDocumentDataMatch(t.documentData);!r&&a&&s++,r&&!a&&s--})),s!==i&&(t=!0,e._setResultData(s))}else{var o=jt(e,n);o.runFullQueryAgain?r=!0:o.changed&&(t=!0,e._setResultData(o.newResults))}}}if(r){var c=e.collection._changeEventBuffer.counter;return e._execOverDatabase().then((r=>(e._latestChangeEvent=c,"number"==typeof r?(e._result&&r===e._result.count||(t=!0,e._setResultData(r)),t):(e._result&&function(e,t,r){if(t.length!==r.length)return!1;for(var a=0,n=t.length;a<n;){var i=t[a],s=r[a];if(a++,i._rev!==s._rev||i[e]!==s[e])return!1}return!0}(e.collection.schema.primaryPath,r,e._result.docsData)||(t=!0,e._setResultData(r)),t))))}return Promise.resolve(t)}(e))),e._ensureEqualQueue)}var Lt="collection",Wt="storage-token",Ft=$({version:0,title:"RxInternalDocument",primaryKey:{key:"id",fields:["context","key"],separator:"|"},type:"object",properties:{id:{type:"string",maxLength:200},key:{type:"string"},context:{type:"string",enum:[Lt,Wt,"rx-migration-status","OTHER"]},data:{type:"object",additionalProperties:!0}},indexes:[],required:["key","context","data"],additionalProperties:!1,sharding:{shards:1,mode:"collection"}});function Qt(e,t){return T(Ft,{key:e,context:t})}async function zt(e,t){var r=e.prepareQuery(t.schema,{selector:{context:Lt},sort:[{id:"asc"}],skip:0});return(await t.query(r)).documents}var Ht="storageToken",Kt=Qt(Ht,Wt);function Ut(e,t){return e+"-"+t.version}function Zt(e,t){return t=function(e,t){for(var r=Object.keys(e.defaultValues),a=0;a<r.length;++a){var n=r[a];t.hasOwnProperty(n)&&void 0!==t[n]||(t[n]=e.defaultValues[n])}return t}(e,t=s(t)),(t=M(e.primaryPath,e.jsonSchema,t))._meta=B(),t.hasOwnProperty("_deleted")||(t._deleted=!1),t.hasOwnProperty("_attachments")||(t._attachments={}),t.hasOwnProperty("_rev")||(t._rev=""),t}async function Vt(e,t,r,a,n,i,s){var o=(await zt(e.statics,t)).filter((e=>e.data.name===n)),c=[];o.forEach((e=>{c.push({collectionName:e.data.name,schema:e.data.schema,isCollection:!0}),e.data.connectedStorages.forEach((e=>c.push({collectionName:e.collectionName,isCollection:!1,schema:e.schema})))}));var l=new Set;if(c=c.filter((e=>{var t=e.collectionName+"||"+e.schema.version;return!l.has(t)&&(l.add(t),!0)})),await Promise.all(c.map((async t=>{var s=await e.createStorageInstance({collectionName:t.collectionName,databaseInstanceToken:r,databaseName:a,multiInstance:!1,options:{},schema:t.schema,password:i,devMode:p.isDevMode()});await s.remove(),t.isCollection&&await tt("postRemoveRxCollection",{storage:e,databaseName:a,collectionName:n})}))),s){var u=o.map((e=>{var t=Le(e);return t._deleted=!0,t._meta.lwt=(0,ue.z)(),t._rev=Oe(r,e),{previous:e,document:t}}));await t.bulkWrite(u,"rx-database-remove-collection-all")}}var Yt=function(){function e(e){this.subs=[],this.limit=100,this.counter=0,this.eventCounterMap=new WeakMap,this.buffer=[],this.collection=e,this.subs.push(this.collection.$.pipe((0,it.h)((e=>!e.isLocal))).subscribe((e=>this._handleChangeEvent(e))))}var t=e.prototype;return t._handleChangeEvent=function(e){for(this.counter++,this.buffer.push(e),this.eventCounterMap.set(e,this.counter);this.buffer.length>this.limit;)this.buffer.shift()},t.getArrayIndexByPointer=function(e){var t=this.buffer[0],r=this.eventCounterMap.get(t);return e<r?null:e-r},t.getFrom=function(e){var t=[],r=this.getArrayIndexByPointer(e);if(null===r)return null;for(;;){var a=this.buffer[r];if(r++,!a)return t;t.push(a)}},t.runFrom=function(e,t){var r=this.getFrom(e);if(null===r)throw new Error("out of bounds");r.forEach((e=>t(e)))},t.reduceByLastOfDoc=function(e){return e.slice(0)},t.destroy=function(){this.subs.forEach((e=>e.unsubscribe()))},e}();var Gt=new WeakMap;function Jt(e){var t=e.schema.getDocumentPrototype(),r=function(e){var t={};return Object.entries(e.methods).forEach((e=>{let[r,a]=e;t[r]=a})),t}(e),a={};return[t,r,mt].forEach((e=>{Object.getOwnPropertyNames(e).forEach((t=>{var r=Object.getOwnPropertyDescriptor(e,t),n=!0;(t.startsWith("_")||t.endsWith("_")||t.startsWith("$")||t.endsWith("$"))&&(n=!1),"function"==typeof r.value?Object.defineProperty(a,t,{get(){return r.value.bind(this)},enumerable:n,configurable:!1}):(r.enumerable=n,r.configurable=!1,r.writable&&(r.writable=!1),Object.defineProperty(a,t,r))}))})),a}function Xt(e,t){var r=function(e,t,r){var a=new e(t,r);return et("createRxDocument",a),a}(function(e){return i(Gt,e,(()=>pt(Jt(e))))}(e),e,p.deepFreezeWhenDevMode(t));return e._runHooksSync("post","create",t,r),et("postCreateRxDocument",r),r}var er=function(e,t){return Je($e(e.newDocumentState),$e(e.realMasterState))?Promise.resolve({isEqual:!0}):Promise.resolve({isEqual:!1,documentData:e.realMasterState})};var tr=["pre","post"],rr=["insert","save","remove","create"],ar=!1,nr=function(){function e(e,t,r,a,n,i,s,o,c,l,u,d){void 0===n&&(n={}),void 0===i&&(i={}),void 0===s&&(s={}),void 0===o&&(o={}),void 0===c&&(c={}),void 0===l&&(l=St),void 0===u&&(u={}),void 0===d&&(d=er),this.storageInstance={},this.timeouts=new Set,this.incrementalWriteQueue={},this._incrementalUpsertQueues=new Map,this.synced=!1,this.hooks={},this._subs=[],this._docCache={},this._queryCache=new Dt,this.$={},this.checkpoint$={},this._changeEventBuffer={},this.onDestroy=[],this.destroyed=!1,this.database=e,this.name=t,this.schema=r,this.internalStorageInstance=a,this.instanceCreationOptions=n,this.migrationStrategies=i,this.methods=s,this.attachments=o,this.options=c,this.cacheReplacementPolicy=l,this.statics=u,this.conflictHandler=d,function(e){if(ar)return;ar=!0;var t=Object.getPrototypeOf(e);rr.forEach((e=>{tr.map((r=>{var a=r+_(e);t[a]=function(t,a){return this.addHook(r,e,t,a)}}))}))}(this.asRxCollection)}var t=e.prototype;return t.prepare=async function(){this.storageInstance=We(this.database,this.internalStorageInstance,this.schema.jsonSchema),this.incrementalWriteQueue=new dt(this.storageInstance,this.schema.primaryPath,((e,t)=>ft(this,e,t)),(e=>this._runHooks("post","save",e)));var e,t=this.database.eventBulks$.pipe((0,it.h)((e=>e.collectionName===this.name)));this.$=t.pipe((0,bt.z)((e=>e.events))),this.checkpoint$=t.pipe((0,nt.U)((e=>e.checkpoint))),this._changeEventBuffer=(e=this.asRxCollection,new Yt(e)),this._docCache=new Ct(this.schema.primaryPath,this.$.pipe((0,it.h)((e=>!e.isLocal))),(e=>Xt(this.asRxCollection,e)));var r=await this.database.storageToken,a=this.storageInstance.changeStream().subscribe((e=>{var t={id:e.id,internal:!1,collectionName:this.name,storageToken:r,events:e.events.map((e=>Me(!1,e,this))),databaseToken:this.database.token,checkpoint:e.checkpoint,context:e.context,endTime:e.endTime,startTime:e.startTime};this.database.$emit(t)}));return this._subs.push(a),this._subs.push(this.storageInstance.conflictResultionTasks().subscribe((e=>{this.conflictHandler(e.input,e.context).then((t=>{this.storageInstance.resolveConflictResultionTask({id:e.id,output:t})}))}))),de.$Y},t.cleanup=function(e){throw lt("cleanup")},t.migrationNeeded=function(){throw lt("migration")},t.getMigrationState=function(){throw lt("migration")},t.startMigration=function(e){return void 0===e&&(e=10),this.getMigrationState().startMigration(e)},t.migratePromise=function(e){return void 0===e&&(e=10),this.getMigrationState().migratePromise(e)},t.insert=async function(e){var t=await this.bulkInsert([e]),r=t.error[0];return qe(this,e[this.schema.primaryPath],e,r),(0,he.Is)(t.success[0])},t.bulkInsert=async function(e){if(0===e.length)return{success:[],error:[]};var t=this.schema.primaryPath,r=e.map((e=>Zt(this.schema,e))),a=this.hasHooks("pre","insert")?await Promise.all(r.map((e=>this._runHooks("pre","insert",e).then((()=>e))))):r,n=a.map((e=>({document:e}))),i=await this.storageInstance.bulkWrite(n,"rx-collection-bulk-insert"),s=Ot(this._docCache,i.success);if(this.hasHooks("post","insert")){var o=new Map;a.forEach((e=>{o.set(e[t],e)})),await Promise.all(s.map((e=>this._runHooks("post","insert",o.get(e.primary),e))))}return{success:s,error:i.error}},t.bulkRemove=async function(e){var t=this.schema.primaryPath;if(0===e.length)return{success:[],error:[]};var r=await this.findByIds(e).exec(),a=[],i=new Map;Array.from(r.values()).forEach((e=>{var t=e.toMutableJSON(!0);a.push(t),i.set(e.primary,t)})),await Promise.all(a.map((e=>{var t=e[this.schema.primaryPath];return this._runHooks("pre","remove",e,r.get(t))})));var o=a.map((e=>{var t=s(e);return t._deleted=!0,{previous:e,document:t}})),c=await this.storageInstance.bulkWrite(o,"rx-collection-bulk-remove"),l=c.success.map((e=>e[t]));return await Promise.all(l.map((e=>this._runHooks("post","remove",i.get(e),r.get(e))))),{success:l.map((e=>n(r,e))),error:c.error}},t.bulkUpsert=async function(e){var t=[],r=new Map;e.forEach((e=>{var a=Zt(this.schema,e),n=a[this.schema.primaryPath];if(!n)throw g("COL3",{primaryPath:this.schema.primaryPath,data:a,schema:this.schema.jsonSchema});r.set(n,a),t.push(a)}));var a=await this.bulkInsert(t),i=a.success.slice(0),s=[];return await Promise.all(a.error.map((async e=>{if(409!==e.status)s.push(e);else{var t=e.documentId,a=n(r,t),o=(0,he.Is)(e.documentInDb),c=this._docCache.getCachedRxDocument(o),l=await c.incrementalModify((()=>a));i.push(l)}}))),{error:s,success:i}},t.upsert=async function(e){var t=await this.bulkUpsert([e]);return qe(this.asRxCollection,e[this.schema.primaryPath],e,t.error[0]),t.success[0]},t.incrementalUpsert=function(e){var t=Zt(this.schema,e),r=t[this.schema.primaryPath];if(!r)throw g("COL4",{data:e});var a=this._incrementalUpsertQueues.get(r);return a||(a=de.$Y),a=a.then((()=>function(e,t,r){var a=e._docCache.getLatestDocumentDataIfExists(t);if(a)return Promise.resolve({doc:e._docCache.getCachedRxDocument(a),inserted:!1});return e.findOne(t).exec().then((t=>t?{doc:t,inserted:!1}:e.insert(r).then((e=>({doc:e,inserted:!0})))))}(this,r,t))).then((e=>e.inserted?e.doc:function(e,t){return e.incrementalModify((e=>t))}(e.doc,t))),this._incrementalUpsertQueues.set(r,a),a},t.find=function(e){if("string"==typeof e)throw g("COL5",{queryObj:e});return e||(e={selector:{}}),qt("find",e,this)},t.findOne=function(e){if("number"==typeof e||Array.isArray(e))throw b("COL6",{queryObj:e});var t;if("string"==typeof e)t=qt("findOne",{selector:{[this.schema.primaryPath]:e},limit:1},this);else{if(e||(e={selector:{}}),e.limit)throw g("QU6");(e=s(e)).limit=1,t=qt("findOne",e,this)}return t},t.count=function(e){return e||(e={selector:{}}),qt("count",e,this)},t.findByIds=function(e){return qt("findByIds",{selector:{[this.schema.primaryPath]:{$in:e.slice(0)}}},this)},t.exportJSON=function(){throw lt("json-dump")},t.importJSON=function(e){throw lt("json-dump")},t.insertCRDT=function(e){throw lt("crdt")},t.addHook=function(e,t,r,a){if(void 0===a&&(a=!1),"function"!=typeof r)throw b("COL7",{key:t,when:e});if(!tr.includes(e))throw b("COL8",{key:t,when:e});if(!rr.includes(t))throw g("COL9",{key:t});if("post"===e&&"create"===t&&!0===a)throw g("COL10",{when:e,key:t,parallel:a});var n=r.bind(this),i=a?"parallel":"series";this.hooks[t]=this.hooks[t]||{},this.hooks[t][e]=this.hooks[t][e]||{series:[],parallel:[]},this.hooks[t][e][i].push(n)},t.getHooks=function(e,t){return this.hooks[t]&&this.hooks[t][e]?this.hooks[t][e]:{series:[],parallel:[]}},t.hasHooks=function(e,t){var r=this.getHooks(e,t);return!!r&&(r.series.length>0||r.parallel.length>0)},t._runHooks=function(e,t,r,a){var n=this.getHooks(e,t);if(!n)return de.$Y;var i=n.series.map((e=>()=>e(r,a)));return(0,de.Ze)(i).then((()=>Promise.all(n.parallel.map((e=>e(r,a))))))},t._runHooksSync=function(e,t,r,a){var n=this.getHooks(e,t);n&&n.series.forEach((e=>e(r,a)))},t.promiseWait=function(e){return new Promise((t=>{var r=setTimeout((()=>{this.timeouts.delete(r),t()}),e);this.timeouts.add(r)}))},t.destroy=function(){return this.destroyed?de.kZ:(this.destroyed=!0,Array.from(this.timeouts).forEach((e=>clearTimeout(e))),this._changeEventBuffer&&this._changeEventBuffer.destroy(),this.database.requestIdlePromise().then((()=>Promise.all(this.onDestroy.map((e=>e()))))).then((()=>this.storageInstance.close())).then((()=>(this._subs.forEach((e=>e.unsubscribe())),delete this.database.collections[this.name],tt("postDestroyRxCollection",this).then((()=>!0))))))},t.remove=async function(){await this.destroy(),await Vt(this.database.storage,this.database.internalStore,this.database.token,this.database.name,this.name,this.database.password,this.database.hashFunction)},(0,d.Z)(e,[{key:"insert$",get:function(){return this.$.pipe((0,it.h)((e=>"INSERT"===e.operation)))}},{key:"update$",get:function(){return this.$.pipe((0,it.h)((e=>"UPDATE"===e.operation)))}},{key:"remove$",get:function(){return this.$.pipe((0,it.h)((e=>"DELETE"===e.operation)))}},{key:"asRxCollection",get:function(){return this}}]),e}();var ir=r(7782),sr=r(6753);var or="undefined"!=typeof crypto&&void 0!==crypto.subtle&&"function"==typeof crypto.subtle.digest?async function(e){var t=(new TextEncoder).encode(e),r=await crypto.subtle.digest("SHA-256",t);return Array.prototype.map.call(new Uint8Array(r),(e=>("00"+e.toString(16)).slice(-2))).join("")}:function(e){return Promise.resolve((0,sr.JQ)(e))},cr=r(5898),lr=new Set,ur=function(){function e(e,t,r,a,n,i,s,o,c,l,u,d){void 0===s&&(s=!1),void 0===o&&(o={}),this.idleQueue=new ir.F,this.rxdbVersion="15.0.0-beta.30",this.storageInstances=new Set,this._subs=[],this.startupErrors=[],this.onDestroy=[],this.destroyed=!1,this.collections={},this.eventBulks$=new le.x,this.observable$=this.eventBulks$.pipe((0,bt.z)((e=>e.events))),this.storageToken=de.kZ,this.storageTokenDocument=de.kZ,this.emittedEventBulkIds=new cr.i(6e4),this.name=e,this.token=t,this.storage=r,this.instanceCreationOptions=a,this.password=n,this.multiInstance=i,this.eventReduce=s,this.options=o,this.internalStore=c,this.hashFunction=l,this.cleanupPolicy=u,this.allowSlowCount=d,"pseudoInstance"!==this.name&&(this.internalStore=We(this.asRxDatabase,c,Ft),this.storageTokenDocument=async function(e){var t=D(10),r=e.password?await e.hashFunction(JSON.stringify(e.password)):void 0,a={id:Kt,context:Wt,key:Ht,data:{rxdbVersion:e.rxdbVersion,token:t,instanceToken:e.token,passwordHash:r},_deleted:!1,_meta:B(),_rev:"",_attachments:{}},n=await e.internalStore.bulkWrite([{document:a}],"internal-add-storage-token");if(n.success[0])return n.success[0];var i=(0,he.Is)(n.error[0]);if(i.isError&&x(i)){var s=i;if(c=s.documentInDb.data.rxdbVersion,l=e.rxdbVersion,!c||l.includes("beta")&&l!==c||c.split(".")[0]!==l.split(".")[0])throw g("DM5",{args:{databaseStateVersion:s.documentInDb.data.rxdbVersion,codeVersion:e.rxdbVersion}});if(r&&r!==s.documentInDb.data.passwordHash)throw g("DB1",{passwordHash:r,existingPasswordHash:s.documentInDb.data.passwordHash});var o=s.documentInDb;return(0,he.Is)(o)}var c,l;throw i}(this.asRxDatabase).catch((e=>this.startupErrors.push(e))),this.storageToken=this.storageTokenDocument.then((e=>e.data.token)).catch((e=>this.startupErrors.push(e))))}var t=e.prototype;return t.$emit=function(e){this.emittedEventBulkIds.has(e.id)||(this.emittedEventBulkIds.add(e.id),this.eventBulks$.next(e))},t.removeCollectionDoc=async function(e,t){var r=await Be(this.internalStore,Qt(Ut(e,t),Lt));if(!r)throw g("SNH",{name:e,schema:t});var a=Le(r);a._deleted=!0,await this.internalStore.bulkWrite([{document:a,previous:r}],"rx-database-remove-collection")},t.addCollections=async function(e){var t={},r={},a=[],n={};await Promise.all(Object.entries(e).map((async e=>{let[i,o]=e;var c=i,l=o.schema;t[c]=l;var u=at(l,this.hashFunction);if(r[c]=u,this.collections[i])throw g("DB3",{name:i});var d=Ut(i,l),h={id:Qt(d,Lt),key:d,context:Lt,data:{name:c,schemaHash:await u.hash,schema:u.jsonSchema,version:u.version,connectedStorages:[]},_deleted:!1,_meta:B(),_rev:"",_attachments:{}};a.push({document:h});var m=Object.assign({},o,{name:c,schema:u,database:this}),p=s(o);p.database=this,p.name=i,et("preCreateRxCollection",p),m.conflictHandler=p.conflictHandler,n[c]=m})));var i=await this.internalStore.bulkWrite(a,"rx-database-add-collection");await async function(e){if(await e.storageToken,e.startupErrors[0])throw e.startupErrors[0]}(this),await Promise.all(i.error.map((async e=>{if(409!==e.status)throw g("DB12",{database:this.name,writeError:e});var a=(0,he.Is)(e.documentInDb),n=a.data.name,i=r[n];if(a.data.schemaHash!==await i.hash)throw g("DB6",{database:this.name,collection:n,previousSchemaHash:a.data.schemaHash,schemaHash:await i.hash,previousSchema:a.data.schema,schema:(0,he.Is)(t[n])})})));var o={};return await Promise.all(Object.keys(e).map((async e=>{var t=n[e],r=await function(e){let{database:t,name:r,schema:a,instanceCreationOptions:n={},migrationStrategies:i={},autoMigrate:s=!0,statics:o={},methods:c={},attachments:l={},options:u={},localDocuments:d=!1,cacheReplacementPolicy:h=St,conflictHandler:m=er}=e;var f={databaseInstanceToken:t.token,databaseName:t.name,collectionName:r,schema:a.jsonSchema,options:n,multiInstance:t.multiInstance,password:t.password,devMode:p.isDevMode()};return et("preCreateRxStorageInstance",f),async function(e,t){return t.multiInstance=e.multiInstance,await e.storage.createStorageInstance(t)}(t,f).then((e=>{var p=new nr(t,r,a,e,n,i,c,l,u,h,o,m);return p.prepare().then((()=>{Object.entries(o).forEach((e=>{let[t,r]=e;Object.defineProperty(p,t,{get:()=>r.bind(p)})}));var e=de.$Y;return s&&0!==p.schema.version&&(e=p.migratePromise()),e})).then((()=>(et("createRxCollection",{collection:p,creator:{name:r,schema:a,storageInstance:e,instanceCreationOptions:n,migrationStrategies:i,methods:c,attachments:l,options:u,cacheReplacementPolicy:h,localDocuments:d,statics:o}}),p))).catch((t=>e.close().then((()=>Promise.reject(t)))))}))}(t);o[e]=r,this.collections[e]=r,this[e]||Object.defineProperty(this,e,{get:()=>this.collections[e]})}))),o},t.lockedRun=function(e){return this.idleQueue.wrapCall(e)},t.requestIdlePromise=function(){return this.idleQueue.requestIdlePromise()},t.exportJSON=function(e){throw lt("json-dump")},t.importJSON=function(e){throw lt("json-dump")},t.backup=function(e){throw lt("backup")},t.leaderElector=function(){throw lt("leader-election")},t.isLeader=function(){throw lt("leader-election")},t.waitForLeadership=function(){throw lt("leader-election")},t.migrationStates=function(){throw lt("migration")},t.destroy=async function(){return this.destroyed?de.kZ:(this.destroyed=!0,await tt("preDestroyRxDatabase",this),this.eventBulks$.complete(),this._subs.map((e=>e.unsubscribe())),"pseudoInstance"===this.name?de.kZ:this.requestIdlePromise().then((()=>Promise.all(this.onDestroy.map((e=>e()))))).then((()=>Promise.all(Object.keys(this.collections).map((e=>this.collections[e])).map((e=>e.destroy()))))).then((()=>this.internalStore.close())).then((()=>lr.delete(this.name))).then((()=>!0)))},t.remove=function(){return this.destroy().then((()=>async function(e,t,r){var a=D(10),n=await dr(a,t,e,{},!1,r),i=await zt(t.statics,n),s=new Set;i.forEach((e=>s.add(e.data.name)));var o=Array.from(s);return await Promise.all(o.map((i=>Vt(t,n,a,e,i,r)))),await tt("postRemoveRxDatabase",{databaseName:e,storage:t}),await n.remove(),o}(this.name,this.storage,this.password)))},(0,d.Z)(e,[{key:"$",get:function(){return this.observable$}},{key:"asRxDatabase",get:function(){return this}}]),e}();async function dr(e,t,r,a,n,i){return await t.createStorageInstance({databaseInstanceToken:e,databaseName:r,collectionName:Ne,schema:Ft,options:a,multiInstance:n,password:i,devMode:p.isDevMode()})}function hr(e){let{storage:t,instanceCreationOptions:r,name:a,password:n,multiInstance:i=!0,eventReduce:s=!0,ignoreDuplicate:o=!1,options:c={},cleanupPolicy:l,allowSlowCount:u=!1,localDocuments:d=!1,hashFunction:h=or}=e;et("preCreateRxDatabase",{storage:t,instanceCreationOptions:r,name:a,password:n,multiInstance:i,eventReduce:s,ignoreDuplicate:o,options:c,localDocuments:d}),o||function(e){if(lr.has(e))throw g("DB8",{name:e,link:"https://pubkey.github.io/rxdb/rx-database.html#ignoreduplicate"})}(a),lr.add(a);var m=D(10);return dr(m,t,a,r,i,n).catch((e=>{throw lr.delete(a),e})).then((e=>{var p=new ur(a,m,t,r,n,i,s,c,e,h,l,u);return tt("createRxDatabase",{database:p,creator:{storage:t,instanceCreationOptions:r,name:a,password:n,multiInstance:i,eventReduce:s,ignoreDuplicate:o,options:c,localDocuments:d}}).then((()=>p))}))}var mr={RxSchema:rt.prototype,RxDocument:mt,RxQuery:Mt.prototype,RxCollection:nr.prototype,RxDatabase:ur.prototype},pr=new Set,fr=new Set;var yr=function(e){function t(t,r,a){var n;return(n=e.call(this,null,r)||this).id=t,n.parent=a,n}return(0,h.Z)(t,e),t}(pt()),vr={get isLocal(){return!0},get allAttachments$(){throw g("LD1",{document:this})},get primaryPath(){return"id"},get primary(){return this.id},get $(){var e=n(wr,this.parent);return this.parent.$.pipe((0,it.h)((e=>e.documentId===this.primary)),(0,it.h)((e=>e.isLocal)),(0,nt.U)((e=>ut(e))),(0,st.O)(e.docCache.getLatestDocumentData(this.primary)),(0,ot.x)(((e,t)=>e._rev===t._rev)),(0,nt.U)((t=>e.docCache.getCachedRxDocument(t))),(0,ct.d)(he.kv))},getLatest(){var e=n(wr,this.parent),t=e.docCache.getLatestDocumentData(this.primary);return e.docCache.getCachedRxDocument(t)},get(e){if(e="data."+e,this._data){if("string"!=typeof e)throw b("LD2",{objPath:e});var t=O(this._data,e);return t=p.deepFreezeWhenDevMode(t)}},get$(e){if(e="data."+e,p.isDevMode()){if(e.includes(".item."))throw g("LD3",{objPath:e});if(e===this.primaryPath)throw g("LD4")}return this.$.pipe((0,nt.U)((e=>e._data)),(0,nt.U)((t=>O(t,e))),(0,ot.x)())},async incrementalModify(e){var t=await jr(this.parent);return t.incrementalWriteQueue.addWrite(this._data,(async t=>(t.data=await e(t.data,this),t))).then((e=>t.docCache.getCachedRxDocument(e)))},incrementalPatch(e){return this.incrementalModify((t=>(Object.entries(e).forEach((e=>{let[r,a]=e;t[r]=a})),t)))},async _saveData(e){var t=await jr(this.parent),r=this._data;return e.id=this.id,t.storageInstance.bulkWrite([{previous:r,document:e}],"local-document-save-data").then((t=>{var r=t.success[0];if(!r)throw t.error[0];(e=s(e))._rev=r._rev}))},async remove(){var e=await jr(this.parent),t={id:this._data.id,data:{},_deleted:!0,_meta:B(),_rev:"",_attachments:{}};return Ae(e.storageInstance,{previous:this._data,document:t},"local-document-remove").then((t=>e.docCache.getCachedRxDocument(t)))}},gr=!1,br=()=>{if(!gr){gr=!0;var e=mt;Object.getOwnPropertyNames(e).forEach((t=>{if(!Object.getOwnPropertyDescriptor(vr,t)){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(vr,t,r)}}));["populate","update","putAttachment","getAttachment","allAttachments"].forEach((e=>vr[e]=(e=>()=>{throw g("LD6",{functionName:e})})(e)))}};var xr=new WeakMap,wr=new WeakMap;function kr(e){var t=e.database?e.database:e,r=e.database?e.name:"",a=(async()=>{var a=await Dr(t.token,t.storage,t.name,r,t.instanceCreationOptions,t.multiInstance);a=We(t,a,Rr);var n=new Ct("id",e.$.pipe((0,it.h)((e=>e.isLocal))),(t=>function(e,t){br();var r=new yr(e.id,e,t);return Object.setPrototypeOf(r,vr),r.prototype=vr,r}(t,e))),i=new dt(a,"id",(()=>{}),(()=>{})),s=await t.storageToken,o=a.changeStream().subscribe((r=>{var a={id:r.id,internal:!1,collectionName:e.database?e.name:void 0,storageToken:s,events:r.events.map((t=>Me(!0,t,e.database?e:void 0))),databaseToken:t.token,checkpoint:r.checkpoint,context:r.context,endTime:r.endTime,startTime:r.startTime};t.$emit(a)}));e._subs.push(o);var c={database:t,parent:e,storageInstance:a,docCache:n,incrementalWriteQueue:i};return wr.set(e,c),c})();xr.set(e,a)}function jr(e){var t=xr.get(e);if(!t){var r=e.database?e.database:e,a=e.database?e.name:"";throw g("LD8",{database:r.name,collection:a})}return t}function Dr(e,t,r,a,n,i){return t.createStorageInstance({databaseInstanceToken:e,databaseName:r,collectionName:Pr(a),schema:Rr,options:n,multiInstance:i,devMode:p.isDevMode()})}function _r(e){var t=xr.get(e);if(t)return xr.delete(e),t.then((e=>e.storageInstance.close()))}async function Ir(e,t,r){var a=D(10),n=await Dr(a,e,t,r,{},!1);await n.remove()}function Pr(e){return"plugin-local-documents-"+e}var Rr=$({title:"RxLocalDocument",version:0,primaryKey:"id",type:"object",properties:{id:{type:"string",maxLength:128},data:{type:"object",additionalProperties:!0}},required:["id","data"]});async function Sr(e,t){var r=await jr(this),a={id:e,data:t,_deleted:!1,_meta:B(),_rev:"",_attachments:{}};return Ae(r.storageInstance,{document:a},"local-document-insert").then((e=>r.docCache.getCachedRxDocument(e)))}function Er(e,t){return this.getLocal(e).then((r=>r?r.incrementalModify((()=>t)):this.insertLocal(e,t)))}async function Cr(e){var t=await jr(this),r=t.docCache,a=r.getLatestDocumentDataIfExists(e);return a?Promise.resolve(r.getCachedRxDocument(a)):Be(t.storageInstance,e).then((e=>e?t.docCache.getCachedRxDocument(e):null))}function Or(e){return this.$.pipe((0,st.O)(null),(0,bt.z)((async t=>t?{changeEvent:t}:{doc:await this.getLocal(e)})),(0,bt.z)((async t=>{if(t.changeEvent){var r=t.changeEvent;return r.isLocal&&r.documentId===e?{use:!0,doc:await this.getLocal(e)}:{use:!1}}return{use:!0,doc:t.doc}})),(0,it.h)((e=>e.use)),(0,nt.U)((e=>e.doc)))}var Nr={name:"local-documents",rxdb:!0,prototypes:{RxCollection:e=>{e.insertLocal=Sr,e.upsertLocal=Er,e.getLocal=Cr,e.getLocal$=Or},RxDatabase:e=>{e.insertLocal=Sr,e.upsertLocal=Er,e.getLocal=Cr,e.getLocal$=Or}},hooks:{createRxDatabase:{before:e=>{e.creator.localDocuments&&kr(e.database)}},createRxCollection:{before:e=>{e.creator.localDocuments&&kr(e.collection)}},preDestroyRxDatabase:{after:e=>_r(e)},postDestroyRxCollection:{after:e=>_r(e)},postRemoveRxDatabase:{after:e=>Ir(e.storage,e.databaseName,"")},postRemoveRxCollection:{after:e=>Ir(e.storage,e.databaseName,e.collectionName)}},overwritable:{}};let Br;function Ar(){return"undefined"!=typeof window&&window.indexedDB}function Mr(){return Br||(Br=(async()=>{!function(e){if(et("preAddRxPlugin",{plugin:e,plugins:pr}),!pr.has(e)){if(fr.has(e.name))throw g("PL3",{name:e.name,plugin:e});if(pr.add(e),fr.add(e.name),!e.rxdb)throw b("PL1",{plugin:e});e.init&&e.init(),e.prototypes&&Object.entries(e.prototypes).forEach((e=>{let[t,r]=e;return r(mr[t])})),e.overwritable&&Object.assign(p,e.overwritable),e.hooks&&Object.entries(e.hooks).forEach((e=>{let[t,r]=e;r.after&&Xe[t].push(r.after),r.before&&Xe[t].unshift(r.before)}))}}(Nr);var e;return await hr({name:"rxdb-landing-v3",localDocuments:!0,storage:(void 0===e&&(e={}),new Ge(e))})})()),Br}const qr=["#e6008d","#8d2089","#5f2688"]},341:(e,t,r)=>{function a(e,t){console.log("window trigger: "+e+": "+t),"function"==typeof window.rdt&&window.rdt("track","Lead",{transactionId:e+"-"+(new Date).getTime(),value:t}),"function"==typeof window.gtag&&window.gtag("event",e,{value:t,currency:"EUR"})}r.d(t,{X:()=>a})},8323:(e,t,r)=>{r.r(t),r.d(t,{default:()=>f});var a=r(2263),n=r(7961),i=r(7294),s=r(7400),o=r(6087);const c=[{name:"Antigua and Barbuda",code:"AG",salary:49527},{name:"Argentina",code:"AR",salary:17158},{name:"Australia",code:"AU",salary:76036},{name:"Austria",code:"AT",salary:59383},{name:"Bahamas",code:"BS",salary:62024},{name:"Belarus",code:"BY",salary:5749},{name:"Belgium",code:"BE",salary:63749},{name:"Bermuda",code:"BM",salary:86590},{name:"Bosnia and Herzegovina",code:"BA",salary:11992},{name:"Brazil",code:"BR",salary:26464},{name:"Bulgaria",code:"BG",salary:23384},{name:"Cambodia",code:"KH",salary:18e3},{name:"Canada",code:"CA",salary:71554},{name:"Chile",code:"CL",salary:31073},{name:"China",code:"CN",salary:40611},{name:"Colombia",code:"CO",salary:12894},{name:"Costa Rica",code:"CR",salary:40256},{name:"Croatia",code:"HR",salary:22566},{name:"Czech Republic",code:"CZ",salary:33760},{name:"Denmark",code:"DK",salary:68778},{name:"Ecuador",code:"EC",salary:35016},{name:"Egypt",code:"EG",salary:7758},{name:"Estonia",code:"EE",salary:26728},{name:"Finland",code:"FI",salary:64198},{name:"France",code:"FR",salary:58137},{name:"Georgia",code:"GE",salary:40315},{name:"Germany",code:"DE",salary:72138},{name:"Greece",code:"GR",salary:36824},{name:"Guatemala",code:"GT",salary:49612},{name:"Holy See (Vatican City State)",code:"VA",salary:51474},{name:"Hong Kong",code:"HK",salary:71970},{name:"Hungary",code:"HU",salary:22341},{name:"Iceland",code:"IS",salary:66512},{name:"India",code:"IN",salary:17710},{name:"Indonesia",code:"ID",salary:20978},{name:"Iraq",code:"IQ",salary:21029},{name:"Ireland",code:"IE",salary:66281},{name:"Israel",code:"IL",salary:57466},{name:"Italy",code:"IT",salary:50900},{name:"Jamaica",code:"JM",salary:21048},{name:"Japan",code:"JP",salary:57793},{name:"Kazakhstan",code:"KZ",salary:12243},{name:"Korea, Republic of",code:"KR",salary:45957},{name:"Latvia",code:"LV",salary:26728},{name:"Luxembourg",code:"LU",salary:84663},{name:"Malaysia",code:"MY",salary:26117},{name:"Malta",code:"MT",salary:41971},{name:"Mexico",code:"MX",salary:24050},{name:"Morocco",code:"MA",salary:17903},{name:"Netherlands",code:"NL",salary:62661},{name:"New Zealand",code:"NZ",salary:63948},{name:"Norway",code:"NO",salary:69498},{name:"Pakistan",code:"PK",salary:9066},{name:"Panama",code:"PA",salary:39143},{name:"Peru",code:"PE",salary:17469},{name:"Philippines",code:"PH",salary:11088},{name:"Poland",code:"PL",salary:30236},{name:"Portugal",code:"PT",salary:37959},{name:"Romania",code:"RO",salary:22319},{name:"Russian Federation",code:"RU",salary:20492},{name:"Saudi Arabia",code:"SA",salary:47336},{name:"Singapore",code:"SG",salary:66023},{name:"Slovakia",code:"SK",salary:29650},{name:"South Africa",code:"ZA",salary:40336},{name:"Spain",code:"ES",salary:47819},{name:"Sweden",code:"SE",salary:49361},{name:"Switzerland",code:"CH",salary:92820},{name:"Taiwan",code:"TW",salary:47737},{name:"Thailand",code:"TH",salary:21772},{name:"Turkey",code:"TR",salary:8788},{name:"Ukraine",code:"UA",salary:14139},{name:"United Arab Emirates",code:"AE",salary:66381},{name:"United Kingdom",code:"GB",salary:61188},{name:"United States",code:"US",salary:91935},{name:"Uruguay",code:"UY",salary:23754},{name:"Vietnam",code:"VN",salary:19058}],l={browser:.4,native:.4,performance:.35,sourcecode:0,perpetual:0},u=.05;var d=r(341),h=r(4183),m=r(5893);const p="premium-price-form-value";function f(){const{siteConfig:e}=(0,a.Z)();return(0,i.useEffect)((()=>{(async()=>{if(!(0,h.dZ)())return;const e=await(0,h.N8)(),t=await e.getLocal(p);t&&(console.log("formValueDoc:"),console.dir(t),y("home-country",t._data.data.homeCountry),y("company-size",t._data.data.companySize),y("project-amount",t._data.data.projectAmount),y("license-period",t._data.data.licensePeriod),Object.keys(l).forEach((e=>{y("package-"+e,!1)})),t._data.data.packages.forEach((e=>{y("package-"+e,!0)})))})()})),(0,m.jsx)(n.Z,{title:`Premium Plugins - ${e.title}`,description:"RxDB plugins for professionals. FAQ, pricing and license",children:(0,m.jsxs)("main",{children:[(0,m.jsx)("div",{className:"block first",children:(0,m.jsxs)("div",{className:"content centered",children:[(0,m.jsxs)("h2",{children:["\ud83d\udc51 ",(0,m.jsx)("b",{className:"underline",children:"RxDB"})," Premium Plugins"]}),(0,m.jsxs)("p",{style:{width:"80%"},children:["To make RxDB a sustainable project, some plugins are not part of the RxDB open source project. Instead they are part of the"," ",(0,m.jsx)("b",{children:"rxdb-premium"})," package which must be purchased.",(0,m.jsx)("br",{}),"Professional developers use these to get the best ",(0,m.jsx)("b",{children:"performance"})," and the most out of RxDB."]}),(0,m.jsxs)("div",{className:"premium-blocks",children:[(0,m.jsx)("a",{href:"./rx-storage-opfs.html",target:"_blank",children:(0,m.jsx)("div",{className:"premium-block hover-shadow-middle bg-gradient-right-top",children:(0,m.jsxs)("div",{className:"premium-block-inner",children:[(0,m.jsx)("h4",{children:"RxStorage OPFS"}),(0,m.jsxs)("p",{children:["Currently the fastest RxStorage that can be used in the browser. Based on the ",(0,m.jsx)("b",{children:"File System Access API"}),"."]})]})})}),(0,m.jsx)("a",{href:"./rx-storage-indexeddb.html",target:"_blank",children:(0,m.jsx)("div",{className:"premium-block hover-shadow-middle bg-gradient-left-top",children:(0,m.jsxs)("div",{className:"premium-block-inner",children:[(0,m.jsx)("h4",{children:"RxStorage IndexedDB"}),(0,m.jsxs)("p",{children:["A really fast storage based on ",(0,m.jsx)("b",{children:"IndexedDB"}),". Made to be used in browsers."]})]})})}),(0,m.jsx)("a",{href:"./rx-storage-sqlite.html",target:"_blank",children:(0,m.jsx)("div",{className:"premium-block hover-shadow-middle bg-gradient-right-top",children:(0,m.jsxs)("div",{className:"premium-block-inner",children:[(0,m.jsx)("h4",{children:"RxStorage SQLite"}),(0,m.jsxs)("p",{children:["A really fast storage based on ",(0,m.jsx)("b",{children:"SQLite"}),". Used with"," ",(0,m.jsx)("b",{children:"Node.js"}),", ",(0,m.jsx)("b",{children:"Electron"}),", ",(0,m.jsx)("b",{children:"React Native"}),", ",(0,m.jsx)("b",{children:"Capacitor"}),"."]})]})})}),(0,m.jsx)("a",{href:"./rx-storage-sharding.html",target:"_blank",children:(0,m.jsx)("div",{className:"premium-block hover-shadow-middle bg-gradient-left-top",children:(0,m.jsxs)("div",{className:"premium-block-inner",children:[(0,m.jsx)("h4",{children:"RxStorage Sharding"}),(0,m.jsx)("p",{children:"A wrapper around any other storage that improves performance by applying the sharding technique."})]})})}),(0,m.jsx)("a",{href:"./rx-storage-memory-synced.html",target:"_blank",children:(0,m.jsx)("div",{className:"premium-block hover-shadow-middle bg-gradient-left-top",children:(0,m.jsxs)("div",{className:"premium-block-inner",children:[(0,m.jsx)("h4",{children:"RxStorage Memory Synced"}),(0,m.jsx)("p",{children:"A wrapper around any other storage that creates a synced in-memory copy which improves performance for the initial page load time and write&read operations."})]})})}),(0,m.jsx)("a",{href:"./query-optimizer.html",target:"_blank",children:(0,m.jsx)("div",{className:"premium-block hover-shadow-middle bg-gradient-right-top",children:(0,m.jsxs)("div",{className:"premium-block-inner",children:[(0,m.jsx)("h4",{children:"Query Optimizer"}),(0,m.jsx)("p",{children:"A tool to find the best index for a given query. You can use this during build time to find the best index and then use that index during runtime."})]})})}),(0,m.jsx)("a",{href:"./rx-storage-localstorage-meta-optimizer.html",target:"_blank",children:(0,m.jsx)("div",{className:"premium-block hover-shadow-middle bg-gradient-left-top",children:(0,m.jsxs)("div",{className:"premium-block-inner",children:[(0,m.jsx)("h4",{children:"RxStorage Localstorage Meta Optimizer"}),(0,m.jsxs)("p",{children:["A wrapper around any other storage which optimizes the initial page load one by using localstorage for meta key-value document. Only works in ",(0,m.jsx)("b",{children:"browsers"}),"."]})]})})}),(0,m.jsx)("a",{href:"./rx-storage-shared-worker.html",target:"_blank",children:(0,m.jsx)("div",{className:"premium-block hover-shadow-middle bg-gradient-right-top",children:(0,m.jsxs)("div",{className:"premium-block-inner",children:[(0,m.jsx)("h4",{children:"RxStorage SharedWorker"}),(0,m.jsxs)("p",{children:["A RxStorage wrapper to run the storage inside of a SharedWorker which improves the performance by taking CPU load away from the main process. Used in ",(0,m.jsx)("b",{children:"browsers"}),"."]})]})})}),(0,m.jsx)("a",{href:"./rx-storage-worker.html",target:"_blank",children:(0,m.jsx)("div",{className:"premium-block hover-shadow-middle bg-gradient-left-top",children:(0,m.jsxs)("div",{className:"premium-block-inner",children:[(0,m.jsx)("h4",{children:"RxStorage Worker"}),(0,m.jsx)("p",{children:"A RxStorage wrapper to run the storage inside of a Worker which improves the performance by taking CPU load away from the main process."})]})})}),(0,m.jsx)("a",{href:"./encryption.html",target:"_blank",children:(0,m.jsx)("div",{className:"premium-block hover-shadow-middle bg-gradient-right-top",children:(0,m.jsxs)("div",{className:"premium-block-inner",children:[(0,m.jsx)("h4",{children:"WebCrypto Encryption"}),(0,m.jsx)("p",{children:"A faster and more secure encryption plugin based on the Web Crypto API."})]})})}),(0,m.jsx)("a",{href:"./rx-storage-filesystem-node.html",target:"_blank",children:(0,m.jsx)("div",{className:"premium-block hover-shadow-middle bg-gradient-left-top",children:(0,m.jsxs)("div",{className:"premium-block-inner",children:[(0,m.jsx)("h4",{children:"RxStorage Filesystem Node"}),(0,m.jsxs)("p",{children:["A fast RxStorage based on the ",(0,m.jsx)("b",{children:"Node.js"})," Filesystem."]})]})})}),(0,m.jsx)("a",{href:"./logger.html",target:"_blank",children:(0,m.jsx)("div",{className:"premium-block hover-shadow-middle bg-gradient-right-top",children:(0,m.jsxs)("div",{className:"premium-block-inner",children:[(0,m.jsx)("h4",{children:"Logger"}),(0,m.jsx)("p",{children:"A logging plugin useful to debug performance problems and for monitoring with Application Performance Monitoring (APM) tools like Bugsnag, Datadog, Elastic, Sentry and others"})]})})})]})]})}),(0,m.jsx)("div",{className:"block dark",id:"faq",children:(0,m.jsxs)("div",{className:"content centered premium-faq",children:[(0,m.jsxs)("h2",{children:["F.A.Q. ",(0,m.jsx)("b",{children:"(click to toggle)"})]}),(0,m.jsxs)("details",{children:[(0,m.jsx)("summary",{children:"Do I need the Premium Plugins?"}),"When you start using RxDB, you do not need access to the premium plugins. Most use cases can be implemented with the Open Core part of RxDB. There are many"," ",(0,m.jsx)("a",{href:"./rx-storage.html",target:"_blank",children:"RxStorage"}),"options and all core plugins that are required for replication, schema validation, encryption and so on, are totally free. As soon as your application is more then a side project, it is pretty easy to switch to RxDB Premium Plugins by just changing a few lines of configuration.",(0,m.jsx)("br",{}),"The main benefit of the Premium Plugins is ",(0,m.jsx)("b",{children:"performance"}),". The Premium RxStorage implementations have a better performance so reading and writing data is much faster especially on low-end devices. You can find a performance comparison"," ",(0,m.jsx)("a",{href:"./rx-storage-performance.html",target:"_blank",children:"here"}),". Also there are additional Premium Plugins that can be used to further optimize the performance of your application like the"," ",(0,m.jsx)("a",{href:"./query-optimizer.html",target:"_blank",children:"Query Optimizer"})," ","or the"," ",(0,m.jsx)("a",{href:"./rx-storage-sharding.html",target:"_blank",children:"Sharding"})," ","plugin."]}),(0,m.jsxs)("details",{children:[(0,m.jsx)("summary",{children:"Why is it not for free?"}),"The development of RxDB started in 2016 and after all these years it became clear that big implementation and improvement steps will not be done by the RxDB community. While the community submits valuable pull requests, they are mostly small improvements or bugfixes for specific edge case. Big rewrites and optimizations that require a big effort have only be done by the RxDB maintainer.",(0,m.jsx)("br",{}),"Selling RxDB Premium ensures that there will be always an incentive for someone to add features, keep everything up to date and to further improve and optimize the codebase. This gives the user the confidence that RxDB is a ",(0,m.jsx)("b",{children:"future proof"})," tech stack to build on which lets RxDB stand out compared to similar technologies."]}),(0,m.jsxs)("details",{children:[(0,m.jsx)("summary",{children:"Why is there no free trial period?"}),(0,m.jsxs)("ul",{children:[(0,m.jsx)("li",{children:"RxDB is written in JavaScript and the code of the Premium Plugins does not contain any tracking or measurement code that would send information from your application to our servers in production mode. As soon as someone has the code on his computer, the maintainer has no chance to really ensure that after a free trial period the code is no longer used and deleted."}),(0,m.jsxs)("li",{children:["Before you can use the Premium Plugins you have to debate and sign a license agreement with the maintainer. This is a sophisticated process that creates overhead which distracts the maintainer from writing RxDB code. So handling trial period users is just not manageable. For this reason there is also no monthly subscriptions. Premium access must be paid ",(0,m.jsx)("b",{children:"per year"}),"."]})]})]}),(0,m.jsxs)("details",{children:[(0,m.jsx)("summary",{children:"Why is it not cheaper?"}),"The price of the Premium Plugins is chosen in way that ensures that there can be always one person that develops RxDB ",(0,m.jsx)("b",{children:"full time"}),". Compared to other JavaScript frameworks and developer tools, RxDB satisfies an edge use case for people that want to store data inside of their application on the users device. Most web developers do not need to do that and rely on the traditional client-server stack. So RxDB cannot be sold to that many people which increases the price."]}),(0,m.jsxs)("details",{children:[(0,m.jsx)("summary",{children:"Can I install/build the premium plugins in my CI?"}),(0,m.jsx)("b",{children:"Yes"})," you can safely install and use the Premium Plugins in your CI without additional payment."]}),(0,m.jsxs)("details",{children:[(0,m.jsx)("summary",{children:"Can I get a discount?"}),"Discounts are provided for people that have made a significant contribution to RxDB or one of RxDB's dependencies or to the Open Source Community overall. Also for private personal projects there is the option to solve one of the",(0,m.jsx)("a",{href:"https://github.com/pubkey/rxdb/blob/master/orga/premium-tasks.md",target:"_blank",children:"Premium Tasks"}),"to get 3 years access to the Premium Plugins."]}),(0,m.jsxs)("details",{children:[(0,m.jsx)("summary",{children:"Which payment methods are accepted?"}),(0,m.jsx)("b",{children:"Stripe.com"})," is used as payment processor so most known payment options like credit card, PayPal, SEPA transfer and others are available. A list of all options can be found"," ",(0,m.jsx)("a",{href:"https://stripe.com/docs/payments/payment-methods/overview",title:"stripe payment options",target:"_blank",children:"here"}),"."]}),(0,m.jsxs)("details",{children:[(0,m.jsx)("summary",{children:"Can I still use the premium plugins when the license has expired?"}),"By default you are not allowed to use the premium plugins after the license has expired and you will no longer be able to install them. But you can choose the ",(0,m.jsx)("b",{children:"Perpetual license"})," option. With the perpetual license option, you can still use the plugins even after the license is expired. But you will no longer get any updates from newer RxDB versions."]}),(0,m.jsxs)("details",{children:[(0,m.jsx)("summary",{children:"Is there any tracking code inside of the premium plugins?"}),'No, the premium plugins themself do not contain any tracking code. When you build your application with RxDB and deploy it to production, it will not make requests to any RxDB server. But when you run "npm install" with the premium package there will be some metadata send from your developers machine to RxDB.']})]})}),(0,m.jsxs)("div",{className:"block",children:[(0,m.jsxs)("div",{className:"content centered",children:[(0,m.jsxs)("h2",{children:["RxDB Premium ",(0,m.jsx)("b",{className:"underline",children:"Price Calculator"})]}),(0,m.jsx)("div",{className:"price-calculator",children:(0,m.jsxs)("div",{className:"price-calculator-inner",children:[(0,m.jsxs)("form",{id:"price-calculator-form",children:[(0,m.jsxs)("div",{className:"field",children:[(0,m.jsx)("label",{htmlFor:"home-country",children:"Company Home Country:"}),(0,m.jsxs)("div",{className:"input",children:[(0,m.jsx)("input",{list:"home-country",name:"home-country",pattern:"[A-Za-z \\-]{2,}",required:!0,style:{width:"100%",maxWidth:240},autoComplete:"off"}),(0,m.jsx)("datalist",{id:"home-country",children:c.sort(((e,t)=>e.code>=t.code?1:-1)).map(((e,t)=>(0,m.jsx)("option",{value:e.name,children:e.name},t)))})]})]}),(0,m.jsxs)("div",{className:"field",children:[(0,m.jsx)("label",{htmlFor:"company-size",children:"Company Size:"}),(0,m.jsxs)("div",{className:"input",children:[(0,m.jsx)("input",{type:"number",name:"company-size",min:1,max:1e6,required:!0,onKeyDown:()=>{const e=(0,s.Is)(event);return 69!==e.keyCode&&189!==e.keyCode&&190!==e.keyCode}}),(0,m.jsx)("div",{className:"suffix",children:"employee(s)"})]})]}),(0,m.jsxs)("div",{className:"field",children:[(0,m.jsx)("label",{htmlFor:"project-amount",children:"Project Amount:"}),(0,m.jsxs)("div",{className:"input",children:[(0,m.jsxs)("select",{name:"project-amount",id:"project-amount",required:!0,defaultValue:1,children:[(0,m.jsx)("option",{value:1,children:"1"}),(0,m.jsx)("option",{value:2,children:"2"}),(0,m.jsx)("option",{value:"infinity",children:"Infinity"})]}),(0,m.jsx)("div",{className:"suffix",children:"project(s)"})]})]}),(0,m.jsxs)("div",{className:"packages",children:[(0,m.jsx)("h3",{children:"Packages:"}),(0,m.jsx)("div",{className:"package bg-gradient-left-top",children:(0,m.jsxs)("div",{className:"package-inner",children:[(0,m.jsx)("input",{name:"package-browser",type:"checkbox",className:"package-checkbox",defaultChecked:!0}),(0,m.jsx)("h4",{children:"Browser Package"}),(0,m.jsxs)("ul",{children:[(0,m.jsx)("li",{children:(0,m.jsx)("a",{href:"./rx-storage-opfs.html",target:"_blank",children:"RxStorage OPFS"})}),(0,m.jsx)("li",{children:(0,m.jsx)("a",{href:"./rx-storage-indexeddb.html",target:"_blank",children:"RxStorage IndexedDB"})}),(0,m.jsx)("li",{children:(0,m.jsx)("a",{href:"./rx-storage-worker.html",target:"_blank",children:"RxStorage Worker"})}),(0,m.jsx)("li",{children:(0,m.jsx)("a",{href:"./encryption.html",target:"_blank",children:"WebCrypto Encryption"})})]})]})}),(0,m.jsx)("div",{className:"package bg-gradient-left-top",children:(0,m.jsxs)("div",{className:"package-inner",children:[(0,m.jsx)("input",{name:"package-native",type:"checkbox",className:"package-checkbox",defaultChecked:!0}),(0,m.jsx)("h4",{children:"Native Package"}),(0,m.jsxs)("ul",{children:[(0,m.jsx)("li",{children:(0,m.jsx)("a",{href:"./rx-storage-sqlite.html",target:"_blank",children:"RxStorage SQLite"})}),(0,m.jsx)("li",{children:(0,m.jsx)("a",{href:"./rx-storage-filesystem-node.html",target:"_blank",children:"RxStorage Filesystem Node"})})]})]})}),(0,m.jsx)("div",{className:"package bg-gradient-left-top",children:(0,m.jsxs)("div",{className:"package-inner",children:[(0,m.jsx)("input",{name:"package-performance",type:"checkbox",className:"package-checkbox",defaultChecked:!0}),(0,m.jsx)("h4",{children:"Performance Package"}),(0,m.jsxs)("ul",{children:[(0,m.jsx)("li",{children:(0,m.jsx)("a",{href:"./rx-storage-sharding.html",target:"_blank",children:"RxStorage Sharding"})}),(0,m.jsx)("li",{children:(0,m.jsx)("a",{href:"./rx-storage-memory-synced.html",target:"_blank",children:"RxStorage Memory Synced"})}),(0,m.jsx)("li",{children:(0,m.jsx)("a",{href:"./query-optimizer.html",target:"_blank",children:"Query Optimizer"})}),(0,m.jsx)("li",{children:(0,m.jsx)("a",{href:"./rx-storage-localstorage-meta-optimizer.html",target:"_blank",children:"RxStorage Localstorage Meta Optimizer"})}),(0,m.jsx)("li",{children:(0,m.jsx)("a",{href:"./rx-storage-shared-worker.html",target:"_blank",children:"RxStorage Shared Worker"})})]})]})}),(0,m.jsx)("div",{className:"package bg-gradient-left-top",children:(0,m.jsxs)("div",{className:"package-inner",children:[(0,m.jsx)("input",{name:"package-utilities",type:"checkbox",className:"package-checkbox",defaultChecked:!0,disabled:!0}),(0,m.jsxs)("h4",{children:["Utilities Package ",(0,m.jsx)("b",{children:"always included"})]}),(0,m.jsx)("ul",{children:(0,m.jsx)("li",{children:(0,m.jsx)("a",{href:"./logger.html",target:"_blank",children:"Logger"})})})]})}),(0,m.jsx)("div",{className:"clear"}),(0,m.jsx)("h3",{children:"Other Options:"}),(0,m.jsx)("div",{className:"package bg-gradient-left-top",children:(0,m.jsxs)("div",{className:"package-inner",children:[(0,m.jsx)("input",{name:"package-sourcecode",type:"checkbox",className:"package-checkbox"}),(0,m.jsx)("h4",{children:"Source Code access"}),(0,m.jsxs)("p",{children:["Get read access to the unminified plain source code of all purchased packages.",(0,m.jsx)("br",{})]})]})}),(0,m.jsx)("div",{className:"package bg-gradient-left-top",children:(0,m.jsxs)("div",{className:"package-inner",children:[(0,m.jsx)("input",{name:"package-perpetual",type:"checkbox",className:"package-checkbox"}),(0,m.jsx)("h4",{children:"Perpetual license"}),(0,m.jsxs)("p",{children:["With the perpetual license option, you can still use the plugins even after the license is expired. But you will no longer get any updates from newer RxDB versions.",(0,m.jsx)("br",{})]})]})}),(0,m.jsx)("div",{className:"package bg-gradient-left-top",children:(0,m.jsxs)("div",{className:"package-inner",children:[(0,m.jsx)("h4",{children:"Increase license period"}),(0,m.jsxs)("p",{children:["The default license period is one year. We can do a longer license period to safe time on both sides by not having to go through the licensing process each single year. By choosing a license period of 2 years, you get a 10% discount. With a 3 year license the discount is 20%.",(0,m.jsx)("br",{})]}),(0,m.jsxs)("div",{className:"field",children:[(0,m.jsxs)("div",{className:"input",style:{float:"left",width:"100%"},children:[(0,m.jsx)("div",{className:"prefix",children:"License period "}),(0,m.jsxs)("select",{name:"license-period",id:"license-period",required:!0,defaultValue:1,children:[(0,m.jsx)("option",{value:1,children:"1"}),(0,m.jsx)("option",{value:2,children:"2 (10% discount)"}),(0,m.jsx)("option",{value:3,children:"3 (20% discount)"})]}),(0,m.jsx)("div",{className:"suffix",children:"year(s)"})]}),(0,m.jsx)("div",{className:"clear"})]}),(0,m.jsx)("p",{})]})}),(0,m.jsx)("div",{className:"clear"})]}),(0,m.jsx)("div",{className:"button",id:"price-calculator-submit",onClick:async()=>{(0,d.X)("calculate_premium_price",3);const e=(0,s.Is)(document.getElementById("price-calculator-form"));if(!e.reportValidity())return void console.log("form not valid");const t=new FormData(e),r=Object.fromEntries(t.entries());console.log("formData:"),console.dir(r);const a=c.find((e=>e.name.toLowerCase()===r["home-country"].toLowerCase()));if(!a)return;const n=Object.entries(r).filter((e=>{let[t,r]=e;return t.startsWith("package-")})).map((e=>{let[t]=e;return(0,o.SI)(t.split("-"))})),i=await(0,h.N8)();await i.upsertLocal(p,{companySize:r["company-size"],projectAmount:r["project-amount"],licensePeriod:r["license-period"],homeCountry:a.name,packages:n});const m={companySize:r["company-size"],teamSize:r["developer-count"],projectAmount:r["project-amount"],licensePeriod:parseInt(r["license-period"],10),homeCountryCode:a.code,packages:n},f=function(e){if(console.log("calculatePrice:"),console.dir(e),"number"!=typeof e.licensePeriod)throw new Error("not a number "+typeof e.licensePeriod);const t=(0,s.Is)(c.find((t=>t.code===e.homeCountryCode))).salary;let r=0;e.packages.forEach((e=>{const t=l[e];r+=t})),console.log("aimInPercent: "+r);let a=350+1.4*t*(r/100);if(2===e.packages.length&&(a*=.9),e.packages.length>2&&(a*=.85),e.companySize>1){const t=1+Math.pow(e.companySize-1,.55)/100*1.5;console.log("input.companySize "+e.companySize+" - "+t),a*=t}if(e.packages.includes("sourcecode")){a*=1.75;const e=1520;a<e&&(a=e)}const n=(new Date).getFullYear()-2022,i=Math.pow(1+u,n);console.log("inflationMultiplier: "+i),a*=i,"2"===e.projectAmount?a*=1.6:"infinity"===e.projectAmount&&(a*=3),a=Math.ceil(a)*e.licensePeriod,2===e.licensePeriod?a*=.9:3===e.licensePeriod&&(a*=.8),e.packages.includes("perpetual")&&(a+=a/e.licensePeriod*.45);return a=Math.ceil(a),{totalPrice:a}}(m);console.log("priceResult:"),console.log(JSON.stringify(f,null,4));const y=(0,s.Is)(document.getElementById("price-calculator-result")),v=(0,s.Is)(document.getElementById("total-per-project-per-month")),g=(0,s.Is)(document.getElementById("total-per-year")),b=(0,s.Is)(document.getElementById("total-price")),x=(e,t)=>{console.log("setPrice:"),console.dir(t),e.innerHTML=Math.ceil(t).toString()+" &euro; (EUR)",e.href=function(e){return"https://www.xe.com/en/currencyconverter/convert/?Amount="+e+"&From=EUR&To=USD"}(Math.ceil(t))},w=f.totalPrice/m.licensePeriod;x(v,"infinity"!==m.projectAmount?w/parseInt(m.projectAmount,10)/12:0),x(g,w),x(b,f.totalPrice),y.style.display="block"},children:"Estimate Price"})]}),(0,m.jsxs)("div",{id:"price-calculator-result",style:{display:"none"},children:[(0,m.jsx)("hr",{}),(0,m.jsx)("h4",{children:"Estimated Price:"}),(0,m.jsx)("table",{children:(0,m.jsxs)("tbody",{children:[(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{children:"Price Per Project per Month"}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{id:"total-per-project-per-month",target:"_blank",rel:"nofollow noopener noreferrer",title:"Click to convert to other currency",href:"#",children:"XX \u20ac"})})]}),(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{children:"Total Price per Year"}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{id:"total-per-year",target:"_blank",rel:"nofollow noopener noreferrer",title:"Click to convert to other currency",href:"#",children:"XX \u20ac"})})]}),(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{children:"Total Price"}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{id:"total-price",target:"_blank",rel:"nofollow noopener noreferrer",title:"Click to convert to other currency",href:"#",children:"XX \u20ac"})})]})]})}),(0,m.jsxs)("div",{className:"proceed-hint",children:["Fill out",(0,m.jsxs)("a",{href:"#premium-request-form-block",children:[" ",(0,m.jsx)("b",{children:"this form"})," "]}),"to proceed."]})]})]})})]}),(0,m.jsx)("div",{className:"block dark",id:"premium-request-form-block",children:(0,m.jsxs)("div",{className:"content centered premium-request",children:[(0,m.jsxs)("h2",{children:["Request Premium ",(0,m.jsx)("b",{className:"underline",children:"Form"})]}),(0,m.jsx)("p",{}),(0,m.jsx)("iframe",{id:"request-premium-form",src:"https://webforms.pipedrive.com/f/6qflURDWONiPpj67lpG6r45n8feakrtS2AqMRcBf1EuCPRvNcXWdvNH2unFm5EpjW3",children:'Your browser doesn\'t support iframes, <a href="https://webforms.pipedrive.com/f/6qflURDWONiPpj67lpG6r45n8feakrtS2AqMRcBf1EuCPRvNcXWdvNH2unFm5EpjW3" rel="nofollow" >go here</a>'})]})})]})]})})}function y(e,t){if(void 0===t)return;const r=document.querySelector("[name="+e+"]");r&&(r.type&&"checkbox"===r.type?r.checked=t:r.value=t)}},6087:(e,t,r)=>{function a(e){return e[e.length-1]}function n(e){return Array.isArray(e)?e.slice(0):[e]}function i(e){return Array.isArray(e)}function s(e){return null!=e}function o(e,t){var r=0,a=-1;for(var n of e){if(!t(n,a+=1))break;r+=1}return r}function c(e,t){for(var r=t.length,a=0;a<r;++a){var n=t[a];e.push(n)}}r.d(t,{AD:()=>i,S7:()=>s,SI:()=>a,gu:()=>c,qo:()=>n,r0:()=>o})},7400:(e,t,r)=>{function a(e){if(!e)throw new Error("ensureNotFalsy() is falsy");return e}r.d(t,{Is:()=>a,kv:()=>n});var n={bufferSize:1,refCount:!0}},4419:(e,t,r)=>{function a(){return new Promise((e=>setTimeout(e,0)))}function n(e){return void 0===e&&(e=0),new Promise((t=>setTimeout(t,e)))}r.d(t,{$Y:()=>o,C2:()=>u,Y3:()=>a,YB:()=>n,Ze:()=>d,kZ:()=>i,m5:()=>s,y$:()=>c});Promise.resolve(!0);var i=Promise.resolve(!1),s=Promise.resolve(null),o=Promise.resolve();function c(e){return void 0===e&&(e=1e4),"function"==typeof requestIdleCallback?new Promise((t=>{requestIdleCallback((()=>t()),{timeout:e})})):n(0)}var l=o;function u(e){return void 0===e&&(e=void 0),l=l.then((()=>c(e)))}function d(e,t){return e.reduce(((e,t)=>e.then(t)),Promise.resolve(t))}},984:(e,t,r)=>{r.d(t,{z:()=>n});var a=0;function n(){var e=Date.now();(e+=.01)<=a&&(e=a+.01);var t=parseFloat(e.toFixed(2));return a=t,t}}}]);