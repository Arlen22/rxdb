{"version":3,"file":"dev-mode-tracking.js","names":["isRxDatabaseFirstTimeInstantiated","PREMIUM_FLAG_HASH","RXDB_UTILS_GLOBAL","RXDB_VERSION","defaultHashSha256","iframeShown","addDevModeTrackingIframe","db","window","location","isLocalHost","premium","isFirstTime","iframe","document","createElement","style","display","src","body","appendChild","hostname"],"sources":["../../../../src/plugins/dev-mode/dev-mode-tracking.ts"],"sourcesContent":["import { isRxDatabaseFirstTimeInstantiated } from '../../rx-database.ts';\nimport type { RxDatabase } from '../../types';\nimport {\n    PREMIUM_FLAG_HASH,\n    RXDB_UTILS_GLOBAL,\n    RXDB_VERSION,\n    defaultHashSha256\n} from '../utils/index.ts';\n\n\nlet iframeShown = false;\n\n\n/**\n * Adds an iframe to track the results of marketing efforts.\n */\nexport async function addDevModeTrackingIframe(db: RxDatabase) {\n    /**\n     * Only run this in browser AND localhost AND dev-mode.\n     * Make sure this is never used in production by someone.\n     */\n    if (\n        iframeShown ||\n        typeof window === 'undefined' ||\n        typeof location === 'undefined' ||\n        !isLocalHost()\n    ) {\n        return;\n    }\n\n\n    // do not show if premium flag is set.\n    if (\n        RXDB_UTILS_GLOBAL.premium &&\n        typeof RXDB_UTILS_GLOBAL.premium === 'string' &&\n        (await defaultHashSha256(RXDB_UTILS_GLOBAL.premium) === PREMIUM_FLAG_HASH)\n    ) {\n        return;\n    }\n\n\n    // Only run if db was created for the first time.\n    const isFirstTime = await isRxDatabaseFirstTimeInstantiated(db);\n    if (!isFirstTime) {\n        return;\n    }\n\n    iframeShown = true;\n\n    const iframe = document.createElement('iframe');\n    iframe.style.display = 'none';\n    iframe.src = 'https://rxdb.info/html/dev-mode-iframe.html?version=' + RXDB_VERSION;\n    document.body.appendChild(iframe);\n}\n\n\nfunction isLocalHost() {\n    return (\n        location.hostname === 'localhost' ||\n        location.hostname === '127.0.0.1' ||\n        location.hostname === '0.0.0.0' ||\n        location.hostname === '[::1]'  // IPv6\n    );\n}\n"],"mappings":"AAAA,SAASA,iCAAiC,QAAQ,sBAAsB;AAExE,SACIC,iBAAiB,EACjBC,iBAAiB,EACjBC,YAAY,EACZC,iBAAiB,QACd,mBAAmB;AAG1B,IAAIC,WAAW,GAAG,KAAK;;AAGvB;AACA;AACA;AACA,OAAO,eAAeC,wBAAwBA,CAACC,EAAc,EAAE;EAC3D;AACJ;AACA;AACA;EACI,IACIF,WAAW,IACX,OAAOG,MAAM,KAAK,WAAW,IAC7B,OAAOC,QAAQ,KAAK,WAAW,IAC/B,CAACC,WAAW,CAAC,CAAC,EAChB;IACE;EACJ;;EAGA;EACA,IACIR,iBAAiB,CAACS,OAAO,IACzB,OAAOT,iBAAiB,CAACS,OAAO,KAAK,QAAQ,IAC5C,OAAMP,iBAAiB,CAACF,iBAAiB,CAACS,OAAO,CAAC,MAAKV,iBAAkB,EAC5E;IACE;EACJ;;EAGA;EACA,IAAMW,WAAW,GAAG,MAAMZ,iCAAiC,CAACO,EAAE,CAAC;EAC/D,IAAI,CAACK,WAAW,EAAE;IACd;EACJ;EAEAP,WAAW,GAAG,IAAI;EAElB,IAAMQ,MAAM,GAAGC,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC;EAC/CF,MAAM,CAACG,KAAK,CAACC,OAAO,GAAG,MAAM;EAC7BJ,MAAM,CAACK,GAAG,GAAG,sDAAsD,GAAGf,YAAY;EAClFW,QAAQ,CAACK,IAAI,CAACC,WAAW,CAACP,MAAM,CAAC;AACrC;AAGA,SAASH,WAAWA,CAAA,EAAG;EACnB,OACID,QAAQ,CAACY,QAAQ,KAAK,WAAW,IACjCZ,QAAQ,CAACY,QAAQ,KAAK,WAAW,IACjCZ,QAAQ,CAACY,QAAQ,KAAK,SAAS,IAC/BZ,QAAQ,CAACY,QAAQ,KAAK,OAAO,CAAE;EAAA;AAEvC","ignoreList":[]}